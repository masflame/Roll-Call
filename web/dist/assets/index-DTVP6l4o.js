function QS(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function YS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var y_={exports:{}},Wu={},v_={exports:{}},ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ca=Symbol.for("react.element"),XS=Symbol.for("react.portal"),JS=Symbol.for("react.fragment"),ZS=Symbol.for("react.strict_mode"),eC=Symbol.for("react.profiler"),tC=Symbol.for("react.provider"),nC=Symbol.for("react.context"),rC=Symbol.for("react.forward_ref"),sC=Symbol.for("react.suspense"),iC=Symbol.for("react.memo"),oC=Symbol.for("react.lazy"),Sg=Symbol.iterator;function aC(t){return t===null||typeof t!="object"?null:(t=Sg&&t[Sg]||t["@@iterator"],typeof t=="function"?t:null)}var __={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w_=Object.assign,x_={};function Vi(t,e,n){this.props=t,this.context=e,this.refs=x_,this.updater=n||__}Vi.prototype.isReactComponent={};Vi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Vi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function E_(){}E_.prototype=Vi.prototype;function kf(t,e,n){this.props=t,this.context=e,this.refs=x_,this.updater=n||__}var Pf=kf.prototype=new E_;Pf.constructor=kf;w_(Pf,Vi.prototype);Pf.isPureReactComponent=!0;var Cg=Array.isArray,S_=Object.prototype.hasOwnProperty,Df={current:null},C_={key:!0,ref:!0,__self:!0,__source:!0};function I_(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)S_.call(e,r)&&!C_.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Ca,type:t,key:i,ref:o,props:s,_owner:Df.current}}function lC(t,e){return{$$typeof:Ca,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function jf(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ca}function uC(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Ig=/\/+/g;function sd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?uC(""+t.key):e.toString(36)}function Ml(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ca:case XS:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+sd(o,0):r,Cg(s)?(n="",t!=null&&(n=t.replace(Ig,"$&/")+"/"),Ml(s,e,n,"",function(c){return c})):s!=null&&(jf(s)&&(s=lC(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Ig,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Cg(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+sd(i,a);o+=Ml(i,e,n,l,s)}else if(l=aC(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+sd(i,a++),o+=Ml(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ll(t,e,n){if(t==null)return t;var r=[],s=0;return Ml(t,r,"","",function(i){return e.call(n,i,s++)}),r}function cC(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var kt={current:null},Vl={transition:null},dC={ReactCurrentDispatcher:kt,ReactCurrentBatchConfig:Vl,ReactCurrentOwner:Df};function T_(){throw Error("act(...) is not supported in production builds of React.")}ie.Children={map:ll,forEach:function(t,e,n){ll(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ll(t,function(){e++}),e},toArray:function(t){return ll(t,function(e){return e})||[]},only:function(t){if(!jf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ie.Component=Vi;ie.Fragment=JS;ie.Profiler=eC;ie.PureComponent=kf;ie.StrictMode=ZS;ie.Suspense=sC;ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dC;ie.act=T_;ie.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=w_({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Df.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)S_.call(e,l)&&!C_.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Ca,type:t.type,key:s,ref:i,props:r,_owner:o}};ie.createContext=function(t){return t={$$typeof:nC,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:tC,_context:t},t.Consumer=t};ie.createElement=I_;ie.createFactory=function(t){var e=I_.bind(null,t);return e.type=t,e};ie.createRef=function(){return{current:null}};ie.forwardRef=function(t){return{$$typeof:rC,render:t}};ie.isValidElement=jf;ie.lazy=function(t){return{$$typeof:oC,_payload:{_status:-1,_result:t},_init:cC}};ie.memo=function(t,e){return{$$typeof:iC,type:t,compare:e===void 0?null:e}};ie.startTransition=function(t){var e=Vl.transition;Vl.transition={};try{t()}finally{Vl.transition=e}};ie.unstable_act=T_;ie.useCallback=function(t,e){return kt.current.useCallback(t,e)};ie.useContext=function(t){return kt.current.useContext(t)};ie.useDebugValue=function(){};ie.useDeferredValue=function(t){return kt.current.useDeferredValue(t)};ie.useEffect=function(t,e){return kt.current.useEffect(t,e)};ie.useId=function(){return kt.current.useId()};ie.useImperativeHandle=function(t,e,n){return kt.current.useImperativeHandle(t,e,n)};ie.useInsertionEffect=function(t,e){return kt.current.useInsertionEffect(t,e)};ie.useLayoutEffect=function(t,e){return kt.current.useLayoutEffect(t,e)};ie.useMemo=function(t,e){return kt.current.useMemo(t,e)};ie.useReducer=function(t,e,n){return kt.current.useReducer(t,e,n)};ie.useRef=function(t){return kt.current.useRef(t)};ie.useState=function(t){return kt.current.useState(t)};ie.useSyncExternalStore=function(t,e,n){return kt.current.useSyncExternalStore(t,e,n)};ie.useTransition=function(){return kt.current.useTransition()};ie.version="18.3.1";v_.exports=ie;var k=v_.exports;const fn=YS(k),hC=QS({__proto__:null,default:fn},[k]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fC=k,pC=Symbol.for("react.element"),mC=Symbol.for("react.fragment"),gC=Object.prototype.hasOwnProperty,yC=fC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vC={key:!0,ref:!0,__self:!0,__source:!0};function R_(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)gC.call(e,r)&&!vC.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:pC,type:t,key:i,ref:o,props:s,_owner:yC.current}}Wu.Fragment=mC;Wu.jsx=R_;Wu.jsxs=R_;y_.exports=Wu;var d=y_.exports,Zd={},A_={exports:{}},Yt={},N_={exports:{}},b_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(z,V){var $=z.length;z.push(V);e:for(;0<$;){var Q=$-1>>>1,se=z[Q];if(0<s(se,V))z[Q]=V,z[$]=se,$=Q;else break e}}function n(z){return z.length===0?null:z[0]}function r(z){if(z.length===0)return null;var V=z[0],$=z.pop();if($!==V){z[0]=$;e:for(var Q=0,se=z.length,ce=se>>>1;Q<ce;){var ft=2*(Q+1)-1,Rt=z[ft],Ue=ft+1,Ye=z[Ue];if(0>s(Rt,$))Ue<se&&0>s(Ye,Rt)?(z[Q]=Ye,z[Ue]=$,Q=Ue):(z[Q]=Rt,z[ft]=$,Q=ft);else if(Ue<se&&0>s(Ye,$))z[Q]=Ye,z[Ue]=$,Q=Ue;else break e}}return V}function s(z,V){var $=z.sortIndex-V.sortIndex;return $!==0?$:z.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,p=null,m=3,g=!1,v=!1,E=!1,N=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(z){for(var V=n(c);V!==null;){if(V.callback===null)r(c);else if(V.startTime<=z)r(c),V.sortIndex=V.expirationTime,e(l,V);else break;V=n(c)}}function D(z){if(E=!1,x(z),!v)if(n(l)!==null)v=!0,Se(O);else{var V=n(c);V!==null&&fe(D,V.startTime-z)}}function O(z,V){v=!1,E&&(E=!1,S(w),w=-1),g=!0;var $=m;try{for(x(V),p=n(l);p!==null&&(!(p.expirationTime>V)||z&&!b());){var Q=p.callback;if(typeof Q=="function"){p.callback=null,m=p.priorityLevel;var se=Q(p.expirationTime<=V);V=t.unstable_now(),typeof se=="function"?p.callback=se:p===n(l)&&r(l),x(V)}else r(l);p=n(l)}if(p!==null)var ce=!0;else{var ft=n(c);ft!==null&&fe(D,ft.startTime-V),ce=!1}return ce}finally{p=null,m=$,g=!1}}var j=!1,R=null,w=-1,C=5,T=-1;function b(){return!(t.unstable_now()-T<C)}function P(){if(R!==null){var z=t.unstable_now();T=z;var V=!0;try{V=R(!0,z)}finally{V?A():(j=!1,R=null)}}else j=!1}var A;if(typeof _=="function")A=function(){_(P)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,ge=X.port2;X.port1.onmessage=P,A=function(){ge.postMessage(null)}}else A=function(){N(P,0)};function Se(z){R=z,j||(j=!0,A())}function fe(z,V){w=N(function(){z(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){v||g||(v=!0,Se(O))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(z){switch(m){case 1:case 2:case 3:var V=3;break;default:V=m}var $=m;m=V;try{return z()}finally{m=$}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,V){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var $=m;m=z;try{return V()}finally{m=$}},t.unstable_scheduleCallback=function(z,V,$){var Q=t.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?Q+$:Q):$=Q,z){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=$+se,z={id:h++,callback:V,priorityLevel:z,startTime:$,expirationTime:se,sortIndex:-1},$>Q?(z.sortIndex=$,e(c,z),n(l)===null&&z===n(c)&&(E?(S(w),w=-1):E=!0,fe(D,$-Q))):(z.sortIndex=se,e(l,z),v||g||(v=!0,Se(O))),z},t.unstable_shouldYield=b,t.unstable_wrapCallback=function(z){var V=m;return function(){var $=m;m=V;try{return z.apply(this,arguments)}finally{m=$}}}})(b_);N_.exports=b_;var _C=N_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wC=k,Kt=_C;function B(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var k_=new Set,Qo={};function bs(t,e){_i(t,e),_i(t+"Capture",e)}function _i(t,e){for(Qo[t]=e,t=0;t<e.length;t++)k_.add(e[t])}var Jn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),eh=Object.prototype.hasOwnProperty,xC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Tg={},Rg={};function EC(t){return eh.call(Rg,t)?!0:eh.call(Tg,t)?!1:xC.test(t)?Rg[t]=!0:(Tg[t]=!0,!1)}function SC(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function CC(t,e,n,r){if(e===null||typeof e>"u"||SC(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Pt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var dt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){dt[t]=new Pt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];dt[e]=new Pt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){dt[t]=new Pt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){dt[t]=new Pt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){dt[t]=new Pt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){dt[t]=new Pt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){dt[t]=new Pt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){dt[t]=new Pt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){dt[t]=new Pt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Mf=/[\-:]([a-z])/g;function Vf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Mf,Vf);dt[e]=new Pt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Mf,Vf);dt[e]=new Pt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Mf,Vf);dt[e]=new Pt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){dt[t]=new Pt(t,1,!1,t.toLowerCase(),null,!1,!1)});dt.xlinkHref=new Pt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){dt[t]=new Pt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Of(t,e,n,r){var s=dt.hasOwnProperty(e)?dt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(CC(e,n,s,r)&&(n=null),r||s===null?EC(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var lr=wC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ul=Symbol.for("react.element"),Gs=Symbol.for("react.portal"),Ws=Symbol.for("react.fragment"),Lf=Symbol.for("react.strict_mode"),th=Symbol.for("react.profiler"),P_=Symbol.for("react.provider"),D_=Symbol.for("react.context"),Ff=Symbol.for("react.forward_ref"),nh=Symbol.for("react.suspense"),rh=Symbol.for("react.suspense_list"),Uf=Symbol.for("react.memo"),vr=Symbol.for("react.lazy"),j_=Symbol.for("react.offscreen"),Ag=Symbol.iterator;function ho(t){return t===null||typeof t!="object"?null:(t=Ag&&t[Ag]||t["@@iterator"],typeof t=="function"?t:null)}var Pe=Object.assign,id;function So(t){if(id===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);id=e&&e[1]||""}return`
`+id+t}var od=!1;function ad(t,e){if(!t||od)return"";od=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{od=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?So(t):""}function IC(t){switch(t.tag){case 5:return So(t.type);case 16:return So("Lazy");case 13:return So("Suspense");case 19:return So("SuspenseList");case 0:case 2:case 15:return t=ad(t.type,!1),t;case 11:return t=ad(t.type.render,!1),t;case 1:return t=ad(t.type,!0),t;default:return""}}function sh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ws:return"Fragment";case Gs:return"Portal";case th:return"Profiler";case Lf:return"StrictMode";case nh:return"Suspense";case rh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case D_:return(t.displayName||"Context")+".Consumer";case P_:return(t._context.displayName||"Context")+".Provider";case Ff:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Uf:return e=t.displayName||null,e!==null?e:sh(t.type)||"Memo";case vr:e=t._payload,t=t._init;try{return sh(t(e))}catch{}}return null}function TC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sh(e);case 8:return e===Lf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Hr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function M_(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function RC(t){var e=M_(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function cl(t){t._valueTracker||(t._valueTracker=RC(t))}function V_(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=M_(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function nu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ih(t,e){var n=e.checked;return Pe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Ng(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Hr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function O_(t,e){e=e.checked,e!=null&&Of(t,"checked",e,!1)}function oh(t,e){O_(t,e);var n=Hr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ah(t,e.type,n):e.hasOwnProperty("defaultValue")&&ah(t,e.type,Hr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function bg(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function ah(t,e,n){(e!=="number"||nu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Co=Array.isArray;function oi(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Hr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function lh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(B(91));return Pe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function kg(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(B(92));if(Co(n)){if(1<n.length)throw Error(B(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Hr(n)}}function L_(t,e){var n=Hr(e.value),r=Hr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Pg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function F_(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function uh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?F_(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var dl,U_=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(dl=dl||document.createElement("div"),dl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=dl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Yo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var jo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},AC=["Webkit","ms","Moz","O"];Object.keys(jo).forEach(function(t){AC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),jo[e]=jo[t]})});function $_(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||jo.hasOwnProperty(t)&&jo[t]?(""+e).trim():e+"px"}function z_(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=$_(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var NC=Pe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ch(t,e){if(e){if(NC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(B(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(B(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(B(61))}if(e.style!=null&&typeof e.style!="object")throw Error(B(62))}}function dh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hh=null;function $f(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var fh=null,ai=null,li=null;function Dg(t){if(t=Ra(t)){if(typeof fh!="function")throw Error(B(280));var e=t.stateNode;e&&(e=Ju(e),fh(t.stateNode,t.type,e))}}function B_(t){ai?li?li.push(t):li=[t]:ai=t}function q_(){if(ai){var t=ai,e=li;if(li=ai=null,Dg(t),e)for(t=0;t<e.length;t++)Dg(e[t])}}function H_(t,e){return t(e)}function G_(){}var ld=!1;function W_(t,e,n){if(ld)return t(e,n);ld=!0;try{return H_(t,e,n)}finally{ld=!1,(ai!==null||li!==null)&&(G_(),q_())}}function Xo(t,e){var n=t.stateNode;if(n===null)return null;var r=Ju(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(B(231,e,typeof n));return n}var ph=!1;if(Jn)try{var fo={};Object.defineProperty(fo,"passive",{get:function(){ph=!0}}),window.addEventListener("test",fo,fo),window.removeEventListener("test",fo,fo)}catch{ph=!1}function bC(t,e,n,r,s,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(h){this.onError(h)}}var Mo=!1,ru=null,su=!1,mh=null,kC={onError:function(t){Mo=!0,ru=t}};function PC(t,e,n,r,s,i,o,a,l){Mo=!1,ru=null,bC.apply(kC,arguments)}function DC(t,e,n,r,s,i,o,a,l){if(PC.apply(this,arguments),Mo){if(Mo){var c=ru;Mo=!1,ru=null}else throw Error(B(198));su||(su=!0,mh=c)}}function ks(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function K_(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function jg(t){if(ks(t)!==t)throw Error(B(188))}function jC(t){var e=t.alternate;if(!e){if(e=ks(t),e===null)throw Error(B(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return jg(s),t;if(i===r)return jg(s),e;i=i.sibling}throw Error(B(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(B(189))}}if(n.alternate!==r)throw Error(B(190))}if(n.tag!==3)throw Error(B(188));return n.stateNode.current===n?t:e}function Q_(t){return t=jC(t),t!==null?Y_(t):null}function Y_(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Y_(t);if(e!==null)return e;t=t.sibling}return null}var X_=Kt.unstable_scheduleCallback,Mg=Kt.unstable_cancelCallback,MC=Kt.unstable_shouldYield,VC=Kt.unstable_requestPaint,Fe=Kt.unstable_now,OC=Kt.unstable_getCurrentPriorityLevel,zf=Kt.unstable_ImmediatePriority,J_=Kt.unstable_UserBlockingPriority,iu=Kt.unstable_NormalPriority,LC=Kt.unstable_LowPriority,Z_=Kt.unstable_IdlePriority,Ku=null,An=null;function FC(t){if(An&&typeof An.onCommitFiberRoot=="function")try{An.onCommitFiberRoot(Ku,t,void 0,(t.current.flags&128)===128)}catch{}}var yn=Math.clz32?Math.clz32:zC,UC=Math.log,$C=Math.LN2;function zC(t){return t>>>=0,t===0?32:31-(UC(t)/$C|0)|0}var hl=64,fl=4194304;function Io(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ou(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Io(a):(i&=o,i!==0&&(r=Io(i)))}else o=n&~s,o!==0?r=Io(o):i!==0&&(r=Io(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-yn(e),s=1<<n,r|=t[n],e&=~s;return r}function BC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qC(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-yn(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=BC(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function gh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ew(){var t=hl;return hl<<=1,!(hl&4194240)&&(hl=64),t}function ud(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ia(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-yn(e),t[e]=n}function HC(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-yn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Bf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-yn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var ye=0;function tw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var nw,qf,rw,sw,iw,yh=!1,pl=[],Dr=null,jr=null,Mr=null,Jo=new Map,Zo=new Map,wr=[],GC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Vg(t,e){switch(t){case"focusin":case"focusout":Dr=null;break;case"dragenter":case"dragleave":jr=null;break;case"mouseover":case"mouseout":Mr=null;break;case"pointerover":case"pointerout":Jo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zo.delete(e.pointerId)}}function po(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Ra(e),e!==null&&qf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function WC(t,e,n,r,s){switch(e){case"focusin":return Dr=po(Dr,t,e,n,r,s),!0;case"dragenter":return jr=po(jr,t,e,n,r,s),!0;case"mouseover":return Mr=po(Mr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Jo.set(i,po(Jo.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Zo.set(i,po(Zo.get(i)||null,t,e,n,r,s)),!0}return!1}function ow(t){var e=ds(t.target);if(e!==null){var n=ks(e);if(n!==null){if(e=n.tag,e===13){if(e=K_(n),e!==null){t.blockedOn=e,iw(t.priority,function(){rw(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ol(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=vh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);hh=r,n.target.dispatchEvent(r),hh=null}else return e=Ra(n),e!==null&&qf(e),t.blockedOn=n,!1;e.shift()}return!0}function Og(t,e,n){Ol(t)&&n.delete(e)}function KC(){yh=!1,Dr!==null&&Ol(Dr)&&(Dr=null),jr!==null&&Ol(jr)&&(jr=null),Mr!==null&&Ol(Mr)&&(Mr=null),Jo.forEach(Og),Zo.forEach(Og)}function mo(t,e){t.blockedOn===e&&(t.blockedOn=null,yh||(yh=!0,Kt.unstable_scheduleCallback(Kt.unstable_NormalPriority,KC)))}function ea(t){function e(s){return mo(s,t)}if(0<pl.length){mo(pl[0],t);for(var n=1;n<pl.length;n++){var r=pl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Dr!==null&&mo(Dr,t),jr!==null&&mo(jr,t),Mr!==null&&mo(Mr,t),Jo.forEach(e),Zo.forEach(e),n=0;n<wr.length;n++)r=wr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<wr.length&&(n=wr[0],n.blockedOn===null);)ow(n),n.blockedOn===null&&wr.shift()}var ui=lr.ReactCurrentBatchConfig,au=!0;function QC(t,e,n,r){var s=ye,i=ui.transition;ui.transition=null;try{ye=1,Hf(t,e,n,r)}finally{ye=s,ui.transition=i}}function YC(t,e,n,r){var s=ye,i=ui.transition;ui.transition=null;try{ye=4,Hf(t,e,n,r)}finally{ye=s,ui.transition=i}}function Hf(t,e,n,r){if(au){var s=vh(t,e,n,r);if(s===null)_d(t,e,r,lu,n),Vg(t,r);else if(WC(s,t,e,n,r))r.stopPropagation();else if(Vg(t,r),e&4&&-1<GC.indexOf(t)){for(;s!==null;){var i=Ra(s);if(i!==null&&nw(i),i=vh(t,e,n,r),i===null&&_d(t,e,r,lu,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else _d(t,e,r,null,n)}}var lu=null;function vh(t,e,n,r){if(lu=null,t=$f(r),t=ds(t),t!==null)if(e=ks(t),e===null)t=null;else if(n=e.tag,n===13){if(t=K_(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return lu=t,null}function aw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(OC()){case zf:return 1;case J_:return 4;case iu:case LC:return 16;case Z_:return 536870912;default:return 16}default:return 16}}var Rr=null,Gf=null,Ll=null;function lw(){if(Ll)return Ll;var t,e=Gf,n=e.length,r,s="value"in Rr?Rr.value:Rr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Ll=s.slice(t,1<r?1-r:void 0)}function Fl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ml(){return!0}function Lg(){return!1}function Xt(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ml:Lg,this.isPropagationStopped=Lg,this}return Pe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ml)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ml)},persist:function(){},isPersistent:ml}),e}var Oi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wf=Xt(Oi),Ta=Pe({},Oi,{view:0,detail:0}),XC=Xt(Ta),cd,dd,go,Qu=Pe({},Ta,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Kf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==go&&(go&&t.type==="mousemove"?(cd=t.screenX-go.screenX,dd=t.screenY-go.screenY):dd=cd=0,go=t),cd)},movementY:function(t){return"movementY"in t?t.movementY:dd}}),Fg=Xt(Qu),JC=Pe({},Qu,{dataTransfer:0}),ZC=Xt(JC),eI=Pe({},Ta,{relatedTarget:0}),hd=Xt(eI),tI=Pe({},Oi,{animationName:0,elapsedTime:0,pseudoElement:0}),nI=Xt(tI),rI=Pe({},Oi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),sI=Xt(rI),iI=Pe({},Oi,{data:0}),Ug=Xt(iI),oI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},aI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uI(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=lI[t])?!!e[t]:!1}function Kf(){return uI}var cI=Pe({},Ta,{key:function(t){if(t.key){var e=oI[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Fl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?aI[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Kf,charCode:function(t){return t.type==="keypress"?Fl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Fl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),dI=Xt(cI),hI=Pe({},Qu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$g=Xt(hI),fI=Pe({},Ta,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Kf}),pI=Xt(fI),mI=Pe({},Oi,{propertyName:0,elapsedTime:0,pseudoElement:0}),gI=Xt(mI),yI=Pe({},Qu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),vI=Xt(yI),_I=[9,13,27,32],Qf=Jn&&"CompositionEvent"in window,Vo=null;Jn&&"documentMode"in document&&(Vo=document.documentMode);var wI=Jn&&"TextEvent"in window&&!Vo,uw=Jn&&(!Qf||Vo&&8<Vo&&11>=Vo),zg=" ",Bg=!1;function cw(t,e){switch(t){case"keyup":return _I.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ks=!1;function xI(t,e){switch(t){case"compositionend":return dw(e);case"keypress":return e.which!==32?null:(Bg=!0,zg);case"textInput":return t=e.data,t===zg&&Bg?null:t;default:return null}}function EI(t,e){if(Ks)return t==="compositionend"||!Qf&&cw(t,e)?(t=lw(),Ll=Gf=Rr=null,Ks=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return uw&&e.locale!=="ko"?null:e.data;default:return null}}var SI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!SI[t.type]:e==="textarea"}function hw(t,e,n,r){B_(r),e=uu(e,"onChange"),0<e.length&&(n=new Wf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Oo=null,ta=null;function CI(t){Sw(t,0)}function Yu(t){var e=Xs(t);if(V_(e))return t}function II(t,e){if(t==="change")return e}var fw=!1;if(Jn){var fd;if(Jn){var pd="oninput"in document;if(!pd){var Hg=document.createElement("div");Hg.setAttribute("oninput","return;"),pd=typeof Hg.oninput=="function"}fd=pd}else fd=!1;fw=fd&&(!document.documentMode||9<document.documentMode)}function Gg(){Oo&&(Oo.detachEvent("onpropertychange",pw),ta=Oo=null)}function pw(t){if(t.propertyName==="value"&&Yu(ta)){var e=[];hw(e,ta,t,$f(t)),W_(CI,e)}}function TI(t,e,n){t==="focusin"?(Gg(),Oo=e,ta=n,Oo.attachEvent("onpropertychange",pw)):t==="focusout"&&Gg()}function RI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Yu(ta)}function AI(t,e){if(t==="click")return Yu(e)}function NI(t,e){if(t==="input"||t==="change")return Yu(e)}function bI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var wn=typeof Object.is=="function"?Object.is:bI;function na(t,e){if(wn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!eh.call(e,s)||!wn(t[s],e[s]))return!1}return!0}function Wg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Kg(t,e){var n=Wg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Wg(n)}}function mw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?mw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function gw(){for(var t=window,e=nu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=nu(t.document)}return e}function Yf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function kI(t){var e=gw(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&mw(n.ownerDocument.documentElement,n)){if(r!==null&&Yf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Kg(n,i);var o=Kg(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var PI=Jn&&"documentMode"in document&&11>=document.documentMode,Qs=null,_h=null,Lo=null,wh=!1;function Qg(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;wh||Qs==null||Qs!==nu(r)||(r=Qs,"selectionStart"in r&&Yf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Lo&&na(Lo,r)||(Lo=r,r=uu(_h,"onSelect"),0<r.length&&(e=new Wf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Qs)))}function gl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ys={animationend:gl("Animation","AnimationEnd"),animationiteration:gl("Animation","AnimationIteration"),animationstart:gl("Animation","AnimationStart"),transitionend:gl("Transition","TransitionEnd")},md={},yw={};Jn&&(yw=document.createElement("div").style,"AnimationEvent"in window||(delete Ys.animationend.animation,delete Ys.animationiteration.animation,delete Ys.animationstart.animation),"TransitionEvent"in window||delete Ys.transitionend.transition);function Xu(t){if(md[t])return md[t];if(!Ys[t])return t;var e=Ys[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in yw)return md[t]=e[n];return t}var vw=Xu("animationend"),_w=Xu("animationiteration"),ww=Xu("animationstart"),xw=Xu("transitionend"),Ew=new Map,Yg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Jr(t,e){Ew.set(t,e),bs(e,[t])}for(var gd=0;gd<Yg.length;gd++){var yd=Yg[gd],DI=yd.toLowerCase(),jI=yd[0].toUpperCase()+yd.slice(1);Jr(DI,"on"+jI)}Jr(vw,"onAnimationEnd");Jr(_w,"onAnimationIteration");Jr(ww,"onAnimationStart");Jr("dblclick","onDoubleClick");Jr("focusin","onFocus");Jr("focusout","onBlur");Jr(xw,"onTransitionEnd");_i("onMouseEnter",["mouseout","mouseover"]);_i("onMouseLeave",["mouseout","mouseover"]);_i("onPointerEnter",["pointerout","pointerover"]);_i("onPointerLeave",["pointerout","pointerover"]);bs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));bs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));bs("onBeforeInput",["compositionend","keypress","textInput","paste"]);bs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));bs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));bs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var To="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MI=new Set("cancel close invalid load scroll toggle".split(" ").concat(To));function Xg(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,DC(r,e,void 0,t),t.currentTarget=null}function Sw(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;Xg(s,a,c),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;Xg(s,a,c),i=l}}}if(su)throw t=mh,su=!1,mh=null,t}function Ie(t,e){var n=e[Ih];n===void 0&&(n=e[Ih]=new Set);var r=t+"__bubble";n.has(r)||(Cw(e,t,2,!1),n.add(r))}function vd(t,e,n){var r=0;e&&(r|=4),Cw(n,t,r,e)}var yl="_reactListening"+Math.random().toString(36).slice(2);function ra(t){if(!t[yl]){t[yl]=!0,k_.forEach(function(n){n!=="selectionchange"&&(MI.has(n)||vd(n,!1,t),vd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[yl]||(e[yl]=!0,vd("selectionchange",!1,e))}}function Cw(t,e,n,r){switch(aw(e)){case 1:var s=QC;break;case 4:s=YC;break;default:s=Hf}n=s.bind(null,e,n,t),s=void 0,!ph||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function _d(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=ds(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}W_(function(){var c=i,h=$f(n),p=[];e:{var m=Ew.get(t);if(m!==void 0){var g=Wf,v=t;switch(t){case"keypress":if(Fl(n)===0)break e;case"keydown":case"keyup":g=dI;break;case"focusin":v="focus",g=hd;break;case"focusout":v="blur",g=hd;break;case"beforeblur":case"afterblur":g=hd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Fg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=ZC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=pI;break;case vw:case _w:case ww:g=nI;break;case xw:g=gI;break;case"scroll":g=XC;break;case"wheel":g=vI;break;case"copy":case"cut":case"paste":g=sI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=$g}var E=(e&4)!==0,N=!E&&t==="scroll",S=E?m!==null?m+"Capture":null:m;E=[];for(var _=c,x;_!==null;){x=_;var D=x.stateNode;if(x.tag===5&&D!==null&&(x=D,S!==null&&(D=Xo(_,S),D!=null&&E.push(sa(_,D,x)))),N)break;_=_.return}0<E.length&&(m=new g(m,v,null,n,h),p.push({event:m,listeners:E}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",m&&n!==hh&&(v=n.relatedTarget||n.fromElement)&&(ds(v)||v[Zn]))break e;if((g||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,g?(v=n.relatedTarget||n.toElement,g=c,v=v?ds(v):null,v!==null&&(N=ks(v),v!==N||v.tag!==5&&v.tag!==6)&&(v=null)):(g=null,v=c),g!==v)){if(E=Fg,D="onMouseLeave",S="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(E=$g,D="onPointerLeave",S="onPointerEnter",_="pointer"),N=g==null?m:Xs(g),x=v==null?m:Xs(v),m=new E(D,_+"leave",g,n,h),m.target=N,m.relatedTarget=x,D=null,ds(h)===c&&(E=new E(S,_+"enter",v,n,h),E.target=x,E.relatedTarget=N,D=E),N=D,g&&v)t:{for(E=g,S=v,_=0,x=E;x;x=zs(x))_++;for(x=0,D=S;D;D=zs(D))x++;for(;0<_-x;)E=zs(E),_--;for(;0<x-_;)S=zs(S),x--;for(;_--;){if(E===S||S!==null&&E===S.alternate)break t;E=zs(E),S=zs(S)}E=null}else E=null;g!==null&&Jg(p,m,g,E,!1),v!==null&&N!==null&&Jg(p,N,v,E,!0)}}e:{if(m=c?Xs(c):window,g=m.nodeName&&m.nodeName.toLowerCase(),g==="select"||g==="input"&&m.type==="file")var O=II;else if(qg(m))if(fw)O=NI;else{O=RI;var j=TI}else(g=m.nodeName)&&g.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(O=AI);if(O&&(O=O(t,c))){hw(p,O,n,h);break e}j&&j(t,m,c),t==="focusout"&&(j=m._wrapperState)&&j.controlled&&m.type==="number"&&ah(m,"number",m.value)}switch(j=c?Xs(c):window,t){case"focusin":(qg(j)||j.contentEditable==="true")&&(Qs=j,_h=c,Lo=null);break;case"focusout":Lo=_h=Qs=null;break;case"mousedown":wh=!0;break;case"contextmenu":case"mouseup":case"dragend":wh=!1,Qg(p,n,h);break;case"selectionchange":if(PI)break;case"keydown":case"keyup":Qg(p,n,h)}var R;if(Qf)e:{switch(t){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Ks?cw(t,n)&&(w="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(w="onCompositionStart");w&&(uw&&n.locale!=="ko"&&(Ks||w!=="onCompositionStart"?w==="onCompositionEnd"&&Ks&&(R=lw()):(Rr=h,Gf="value"in Rr?Rr.value:Rr.textContent,Ks=!0)),j=uu(c,w),0<j.length&&(w=new Ug(w,t,null,n,h),p.push({event:w,listeners:j}),R?w.data=R:(R=dw(n),R!==null&&(w.data=R)))),(R=wI?xI(t,n):EI(t,n))&&(c=uu(c,"onBeforeInput"),0<c.length&&(h=new Ug("onBeforeInput","beforeinput",null,n,h),p.push({event:h,listeners:c}),h.data=R))}Sw(p,e)})}function sa(t,e,n){return{instance:t,listener:e,currentTarget:n}}function uu(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Xo(t,n),i!=null&&r.unshift(sa(t,i,s)),i=Xo(t,e),i!=null&&r.push(sa(t,i,s))),t=t.return}return r}function zs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Jg(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,s?(l=Xo(n,i),l!=null&&o.unshift(sa(n,l,a))):s||(l=Xo(n,i),l!=null&&o.push(sa(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var VI=/\r\n?/g,OI=/\u0000|\uFFFD/g;function Zg(t){return(typeof t=="string"?t:""+t).replace(VI,`
`).replace(OI,"")}function vl(t,e,n){if(e=Zg(e),Zg(t)!==e&&n)throw Error(B(425))}function cu(){}var xh=null,Eh=null;function Sh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ch=typeof setTimeout=="function"?setTimeout:void 0,LI=typeof clearTimeout=="function"?clearTimeout:void 0,ey=typeof Promise=="function"?Promise:void 0,FI=typeof queueMicrotask=="function"?queueMicrotask:typeof ey<"u"?function(t){return ey.resolve(null).then(t).catch(UI)}:Ch;function UI(t){setTimeout(function(){throw t})}function wd(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),ea(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);ea(e)}function Vr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ty(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Li=Math.random().toString(36).slice(2),Tn="__reactFiber$"+Li,ia="__reactProps$"+Li,Zn="__reactContainer$"+Li,Ih="__reactEvents$"+Li,$I="__reactListeners$"+Li,zI="__reactHandles$"+Li;function ds(t){var e=t[Tn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Zn]||n[Tn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=ty(t);t!==null;){if(n=t[Tn])return n;t=ty(t)}return e}t=n,n=t.parentNode}return null}function Ra(t){return t=t[Tn]||t[Zn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Xs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(B(33))}function Ju(t){return t[ia]||null}var Th=[],Js=-1;function Zr(t){return{current:t}}function Re(t){0>Js||(t.current=Th[Js],Th[Js]=null,Js--)}function Ee(t,e){Js++,Th[Js]=t.current,t.current=e}var Gr={},It=Zr(Gr),Vt=Zr(!1),vs=Gr;function wi(t,e){var n=t.type.contextTypes;if(!n)return Gr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ot(t){return t=t.childContextTypes,t!=null}function du(){Re(Vt),Re(It)}function ny(t,e,n){if(It.current!==Gr)throw Error(B(168));Ee(It,e),Ee(Vt,n)}function Iw(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(B(108,TC(t)||"Unknown",s));return Pe({},n,r)}function hu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Gr,vs=It.current,Ee(It,t),Ee(Vt,Vt.current),!0}function ry(t,e,n){var r=t.stateNode;if(!r)throw Error(B(169));n?(t=Iw(t,e,vs),r.__reactInternalMemoizedMergedChildContext=t,Re(Vt),Re(It),Ee(It,t)):Re(Vt),Ee(Vt,n)}var Bn=null,Zu=!1,xd=!1;function Tw(t){Bn===null?Bn=[t]:Bn.push(t)}function BI(t){Zu=!0,Tw(t)}function es(){if(!xd&&Bn!==null){xd=!0;var t=0,e=ye;try{var n=Bn;for(ye=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Bn=null,Zu=!1}catch(s){throw Bn!==null&&(Bn=Bn.slice(t+1)),X_(zf,es),s}finally{ye=e,xd=!1}}return null}var Zs=[],ei=0,fu=null,pu=0,Zt=[],en=0,_s=null,qn=1,Hn="";function ls(t,e){Zs[ei++]=pu,Zs[ei++]=fu,fu=t,pu=e}function Rw(t,e,n){Zt[en++]=qn,Zt[en++]=Hn,Zt[en++]=_s,_s=t;var r=qn;t=Hn;var s=32-yn(r)-1;r&=~(1<<s),n+=1;var i=32-yn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,qn=1<<32-yn(e)+s|n<<s|r,Hn=i+t}else qn=1<<i|n<<s|r,Hn=t}function Xf(t){t.return!==null&&(ls(t,1),Rw(t,1,0))}function Jf(t){for(;t===fu;)fu=Zs[--ei],Zs[ei]=null,pu=Zs[--ei],Zs[ei]=null;for(;t===_s;)_s=Zt[--en],Zt[en]=null,Hn=Zt[--en],Zt[en]=null,qn=Zt[--en],Zt[en]=null}var Wt=null,Ht=null,Ae=!1,gn=null;function Aw(t,e){var n=rn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function sy(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Wt=t,Ht=Vr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Wt=t,Ht=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=_s!==null?{id:qn,overflow:Hn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=rn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Wt=t,Ht=null,!0):!1;default:return!1}}function Rh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ah(t){if(Ae){var e=Ht;if(e){var n=e;if(!sy(t,e)){if(Rh(t))throw Error(B(418));e=Vr(n.nextSibling);var r=Wt;e&&sy(t,e)?Aw(r,n):(t.flags=t.flags&-4097|2,Ae=!1,Wt=t)}}else{if(Rh(t))throw Error(B(418));t.flags=t.flags&-4097|2,Ae=!1,Wt=t}}}function iy(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Wt=t}function _l(t){if(t!==Wt)return!1;if(!Ae)return iy(t),Ae=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Sh(t.type,t.memoizedProps)),e&&(e=Ht)){if(Rh(t))throw Nw(),Error(B(418));for(;e;)Aw(t,e),e=Vr(e.nextSibling)}if(iy(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(B(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ht=Vr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ht=null}}else Ht=Wt?Vr(t.stateNode.nextSibling):null;return!0}function Nw(){for(var t=Ht;t;)t=Vr(t.nextSibling)}function xi(){Ht=Wt=null,Ae=!1}function Zf(t){gn===null?gn=[t]:gn.push(t)}var qI=lr.ReactCurrentBatchConfig;function yo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(B(309));var r=n.stateNode}if(!r)throw Error(B(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(B(284));if(!n._owner)throw Error(B(290,t))}return t}function wl(t,e){throw t=Object.prototype.toString.call(e),Error(B(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function oy(t){var e=t._init;return e(t._payload)}function bw(t){function e(S,_){if(t){var x=S.deletions;x===null?(S.deletions=[_],S.flags|=16):x.push(_)}}function n(S,_){if(!t)return null;for(;_!==null;)e(S,_),_=_.sibling;return null}function r(S,_){for(S=new Map;_!==null;)_.key!==null?S.set(_.key,_):S.set(_.index,_),_=_.sibling;return S}function s(S,_){return S=Ur(S,_),S.index=0,S.sibling=null,S}function i(S,_,x){return S.index=x,t?(x=S.alternate,x!==null?(x=x.index,x<_?(S.flags|=2,_):x):(S.flags|=2,_)):(S.flags|=1048576,_)}function o(S){return t&&S.alternate===null&&(S.flags|=2),S}function a(S,_,x,D){return _===null||_.tag!==6?(_=Ad(x,S.mode,D),_.return=S,_):(_=s(_,x),_.return=S,_)}function l(S,_,x,D){var O=x.type;return O===Ws?h(S,_,x.props.children,D,x.key):_!==null&&(_.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===vr&&oy(O)===_.type)?(D=s(_,x.props),D.ref=yo(S,_,x),D.return=S,D):(D=Gl(x.type,x.key,x.props,null,S.mode,D),D.ref=yo(S,_,x),D.return=S,D)}function c(S,_,x,D){return _===null||_.tag!==4||_.stateNode.containerInfo!==x.containerInfo||_.stateNode.implementation!==x.implementation?(_=Nd(x,S.mode,D),_.return=S,_):(_=s(_,x.children||[]),_.return=S,_)}function h(S,_,x,D,O){return _===null||_.tag!==7?(_=gs(x,S.mode,D,O),_.return=S,_):(_=s(_,x),_.return=S,_)}function p(S,_,x){if(typeof _=="string"&&_!==""||typeof _=="number")return _=Ad(""+_,S.mode,x),_.return=S,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case ul:return x=Gl(_.type,_.key,_.props,null,S.mode,x),x.ref=yo(S,null,_),x.return=S,x;case Gs:return _=Nd(_,S.mode,x),_.return=S,_;case vr:var D=_._init;return p(S,D(_._payload),x)}if(Co(_)||ho(_))return _=gs(_,S.mode,x,null),_.return=S,_;wl(S,_)}return null}function m(S,_,x,D){var O=_!==null?_.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return O!==null?null:a(S,_,""+x,D);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case ul:return x.key===O?l(S,_,x,D):null;case Gs:return x.key===O?c(S,_,x,D):null;case vr:return O=x._init,m(S,_,O(x._payload),D)}if(Co(x)||ho(x))return O!==null?null:h(S,_,x,D,null);wl(S,x)}return null}function g(S,_,x,D,O){if(typeof D=="string"&&D!==""||typeof D=="number")return S=S.get(x)||null,a(_,S,""+D,O);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case ul:return S=S.get(D.key===null?x:D.key)||null,l(_,S,D,O);case Gs:return S=S.get(D.key===null?x:D.key)||null,c(_,S,D,O);case vr:var j=D._init;return g(S,_,x,j(D._payload),O)}if(Co(D)||ho(D))return S=S.get(x)||null,h(_,S,D,O,null);wl(_,D)}return null}function v(S,_,x,D){for(var O=null,j=null,R=_,w=_=0,C=null;R!==null&&w<x.length;w++){R.index>w?(C=R,R=null):C=R.sibling;var T=m(S,R,x[w],D);if(T===null){R===null&&(R=C);break}t&&R&&T.alternate===null&&e(S,R),_=i(T,_,w),j===null?O=T:j.sibling=T,j=T,R=C}if(w===x.length)return n(S,R),Ae&&ls(S,w),O;if(R===null){for(;w<x.length;w++)R=p(S,x[w],D),R!==null&&(_=i(R,_,w),j===null?O=R:j.sibling=R,j=R);return Ae&&ls(S,w),O}for(R=r(S,R);w<x.length;w++)C=g(R,S,w,x[w],D),C!==null&&(t&&C.alternate!==null&&R.delete(C.key===null?w:C.key),_=i(C,_,w),j===null?O=C:j.sibling=C,j=C);return t&&R.forEach(function(b){return e(S,b)}),Ae&&ls(S,w),O}function E(S,_,x,D){var O=ho(x);if(typeof O!="function")throw Error(B(150));if(x=O.call(x),x==null)throw Error(B(151));for(var j=O=null,R=_,w=_=0,C=null,T=x.next();R!==null&&!T.done;w++,T=x.next()){R.index>w?(C=R,R=null):C=R.sibling;var b=m(S,R,T.value,D);if(b===null){R===null&&(R=C);break}t&&R&&b.alternate===null&&e(S,R),_=i(b,_,w),j===null?O=b:j.sibling=b,j=b,R=C}if(T.done)return n(S,R),Ae&&ls(S,w),O;if(R===null){for(;!T.done;w++,T=x.next())T=p(S,T.value,D),T!==null&&(_=i(T,_,w),j===null?O=T:j.sibling=T,j=T);return Ae&&ls(S,w),O}for(R=r(S,R);!T.done;w++,T=x.next())T=g(R,S,w,T.value,D),T!==null&&(t&&T.alternate!==null&&R.delete(T.key===null?w:T.key),_=i(T,_,w),j===null?O=T:j.sibling=T,j=T);return t&&R.forEach(function(P){return e(S,P)}),Ae&&ls(S,w),O}function N(S,_,x,D){if(typeof x=="object"&&x!==null&&x.type===Ws&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case ul:e:{for(var O=x.key,j=_;j!==null;){if(j.key===O){if(O=x.type,O===Ws){if(j.tag===7){n(S,j.sibling),_=s(j,x.props.children),_.return=S,S=_;break e}}else if(j.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===vr&&oy(O)===j.type){n(S,j.sibling),_=s(j,x.props),_.ref=yo(S,j,x),_.return=S,S=_;break e}n(S,j);break}else e(S,j);j=j.sibling}x.type===Ws?(_=gs(x.props.children,S.mode,D,x.key),_.return=S,S=_):(D=Gl(x.type,x.key,x.props,null,S.mode,D),D.ref=yo(S,_,x),D.return=S,S=D)}return o(S);case Gs:e:{for(j=x.key;_!==null;){if(_.key===j)if(_.tag===4&&_.stateNode.containerInfo===x.containerInfo&&_.stateNode.implementation===x.implementation){n(S,_.sibling),_=s(_,x.children||[]),_.return=S,S=_;break e}else{n(S,_);break}else e(S,_);_=_.sibling}_=Nd(x,S.mode,D),_.return=S,S=_}return o(S);case vr:return j=x._init,N(S,_,j(x._payload),D)}if(Co(x))return v(S,_,x,D);if(ho(x))return E(S,_,x,D);wl(S,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,_!==null&&_.tag===6?(n(S,_.sibling),_=s(_,x),_.return=S,S=_):(n(S,_),_=Ad(x,S.mode,D),_.return=S,S=_),o(S)):n(S,_)}return N}var Ei=bw(!0),kw=bw(!1),mu=Zr(null),gu=null,ti=null,ep=null;function tp(){ep=ti=gu=null}function np(t){var e=mu.current;Re(mu),t._currentValue=e}function Nh(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ci(t,e){gu=t,ep=ti=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Mt=!0),t.firstContext=null)}function an(t){var e=t._currentValue;if(ep!==t)if(t={context:t,memoizedValue:e,next:null},ti===null){if(gu===null)throw Error(B(308));ti=t,gu.dependencies={lanes:0,firstContext:t}}else ti=ti.next=t;return e}var hs=null;function rp(t){hs===null?hs=[t]:hs.push(t)}function Pw(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,rp(e)):(n.next=s.next,s.next=n),e.interleaved=n,er(t,r)}function er(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var _r=!1;function sp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Dw(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Qn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Or(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,he&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,er(t,n)}return s=r.interleaved,s===null?(e.next=e,rp(r)):(e.next=s.next,s.next=e),r.interleaved=e,er(t,n)}function Ul(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Bf(t,n)}}function ay(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function yu(t,e,n,r){var s=t.updateQueue;_r=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=c:a.next=c,h.lastBaseUpdate=l))}if(i!==null){var p=s.baseState;o=0,h=c=l=null,a=i;do{var m=a.lane,g=a.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var v=t,E=a;switch(m=e,g=n,E.tag){case 1:if(v=E.payload,typeof v=="function"){p=v.call(g,p,m);break e}p=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=E.payload,m=typeof v=="function"?v.call(g,p,m):v,m==null)break e;p=Pe({},p,m);break e;case 2:_r=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else g={eventTime:g,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(c=h=g,l=p):h=h.next=g,o|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(h===null&&(l=p),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);xs|=o,t.lanes=o,t.memoizedState=p}}function ly(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(B(191,s));s.call(r)}}}var Aa={},Nn=Zr(Aa),oa=Zr(Aa),aa=Zr(Aa);function fs(t){if(t===Aa)throw Error(B(174));return t}function ip(t,e){switch(Ee(aa,e),Ee(oa,t),Ee(Nn,Aa),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:uh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=uh(e,t)}Re(Nn),Ee(Nn,e)}function Si(){Re(Nn),Re(oa),Re(aa)}function jw(t){fs(aa.current);var e=fs(Nn.current),n=uh(e,t.type);e!==n&&(Ee(oa,t),Ee(Nn,n))}function op(t){oa.current===t&&(Re(Nn),Re(oa))}var Ne=Zr(0);function vu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ed=[];function ap(){for(var t=0;t<Ed.length;t++)Ed[t]._workInProgressVersionPrimary=null;Ed.length=0}var $l=lr.ReactCurrentDispatcher,Sd=lr.ReactCurrentBatchConfig,ws=0,be=null,Ge=null,et=null,_u=!1,Fo=!1,la=0,HI=0;function yt(){throw Error(B(321))}function lp(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!wn(t[n],e[n]))return!1;return!0}function up(t,e,n,r,s,i){if(ws=i,be=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,$l.current=t===null||t.memoizedState===null?QI:YI,t=n(r,s),Fo){i=0;do{if(Fo=!1,la=0,25<=i)throw Error(B(301));i+=1,et=Ge=null,e.updateQueue=null,$l.current=XI,t=n(r,s)}while(Fo)}if($l.current=wu,e=Ge!==null&&Ge.next!==null,ws=0,et=Ge=be=null,_u=!1,e)throw Error(B(300));return t}function cp(){var t=la!==0;return la=0,t}function In(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return et===null?be.memoizedState=et=t:et=et.next=t,et}function ln(){if(Ge===null){var t=be.alternate;t=t!==null?t.memoizedState:null}else t=Ge.next;var e=et===null?be.memoizedState:et.next;if(e!==null)et=e,Ge=t;else{if(t===null)throw Error(B(310));Ge=t,t={memoizedState:Ge.memoizedState,baseState:Ge.baseState,baseQueue:Ge.baseQueue,queue:Ge.queue,next:null},et===null?be.memoizedState=et=t:et=et.next=t}return et}function ua(t,e){return typeof e=="function"?e(t):e}function Cd(t){var e=ln(),n=e.queue;if(n===null)throw Error(B(311));n.lastRenderedReducer=t;var r=Ge,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,c=i;do{var h=c.lane;if((ws&h)===h)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var p={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=p,o=r):l=l.next=p,be.lanes|=h,xs|=h}c=c.next}while(c!==null&&c!==i);l===null?o=r:l.next=a,wn(r,e.memoizedState)||(Mt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,be.lanes|=i,xs|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Id(t){var e=ln(),n=e.queue;if(n===null)throw Error(B(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);wn(i,e.memoizedState)||(Mt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Mw(){}function Vw(t,e){var n=be,r=ln(),s=e(),i=!wn(r.memoizedState,s);if(i&&(r.memoizedState=s,Mt=!0),r=r.queue,dp(Fw.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||et!==null&&et.memoizedState.tag&1){if(n.flags|=2048,ca(9,Lw.bind(null,n,r,s,e),void 0,null),rt===null)throw Error(B(349));ws&30||Ow(n,e,s)}return s}function Ow(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=be.updateQueue,e===null?(e={lastEffect:null,stores:null},be.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Lw(t,e,n,r){e.value=n,e.getSnapshot=r,Uw(e)&&$w(t)}function Fw(t,e,n){return n(function(){Uw(e)&&$w(t)})}function Uw(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!wn(t,n)}catch{return!0}}function $w(t){var e=er(t,1);e!==null&&vn(e,t,1,-1)}function uy(t){var e=In();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ua,lastRenderedState:t},e.queue=t,t=t.dispatch=KI.bind(null,be,t),[e.memoizedState,t]}function ca(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=be.updateQueue,e===null?(e={lastEffect:null,stores:null},be.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function zw(){return ln().memoizedState}function zl(t,e,n,r){var s=In();be.flags|=t,s.memoizedState=ca(1|e,n,void 0,r===void 0?null:r)}function ec(t,e,n,r){var s=ln();r=r===void 0?null:r;var i=void 0;if(Ge!==null){var o=Ge.memoizedState;if(i=o.destroy,r!==null&&lp(r,o.deps)){s.memoizedState=ca(e,n,i,r);return}}be.flags|=t,s.memoizedState=ca(1|e,n,i,r)}function cy(t,e){return zl(8390656,8,t,e)}function dp(t,e){return ec(2048,8,t,e)}function Bw(t,e){return ec(4,2,t,e)}function qw(t,e){return ec(4,4,t,e)}function Hw(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Gw(t,e,n){return n=n!=null?n.concat([t]):null,ec(4,4,Hw.bind(null,e,t),n)}function hp(){}function Ww(t,e){var n=ln();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&lp(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Kw(t,e){var n=ln();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&lp(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Qw(t,e,n){return ws&21?(wn(n,e)||(n=ew(),be.lanes|=n,xs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Mt=!0),t.memoizedState=n)}function GI(t,e){var n=ye;ye=n!==0&&4>n?n:4,t(!0);var r=Sd.transition;Sd.transition={};try{t(!1),e()}finally{ye=n,Sd.transition=r}}function Yw(){return ln().memoizedState}function WI(t,e,n){var r=Fr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Xw(t))Jw(e,n);else if(n=Pw(t,e,n,r),n!==null){var s=bt();vn(n,t,r,s),Zw(n,e,r)}}function KI(t,e,n){var r=Fr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xw(t))Jw(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,wn(a,o)){var l=e.interleaved;l===null?(s.next=s,rp(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=Pw(t,e,s,r),n!==null&&(s=bt(),vn(n,t,r,s),Zw(n,e,r))}}function Xw(t){var e=t.alternate;return t===be||e!==null&&e===be}function Jw(t,e){Fo=_u=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Zw(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Bf(t,n)}}var wu={readContext:an,useCallback:yt,useContext:yt,useEffect:yt,useImperativeHandle:yt,useInsertionEffect:yt,useLayoutEffect:yt,useMemo:yt,useReducer:yt,useRef:yt,useState:yt,useDebugValue:yt,useDeferredValue:yt,useTransition:yt,useMutableSource:yt,useSyncExternalStore:yt,useId:yt,unstable_isNewReconciler:!1},QI={readContext:an,useCallback:function(t,e){return In().memoizedState=[t,e===void 0?null:e],t},useContext:an,useEffect:cy,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,zl(4194308,4,Hw.bind(null,e,t),n)},useLayoutEffect:function(t,e){return zl(4194308,4,t,e)},useInsertionEffect:function(t,e){return zl(4,2,t,e)},useMemo:function(t,e){var n=In();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=In();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=WI.bind(null,be,t),[r.memoizedState,t]},useRef:function(t){var e=In();return t={current:t},e.memoizedState=t},useState:uy,useDebugValue:hp,useDeferredValue:function(t){return In().memoizedState=t},useTransition:function(){var t=uy(!1),e=t[0];return t=GI.bind(null,t[1]),In().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=be,s=In();if(Ae){if(n===void 0)throw Error(B(407));n=n()}else{if(n=e(),rt===null)throw Error(B(349));ws&30||Ow(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,cy(Fw.bind(null,r,i,t),[t]),r.flags|=2048,ca(9,Lw.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=In(),e=rt.identifierPrefix;if(Ae){var n=Hn,r=qn;n=(r&~(1<<32-yn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=la++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=HI++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},YI={readContext:an,useCallback:Ww,useContext:an,useEffect:dp,useImperativeHandle:Gw,useInsertionEffect:Bw,useLayoutEffect:qw,useMemo:Kw,useReducer:Cd,useRef:zw,useState:function(){return Cd(ua)},useDebugValue:hp,useDeferredValue:function(t){var e=ln();return Qw(e,Ge.memoizedState,t)},useTransition:function(){var t=Cd(ua)[0],e=ln().memoizedState;return[t,e]},useMutableSource:Mw,useSyncExternalStore:Vw,useId:Yw,unstable_isNewReconciler:!1},XI={readContext:an,useCallback:Ww,useContext:an,useEffect:dp,useImperativeHandle:Gw,useInsertionEffect:Bw,useLayoutEffect:qw,useMemo:Kw,useReducer:Id,useRef:zw,useState:function(){return Id(ua)},useDebugValue:hp,useDeferredValue:function(t){var e=ln();return Ge===null?e.memoizedState=t:Qw(e,Ge.memoizedState,t)},useTransition:function(){var t=Id(ua)[0],e=ln().memoizedState;return[t,e]},useMutableSource:Mw,useSyncExternalStore:Vw,useId:Yw,unstable_isNewReconciler:!1};function pn(t,e){if(t&&t.defaultProps){e=Pe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function bh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Pe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var tc={isMounted:function(t){return(t=t._reactInternals)?ks(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=bt(),s=Fr(t),i=Qn(r,s);i.payload=e,n!=null&&(i.callback=n),e=Or(t,i,s),e!==null&&(vn(e,t,s,r),Ul(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=bt(),s=Fr(t),i=Qn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Or(t,i,s),e!==null&&(vn(e,t,s,r),Ul(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=bt(),r=Fr(t),s=Qn(n,r);s.tag=2,e!=null&&(s.callback=e),e=Or(t,s,r),e!==null&&(vn(e,t,r,n),Ul(e,t,r))}};function dy(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!na(n,r)||!na(s,i):!0}function e0(t,e,n){var r=!1,s=Gr,i=e.contextType;return typeof i=="object"&&i!==null?i=an(i):(s=Ot(e)?vs:It.current,r=e.contextTypes,i=(r=r!=null)?wi(t,s):Gr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=tc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function hy(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&tc.enqueueReplaceState(e,e.state,null)}function kh(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},sp(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=an(i):(i=Ot(e)?vs:It.current,s.context=wi(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(bh(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&tc.enqueueReplaceState(s,s.state,null),yu(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Ci(t,e){try{var n="",r=e;do n+=IC(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Td(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Ph(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var JI=typeof WeakMap=="function"?WeakMap:Map;function t0(t,e,n){n=Qn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Eu||(Eu=!0,zh=r),Ph(t,e)},n}function n0(t,e,n){n=Qn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Ph(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Ph(t,e),typeof r!="function"&&(Lr===null?Lr=new Set([this]):Lr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function fy(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new JI;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=hT.bind(null,t,e,n),e.then(t,t))}function py(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function my(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Qn(-1,1),e.tag=2,Or(n,e,1))),n.lanes|=1),t)}var ZI=lr.ReactCurrentOwner,Mt=!1;function Nt(t,e,n,r){e.child=t===null?kw(e,null,n,r):Ei(e,t.child,n,r)}function gy(t,e,n,r,s){n=n.render;var i=e.ref;return ci(e,s),r=up(t,e,n,r,i,s),n=cp(),t!==null&&!Mt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,tr(t,e,s)):(Ae&&n&&Xf(e),e.flags|=1,Nt(t,e,r,s),e.child)}function yy(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!wp(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,r0(t,e,i,r,s)):(t=Gl(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:na,n(o,r)&&t.ref===e.ref)return tr(t,e,s)}return e.flags|=1,t=Ur(i,r),t.ref=e.ref,t.return=e,e.child=t}function r0(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(na(i,r)&&t.ref===e.ref)if(Mt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Mt=!0);else return e.lanes=t.lanes,tr(t,e,s)}return Dh(t,e,n,r,s)}function s0(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ee(ri,qt),qt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ee(ri,qt),qt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ee(ri,qt),qt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ee(ri,qt),qt|=r;return Nt(t,e,s,n),e.child}function i0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Dh(t,e,n,r,s){var i=Ot(n)?vs:It.current;return i=wi(e,i),ci(e,s),n=up(t,e,n,r,i,s),r=cp(),t!==null&&!Mt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,tr(t,e,s)):(Ae&&r&&Xf(e),e.flags|=1,Nt(t,e,n,s),e.child)}function vy(t,e,n,r,s){if(Ot(n)){var i=!0;hu(e)}else i=!1;if(ci(e,s),e.stateNode===null)Bl(t,e),e0(e,n,r),kh(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=an(c):(c=Ot(n)?vs:It.current,c=wi(e,c));var h=n.getDerivedStateFromProps,p=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&hy(e,o,r,c),_r=!1;var m=e.memoizedState;o.state=m,yu(e,r,o,s),l=e.memoizedState,a!==r||m!==l||Vt.current||_r?(typeof h=="function"&&(bh(e,n,h,r),l=e.memoizedState),(a=_r||dy(e,n,a,r,m,l,c))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Dw(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:pn(e.type,a),o.props=c,p=e.pendingProps,m=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=an(l):(l=Ot(n)?vs:It.current,l=wi(e,l));var g=n.getDerivedStateFromProps;(h=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||m!==l)&&hy(e,o,r,l),_r=!1,m=e.memoizedState,o.state=m,yu(e,r,o,s);var v=e.memoizedState;a!==p||m!==v||Vt.current||_r?(typeof g=="function"&&(bh(e,n,g,r),v=e.memoizedState),(c=_r||dy(e,n,c,r,m,v,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,v,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,v,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=v),o.props=r,o.state=v,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return jh(t,e,n,r,i,s)}function jh(t,e,n,r,s,i){i0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&ry(e,n,!1),tr(t,e,i);r=e.stateNode,ZI.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ei(e,t.child,null,i),e.child=Ei(e,null,a,i)):Nt(t,e,a,i),e.memoizedState=r.state,s&&ry(e,n,!0),e.child}function o0(t){var e=t.stateNode;e.pendingContext?ny(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ny(t,e.context,!1),ip(t,e.containerInfo)}function _y(t,e,n,r,s){return xi(),Zf(s),e.flags|=256,Nt(t,e,n,r),e.child}var Mh={dehydrated:null,treeContext:null,retryLane:0};function Vh(t){return{baseLanes:t,cachePool:null,transitions:null}}function a0(t,e,n){var r=e.pendingProps,s=Ne.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ee(Ne,s&1),t===null)return Ah(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=sc(o,r,0,null),t=gs(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Vh(n),e.memoizedState=Mh,t):fp(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return eT(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ur(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=Ur(a,i):(i=gs(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Vh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Mh,r}return i=t.child,t=i.sibling,r=Ur(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function fp(t,e){return e=sc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function xl(t,e,n,r){return r!==null&&Zf(r),Ei(e,t.child,null,n),t=fp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function eT(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Td(Error(B(422))),xl(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=sc({mode:"visible",children:r.children},s,0,null),i=gs(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ei(e,t.child,null,o),e.child.memoizedState=Vh(o),e.memoizedState=Mh,i);if(!(e.mode&1))return xl(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(B(419)),r=Td(i,r,void 0),xl(t,e,o,r)}if(a=(o&t.childLanes)!==0,Mt||a){if(r=rt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,er(t,s),vn(r,t,s,-1))}return _p(),r=Td(Error(B(421))),xl(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=fT.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Ht=Vr(s.nextSibling),Wt=e,Ae=!0,gn=null,t!==null&&(Zt[en++]=qn,Zt[en++]=Hn,Zt[en++]=_s,qn=t.id,Hn=t.overflow,_s=e),e=fp(e,r.children),e.flags|=4096,e)}function wy(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Nh(t.return,e,n)}function Rd(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function l0(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Nt(t,e,r.children,n),r=Ne.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&wy(t,n,e);else if(t.tag===19)wy(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ee(Ne,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&vu(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Rd(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&vu(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Rd(e,!0,n,null,i);break;case"together":Rd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Bl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function tr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),xs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(B(153));if(e.child!==null){for(t=e.child,n=Ur(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ur(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function tT(t,e,n){switch(e.tag){case 3:o0(e),xi();break;case 5:jw(e);break;case 1:Ot(e.type)&&hu(e);break;case 4:ip(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ee(mu,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ee(Ne,Ne.current&1),e.flags|=128,null):n&e.child.childLanes?a0(t,e,n):(Ee(Ne,Ne.current&1),t=tr(t,e,n),t!==null?t.sibling:null);Ee(Ne,Ne.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return l0(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ee(Ne,Ne.current),r)break;return null;case 22:case 23:return e.lanes=0,s0(t,e,n)}return tr(t,e,n)}var u0,Oh,c0,d0;u0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Oh=function(){};c0=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,fs(Nn.current);var i=null;switch(n){case"input":s=ih(t,s),r=ih(t,r),i=[];break;case"select":s=Pe({},s,{value:void 0}),r=Pe({},r,{value:void 0}),i=[];break;case"textarea":s=lh(t,s),r=lh(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=cu)}ch(n,r);var o;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Qo.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Qo.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ie("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};d0=function(t,e,n,r){n!==r&&(e.flags|=4)};function vo(t,e){if(!Ae)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function vt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function nT(t,e,n){var r=e.pendingProps;switch(Jf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vt(e),null;case 1:return Ot(e.type)&&du(),vt(e),null;case 3:return r=e.stateNode,Si(),Re(Vt),Re(It),ap(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(_l(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,gn!==null&&(Hh(gn),gn=null))),Oh(t,e),vt(e),null;case 5:op(e);var s=fs(aa.current);if(n=e.type,t!==null&&e.stateNode!=null)c0(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(B(166));return vt(e),null}if(t=fs(Nn.current),_l(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Tn]=e,r[ia]=i,t=(e.mode&1)!==0,n){case"dialog":Ie("cancel",r),Ie("close",r);break;case"iframe":case"object":case"embed":Ie("load",r);break;case"video":case"audio":for(s=0;s<To.length;s++)Ie(To[s],r);break;case"source":Ie("error",r);break;case"img":case"image":case"link":Ie("error",r),Ie("load",r);break;case"details":Ie("toggle",r);break;case"input":Ng(r,i),Ie("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ie("invalid",r);break;case"textarea":kg(r,i),Ie("invalid",r)}ch(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&vl(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&vl(r.textContent,a,t),s=["children",""+a]):Qo.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ie("scroll",r)}switch(n){case"input":cl(r),bg(r,i,!0);break;case"textarea":cl(r),Pg(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=cu)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=F_(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Tn]=e,t[ia]=r,u0(t,e,!1,!1),e.stateNode=t;e:{switch(o=dh(n,r),n){case"dialog":Ie("cancel",t),Ie("close",t),s=r;break;case"iframe":case"object":case"embed":Ie("load",t),s=r;break;case"video":case"audio":for(s=0;s<To.length;s++)Ie(To[s],t);s=r;break;case"source":Ie("error",t),s=r;break;case"img":case"image":case"link":Ie("error",t),Ie("load",t),s=r;break;case"details":Ie("toggle",t),s=r;break;case"input":Ng(t,r),s=ih(t,r),Ie("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Pe({},r,{value:void 0}),Ie("invalid",t);break;case"textarea":kg(t,r),s=lh(t,r),Ie("invalid",t);break;default:s=r}ch(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?z_(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&U_(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Yo(t,l):typeof l=="number"&&Yo(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Qo.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Ie("scroll",t):l!=null&&Of(t,i,l,o))}switch(n){case"input":cl(t),bg(t,r,!1);break;case"textarea":cl(t),Pg(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Hr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?oi(t,!!r.multiple,i,!1):r.defaultValue!=null&&oi(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=cu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return vt(e),null;case 6:if(t&&e.stateNode!=null)d0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(B(166));if(n=fs(aa.current),fs(Nn.current),_l(e)){if(r=e.stateNode,n=e.memoizedProps,r[Tn]=e,(i=r.nodeValue!==n)&&(t=Wt,t!==null))switch(t.tag){case 3:vl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&vl(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Tn]=e,e.stateNode=r}return vt(e),null;case 13:if(Re(Ne),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ae&&Ht!==null&&e.mode&1&&!(e.flags&128))Nw(),xi(),e.flags|=98560,i=!1;else if(i=_l(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(B(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(B(317));i[Tn]=e}else xi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;vt(e),i=!1}else gn!==null&&(Hh(gn),gn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ne.current&1?We===0&&(We=3):_p())),e.updateQueue!==null&&(e.flags|=4),vt(e),null);case 4:return Si(),Oh(t,e),t===null&&ra(e.stateNode.containerInfo),vt(e),null;case 10:return np(e.type._context),vt(e),null;case 17:return Ot(e.type)&&du(),vt(e),null;case 19:if(Re(Ne),i=e.memoizedState,i===null)return vt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)vo(i,!1);else{if(We!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=vu(t),o!==null){for(e.flags|=128,vo(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ee(Ne,Ne.current&1|2),e.child}t=t.sibling}i.tail!==null&&Fe()>Ii&&(e.flags|=128,r=!0,vo(i,!1),e.lanes=4194304)}else{if(!r)if(t=vu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),vo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ae)return vt(e),null}else 2*Fe()-i.renderingStartTime>Ii&&n!==1073741824&&(e.flags|=128,r=!0,vo(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Fe(),e.sibling=null,n=Ne.current,Ee(Ne,r?n&1|2:n&1),e):(vt(e),null);case 22:case 23:return vp(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?qt&1073741824&&(vt(e),e.subtreeFlags&6&&(e.flags|=8192)):vt(e),null;case 24:return null;case 25:return null}throw Error(B(156,e.tag))}function rT(t,e){switch(Jf(e),e.tag){case 1:return Ot(e.type)&&du(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Si(),Re(Vt),Re(It),ap(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return op(e),null;case 13:if(Re(Ne),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(B(340));xi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Re(Ne),null;case 4:return Si(),null;case 10:return np(e.type._context),null;case 22:case 23:return vp(),null;case 24:return null;default:return null}}var El=!1,Et=!1,sT=typeof WeakSet=="function"?WeakSet:Set,W=null;function ni(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ve(t,e,r)}else n.current=null}function Lh(t,e,n){try{n()}catch(r){Ve(t,e,r)}}var xy=!1;function iT(t,e){if(xh=au,t=gw(),Yf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,h=0,p=t,m=null;t:for(;;){for(var g;p!==n||s!==0&&p.nodeType!==3||(a=o+s),p!==i||r!==0&&p.nodeType!==3||(l=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(g=p.firstChild)!==null;)m=p,p=g;for(;;){if(p===t)break t;if(m===n&&++c===s&&(a=o),m===i&&++h===r&&(l=o),(g=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=g}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Eh={focusedElem:t,selectionRange:n},au=!1,W=e;W!==null;)if(e=W,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,W=t;else for(;W!==null;){e=W;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var E=v.memoizedProps,N=v.memoizedState,S=e.stateNode,_=S.getSnapshotBeforeUpdate(e.elementType===e.type?E:pn(e.type,E),N);S.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(B(163))}}catch(D){Ve(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,W=t;break}W=e.return}return v=xy,xy=!1,v}function Uo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Lh(e,n,i)}s=s.next}while(s!==r)}}function nc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Fh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function h0(t){var e=t.alternate;e!==null&&(t.alternate=null,h0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Tn],delete e[ia],delete e[Ih],delete e[$I],delete e[zI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function f0(t){return t.tag===5||t.tag===3||t.tag===4}function Ey(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||f0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Uh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=cu));else if(r!==4&&(t=t.child,t!==null))for(Uh(t,e,n),t=t.sibling;t!==null;)Uh(t,e,n),t=t.sibling}function $h(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for($h(t,e,n),t=t.sibling;t!==null;)$h(t,e,n),t=t.sibling}var it=null,mn=!1;function gr(t,e,n){for(n=n.child;n!==null;)p0(t,e,n),n=n.sibling}function p0(t,e,n){if(An&&typeof An.onCommitFiberUnmount=="function")try{An.onCommitFiberUnmount(Ku,n)}catch{}switch(n.tag){case 5:Et||ni(n,e);case 6:var r=it,s=mn;it=null,gr(t,e,n),it=r,mn=s,it!==null&&(mn?(t=it,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):it.removeChild(n.stateNode));break;case 18:it!==null&&(mn?(t=it,n=n.stateNode,t.nodeType===8?wd(t.parentNode,n):t.nodeType===1&&wd(t,n),ea(t)):wd(it,n.stateNode));break;case 4:r=it,s=mn,it=n.stateNode.containerInfo,mn=!0,gr(t,e,n),it=r,mn=s;break;case 0:case 11:case 14:case 15:if(!Et&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Lh(n,e,o),s=s.next}while(s!==r)}gr(t,e,n);break;case 1:if(!Et&&(ni(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Ve(n,e,a)}gr(t,e,n);break;case 21:gr(t,e,n);break;case 22:n.mode&1?(Et=(r=Et)||n.memoizedState!==null,gr(t,e,n),Et=r):gr(t,e,n);break;default:gr(t,e,n)}}function Sy(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new sT),e.forEach(function(r){var s=pT.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function hn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:it=a.stateNode,mn=!1;break e;case 3:it=a.stateNode.containerInfo,mn=!0;break e;case 4:it=a.stateNode.containerInfo,mn=!0;break e}a=a.return}if(it===null)throw Error(B(160));p0(i,o,s),it=null,mn=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){Ve(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)m0(e,t),e=e.sibling}function m0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(hn(e,t),Cn(t),r&4){try{Uo(3,t,t.return),nc(3,t)}catch(E){Ve(t,t.return,E)}try{Uo(5,t,t.return)}catch(E){Ve(t,t.return,E)}}break;case 1:hn(e,t),Cn(t),r&512&&n!==null&&ni(n,n.return);break;case 5:if(hn(e,t),Cn(t),r&512&&n!==null&&ni(n,n.return),t.flags&32){var s=t.stateNode;try{Yo(s,"")}catch(E){Ve(t,t.return,E)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&O_(s,i),dh(a,o);var c=dh(a,i);for(o=0;o<l.length;o+=2){var h=l[o],p=l[o+1];h==="style"?z_(s,p):h==="dangerouslySetInnerHTML"?U_(s,p):h==="children"?Yo(s,p):Of(s,h,p,c)}switch(a){case"input":oh(s,i);break;case"textarea":L_(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?oi(s,!!i.multiple,g,!1):m!==!!i.multiple&&(i.defaultValue!=null?oi(s,!!i.multiple,i.defaultValue,!0):oi(s,!!i.multiple,i.multiple?[]:"",!1))}s[ia]=i}catch(E){Ve(t,t.return,E)}}break;case 6:if(hn(e,t),Cn(t),r&4){if(t.stateNode===null)throw Error(B(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(E){Ve(t,t.return,E)}}break;case 3:if(hn(e,t),Cn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ea(e.containerInfo)}catch(E){Ve(t,t.return,E)}break;case 4:hn(e,t),Cn(t);break;case 13:hn(e,t),Cn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(gp=Fe())),r&4&&Sy(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(Et=(c=Et)||h,hn(e,t),Et=c):hn(e,t),Cn(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!h&&t.mode&1)for(W=t,h=t.child;h!==null;){for(p=W=h;W!==null;){switch(m=W,g=m.child,m.tag){case 0:case 11:case 14:case 15:Uo(4,m,m.return);break;case 1:ni(m,m.return);var v=m.stateNode;if(typeof v.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(E){Ve(r,n,E)}}break;case 5:ni(m,m.return);break;case 22:if(m.memoizedState!==null){Iy(p);continue}}g!==null?(g.return=m,W=g):Iy(p)}h=h.sibling}e:for(h=null,p=t;;){if(p.tag===5){if(h===null){h=p;try{s=p.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=$_("display",o))}catch(E){Ve(t,t.return,E)}}}else if(p.tag===6){if(h===null)try{p.stateNode.nodeValue=c?"":p.memoizedProps}catch(E){Ve(t,t.return,E)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;h===p&&(h=null),p=p.return}h===p&&(h=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:hn(e,t),Cn(t),r&4&&Sy(t);break;case 21:break;default:hn(e,t),Cn(t)}}function Cn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(f0(n)){var r=n;break e}n=n.return}throw Error(B(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Yo(s,""),r.flags&=-33);var i=Ey(t);$h(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Ey(t);Uh(t,a,o);break;default:throw Error(B(161))}}catch(l){Ve(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function oT(t,e,n){W=t,g0(t)}function g0(t,e,n){for(var r=(t.mode&1)!==0;W!==null;){var s=W,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||El;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||Et;a=El;var c=Et;if(El=o,(Et=l)&&!c)for(W=s;W!==null;)o=W,l=o.child,o.tag===22&&o.memoizedState!==null?Ty(s):l!==null?(l.return=o,W=l):Ty(s);for(;i!==null;)W=i,g0(i),i=i.sibling;W=s,El=a,Et=c}Cy(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,W=i):Cy(t)}}function Cy(t){for(;W!==null;){var e=W;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Et||nc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Et)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:pn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&ly(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}ly(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var h=c.memoizedState;if(h!==null){var p=h.dehydrated;p!==null&&ea(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(B(163))}Et||e.flags&512&&Fh(e)}catch(m){Ve(e,e.return,m)}}if(e===t){W=null;break}if(n=e.sibling,n!==null){n.return=e.return,W=n;break}W=e.return}}function Iy(t){for(;W!==null;){var e=W;if(e===t){W=null;break}var n=e.sibling;if(n!==null){n.return=e.return,W=n;break}W=e.return}}function Ty(t){for(;W!==null;){var e=W;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{nc(4,e)}catch(l){Ve(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){Ve(e,s,l)}}var i=e.return;try{Fh(e)}catch(l){Ve(e,i,l)}break;case 5:var o=e.return;try{Fh(e)}catch(l){Ve(e,o,l)}}}catch(l){Ve(e,e.return,l)}if(e===t){W=null;break}var a=e.sibling;if(a!==null){a.return=e.return,W=a;break}W=e.return}}var aT=Math.ceil,xu=lr.ReactCurrentDispatcher,pp=lr.ReactCurrentOwner,sn=lr.ReactCurrentBatchConfig,he=0,rt=null,ze=null,lt=0,qt=0,ri=Zr(0),We=0,da=null,xs=0,rc=0,mp=0,$o=null,Dt=null,gp=0,Ii=1/0,$n=null,Eu=!1,zh=null,Lr=null,Sl=!1,Ar=null,Su=0,zo=0,Bh=null,ql=-1,Hl=0;function bt(){return he&6?Fe():ql!==-1?ql:ql=Fe()}function Fr(t){return t.mode&1?he&2&&lt!==0?lt&-lt:qI.transition!==null?(Hl===0&&(Hl=ew()),Hl):(t=ye,t!==0||(t=window.event,t=t===void 0?16:aw(t.type)),t):1}function vn(t,e,n,r){if(50<zo)throw zo=0,Bh=null,Error(B(185));Ia(t,n,r),(!(he&2)||t!==rt)&&(t===rt&&(!(he&2)&&(rc|=n),We===4&&xr(t,lt)),Lt(t,r),n===1&&he===0&&!(e.mode&1)&&(Ii=Fe()+500,Zu&&es()))}function Lt(t,e){var n=t.callbackNode;qC(t,e);var r=ou(t,t===rt?lt:0);if(r===0)n!==null&&Mg(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Mg(n),e===1)t.tag===0?BI(Ry.bind(null,t)):Tw(Ry.bind(null,t)),FI(function(){!(he&6)&&es()}),n=null;else{switch(tw(r)){case 1:n=zf;break;case 4:n=J_;break;case 16:n=iu;break;case 536870912:n=Z_;break;default:n=iu}n=C0(n,y0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function y0(t,e){if(ql=-1,Hl=0,he&6)throw Error(B(327));var n=t.callbackNode;if(di()&&t.callbackNode!==n)return null;var r=ou(t,t===rt?lt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Cu(t,r);else{e=r;var s=he;he|=2;var i=_0();(rt!==t||lt!==e)&&($n=null,Ii=Fe()+500,ms(t,e));do try{cT();break}catch(a){v0(t,a)}while(!0);tp(),xu.current=i,he=s,ze!==null?e=0:(rt=null,lt=0,e=We)}if(e!==0){if(e===2&&(s=gh(t),s!==0&&(r=s,e=qh(t,s))),e===1)throw n=da,ms(t,0),xr(t,r),Lt(t,Fe()),n;if(e===6)xr(t,r);else{if(s=t.current.alternate,!(r&30)&&!lT(s)&&(e=Cu(t,r),e===2&&(i=gh(t),i!==0&&(r=i,e=qh(t,i))),e===1))throw n=da,ms(t,0),xr(t,r),Lt(t,Fe()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(B(345));case 2:us(t,Dt,$n);break;case 3:if(xr(t,r),(r&130023424)===r&&(e=gp+500-Fe(),10<e)){if(ou(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){bt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Ch(us.bind(null,t,Dt,$n),e);break}us(t,Dt,$n);break;case 4:if(xr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-yn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Fe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*aT(r/1960))-r,10<r){t.timeoutHandle=Ch(us.bind(null,t,Dt,$n),r);break}us(t,Dt,$n);break;case 5:us(t,Dt,$n);break;default:throw Error(B(329))}}}return Lt(t,Fe()),t.callbackNode===n?y0.bind(null,t):null}function qh(t,e){var n=$o;return t.current.memoizedState.isDehydrated&&(ms(t,e).flags|=256),t=Cu(t,e),t!==2&&(e=Dt,Dt=n,e!==null&&Hh(e)),t}function Hh(t){Dt===null?Dt=t:Dt.push.apply(Dt,t)}function lT(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!wn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function xr(t,e){for(e&=~mp,e&=~rc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-yn(e),r=1<<n;t[n]=-1,e&=~r}}function Ry(t){if(he&6)throw Error(B(327));di();var e=ou(t,0);if(!(e&1))return Lt(t,Fe()),null;var n=Cu(t,e);if(t.tag!==0&&n===2){var r=gh(t);r!==0&&(e=r,n=qh(t,r))}if(n===1)throw n=da,ms(t,0),xr(t,e),Lt(t,Fe()),n;if(n===6)throw Error(B(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,us(t,Dt,$n),Lt(t,Fe()),null}function yp(t,e){var n=he;he|=1;try{return t(e)}finally{he=n,he===0&&(Ii=Fe()+500,Zu&&es())}}function Es(t){Ar!==null&&Ar.tag===0&&!(he&6)&&di();var e=he;he|=1;var n=sn.transition,r=ye;try{if(sn.transition=null,ye=1,t)return t()}finally{ye=r,sn.transition=n,he=e,!(he&6)&&es()}}function vp(){qt=ri.current,Re(ri)}function ms(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,LI(n)),ze!==null)for(n=ze.return;n!==null;){var r=n;switch(Jf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&du();break;case 3:Si(),Re(Vt),Re(It),ap();break;case 5:op(r);break;case 4:Si();break;case 13:Re(Ne);break;case 19:Re(Ne);break;case 10:np(r.type._context);break;case 22:case 23:vp()}n=n.return}if(rt=t,ze=t=Ur(t.current,null),lt=qt=e,We=0,da=null,mp=rc=xs=0,Dt=$o=null,hs!==null){for(e=0;e<hs.length;e++)if(n=hs[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}hs=null}return t}function v0(t,e){do{var n=ze;try{if(tp(),$l.current=wu,_u){for(var r=be.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}_u=!1}if(ws=0,et=Ge=be=null,Fo=!1,la=0,pp.current=null,n===null||n.return===null){We=1,da=e,ze=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=lt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,h=a,p=h.tag;if(!(h.mode&1)&&(p===0||p===11||p===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=py(o);if(g!==null){g.flags&=-257,my(g,o,a,i,e),g.mode&1&&fy(i,c,e),e=g,l=c;var v=e.updateQueue;if(v===null){var E=new Set;E.add(l),e.updateQueue=E}else v.add(l);break e}else{if(!(e&1)){fy(i,c,e),_p();break e}l=Error(B(426))}}else if(Ae&&a.mode&1){var N=py(o);if(N!==null){!(N.flags&65536)&&(N.flags|=256),my(N,o,a,i,e),Zf(Ci(l,a));break e}}i=l=Ci(l,a),We!==4&&(We=2),$o===null?$o=[i]:$o.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var S=t0(i,l,e);ay(i,S);break e;case 1:a=l;var _=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Lr===null||!Lr.has(x)))){i.flags|=65536,e&=-e,i.lanes|=e;var D=n0(i,a,e);ay(i,D);break e}}i=i.return}while(i!==null)}x0(n)}catch(O){e=O,ze===n&&n!==null&&(ze=n=n.return);continue}break}while(!0)}function _0(){var t=xu.current;return xu.current=wu,t===null?wu:t}function _p(){(We===0||We===3||We===2)&&(We=4),rt===null||!(xs&268435455)&&!(rc&268435455)||xr(rt,lt)}function Cu(t,e){var n=he;he|=2;var r=_0();(rt!==t||lt!==e)&&($n=null,ms(t,e));do try{uT();break}catch(s){v0(t,s)}while(!0);if(tp(),he=n,xu.current=r,ze!==null)throw Error(B(261));return rt=null,lt=0,We}function uT(){for(;ze!==null;)w0(ze)}function cT(){for(;ze!==null&&!MC();)w0(ze)}function w0(t){var e=S0(t.alternate,t,qt);t.memoizedProps=t.pendingProps,e===null?x0(t):ze=e,pp.current=null}function x0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=rT(n,e),n!==null){n.flags&=32767,ze=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{We=6,ze=null;return}}else if(n=nT(n,e,qt),n!==null){ze=n;return}if(e=e.sibling,e!==null){ze=e;return}ze=e=t}while(e!==null);We===0&&(We=5)}function us(t,e,n){var r=ye,s=sn.transition;try{sn.transition=null,ye=1,dT(t,e,n,r)}finally{sn.transition=s,ye=r}return null}function dT(t,e,n,r){do di();while(Ar!==null);if(he&6)throw Error(B(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(B(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(HC(t,i),t===rt&&(ze=rt=null,lt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Sl||(Sl=!0,C0(iu,function(){return di(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=sn.transition,sn.transition=null;var o=ye;ye=1;var a=he;he|=4,pp.current=null,iT(t,n),m0(n,t),kI(Eh),au=!!xh,Eh=xh=null,t.current=n,oT(n),VC(),he=a,ye=o,sn.transition=i}else t.current=n;if(Sl&&(Sl=!1,Ar=t,Su=s),i=t.pendingLanes,i===0&&(Lr=null),FC(n.stateNode),Lt(t,Fe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Eu)throw Eu=!1,t=zh,zh=null,t;return Su&1&&t.tag!==0&&di(),i=t.pendingLanes,i&1?t===Bh?zo++:(zo=0,Bh=t):zo=0,es(),null}function di(){if(Ar!==null){var t=tw(Su),e=sn.transition,n=ye;try{if(sn.transition=null,ye=16>t?16:t,Ar===null)var r=!1;else{if(t=Ar,Ar=null,Su=0,he&6)throw Error(B(331));var s=he;for(he|=4,W=t.current;W!==null;){var i=W,o=i.child;if(W.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(W=c;W!==null;){var h=W;switch(h.tag){case 0:case 11:case 15:Uo(8,h,i)}var p=h.child;if(p!==null)p.return=h,W=p;else for(;W!==null;){h=W;var m=h.sibling,g=h.return;if(h0(h),h===c){W=null;break}if(m!==null){m.return=g,W=m;break}W=g}}}var v=i.alternate;if(v!==null){var E=v.child;if(E!==null){v.child=null;do{var N=E.sibling;E.sibling=null,E=N}while(E!==null)}}W=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,W=o;else e:for(;W!==null;){if(i=W,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Uo(9,i,i.return)}var S=i.sibling;if(S!==null){S.return=i.return,W=S;break e}W=i.return}}var _=t.current;for(W=_;W!==null;){o=W;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,W=x;else e:for(o=_;W!==null;){if(a=W,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:nc(9,a)}}catch(O){Ve(a,a.return,O)}if(a===o){W=null;break e}var D=a.sibling;if(D!==null){D.return=a.return,W=D;break e}W=a.return}}if(he=s,es(),An&&typeof An.onPostCommitFiberRoot=="function")try{An.onPostCommitFiberRoot(Ku,t)}catch{}r=!0}return r}finally{ye=n,sn.transition=e}}return!1}function Ay(t,e,n){e=Ci(n,e),e=t0(t,e,1),t=Or(t,e,1),e=bt(),t!==null&&(Ia(t,1,e),Lt(t,e))}function Ve(t,e,n){if(t.tag===3)Ay(t,t,n);else for(;e!==null;){if(e.tag===3){Ay(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Lr===null||!Lr.has(r))){t=Ci(n,t),t=n0(e,t,1),e=Or(e,t,1),t=bt(),e!==null&&(Ia(e,1,t),Lt(e,t));break}}e=e.return}}function hT(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=bt(),t.pingedLanes|=t.suspendedLanes&n,rt===t&&(lt&n)===n&&(We===4||We===3&&(lt&130023424)===lt&&500>Fe()-gp?ms(t,0):mp|=n),Lt(t,e)}function E0(t,e){e===0&&(t.mode&1?(e=fl,fl<<=1,!(fl&130023424)&&(fl=4194304)):e=1);var n=bt();t=er(t,e),t!==null&&(Ia(t,e,n),Lt(t,n))}function fT(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),E0(t,n)}function pT(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(B(314))}r!==null&&r.delete(e),E0(t,n)}var S0;S0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Vt.current)Mt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Mt=!1,tT(t,e,n);Mt=!!(t.flags&131072)}else Mt=!1,Ae&&e.flags&1048576&&Rw(e,pu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Bl(t,e),t=e.pendingProps;var s=wi(e,It.current);ci(e,n),s=up(null,e,r,t,s,n);var i=cp();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ot(r)?(i=!0,hu(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,sp(e),s.updater=tc,e.stateNode=s,s._reactInternals=e,kh(e,r,t,n),e=jh(null,e,r,!0,i,n)):(e.tag=0,Ae&&i&&Xf(e),Nt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Bl(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=gT(r),t=pn(r,t),s){case 0:e=Dh(null,e,r,t,n);break e;case 1:e=vy(null,e,r,t,n);break e;case 11:e=gy(null,e,r,t,n);break e;case 14:e=yy(null,e,r,pn(r.type,t),n);break e}throw Error(B(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:pn(r,s),Dh(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:pn(r,s),vy(t,e,r,s,n);case 3:e:{if(o0(e),t===null)throw Error(B(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Dw(t,e),yu(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Ci(Error(B(423)),e),e=_y(t,e,r,n,s);break e}else if(r!==s){s=Ci(Error(B(424)),e),e=_y(t,e,r,n,s);break e}else for(Ht=Vr(e.stateNode.containerInfo.firstChild),Wt=e,Ae=!0,gn=null,n=kw(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(xi(),r===s){e=tr(t,e,n);break e}Nt(t,e,r,n)}e=e.child}return e;case 5:return jw(e),t===null&&Ah(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Sh(r,s)?o=null:i!==null&&Sh(r,i)&&(e.flags|=32),i0(t,e),Nt(t,e,o,n),e.child;case 6:return t===null&&Ah(e),null;case 13:return a0(t,e,n);case 4:return ip(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ei(e,null,r,n):Nt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:pn(r,s),gy(t,e,r,s,n);case 7:return Nt(t,e,e.pendingProps,n),e.child;case 8:return Nt(t,e,e.pendingProps.children,n),e.child;case 12:return Nt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Ee(mu,r._currentValue),r._currentValue=o,i!==null)if(wn(i.value,o)){if(i.children===s.children&&!Vt.current){e=tr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=Qn(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var h=c.pending;h===null?l.next=l:(l.next=h.next,h.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Nh(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(B(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Nh(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Nt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,ci(e,n),s=an(s),r=r(s),e.flags|=1,Nt(t,e,r,n),e.child;case 14:return r=e.type,s=pn(r,e.pendingProps),s=pn(r.type,s),yy(t,e,r,s,n);case 15:return r0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:pn(r,s),Bl(t,e),e.tag=1,Ot(r)?(t=!0,hu(e)):t=!1,ci(e,n),e0(e,r,s),kh(e,r,s,n),jh(null,e,r,!0,t,n);case 19:return l0(t,e,n);case 22:return s0(t,e,n)}throw Error(B(156,e.tag))};function C0(t,e){return X_(t,e)}function mT(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function rn(t,e,n,r){return new mT(t,e,n,r)}function wp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function gT(t){if(typeof t=="function")return wp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ff)return 11;if(t===Uf)return 14}return 2}function Ur(t,e){var n=t.alternate;return n===null?(n=rn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Gl(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")wp(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ws:return gs(n.children,s,i,e);case Lf:o=8,s|=8;break;case th:return t=rn(12,n,e,s|2),t.elementType=th,t.lanes=i,t;case nh:return t=rn(13,n,e,s),t.elementType=nh,t.lanes=i,t;case rh:return t=rn(19,n,e,s),t.elementType=rh,t.lanes=i,t;case j_:return sc(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case P_:o=10;break e;case D_:o=9;break e;case Ff:o=11;break e;case Uf:o=14;break e;case vr:o=16,r=null;break e}throw Error(B(130,t==null?t:typeof t,""))}return e=rn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function gs(t,e,n,r){return t=rn(7,t,r,e),t.lanes=n,t}function sc(t,e,n,r){return t=rn(22,t,r,e),t.elementType=j_,t.lanes=n,t.stateNode={isHidden:!1},t}function Ad(t,e,n){return t=rn(6,t,null,e),t.lanes=n,t}function Nd(t,e,n){return e=rn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function yT(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ud(0),this.expirationTimes=ud(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ud(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function xp(t,e,n,r,s,i,o,a,l){return t=new yT(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=rn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},sp(i),t}function vT(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Gs,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function I0(t){if(!t)return Gr;t=t._reactInternals;e:{if(ks(t)!==t||t.tag!==1)throw Error(B(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ot(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(B(171))}if(t.tag===1){var n=t.type;if(Ot(n))return Iw(t,n,e)}return e}function T0(t,e,n,r,s,i,o,a,l){return t=xp(n,r,!0,t,s,i,o,a,l),t.context=I0(null),n=t.current,r=bt(),s=Fr(n),i=Qn(r,s),i.callback=e??null,Or(n,i,s),t.current.lanes=s,Ia(t,s,r),Lt(t,r),t}function ic(t,e,n,r){var s=e.current,i=bt(),o=Fr(s);return n=I0(n),e.context===null?e.context=n:e.pendingContext=n,e=Qn(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Or(s,e,o),t!==null&&(vn(t,s,o,i),Ul(t,s,o)),o}function Iu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Ny(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Ep(t,e){Ny(t,e),(t=t.alternate)&&Ny(t,e)}function _T(){return null}var R0=typeof reportError=="function"?reportError:function(t){console.error(t)};function Sp(t){this._internalRoot=t}oc.prototype.render=Sp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(B(409));ic(t,e,null,null)};oc.prototype.unmount=Sp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Es(function(){ic(null,t,null,null)}),e[Zn]=null}};function oc(t){this._internalRoot=t}oc.prototype.unstable_scheduleHydration=function(t){if(t){var e=sw();t={blockedOn:null,target:t,priority:e};for(var n=0;n<wr.length&&e!==0&&e<wr[n].priority;n++);wr.splice(n,0,t),n===0&&ow(t)}};function Cp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ac(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function by(){}function wT(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=Iu(o);i.call(c)}}var o=T0(e,r,t,0,null,!1,!1,"",by);return t._reactRootContainer=o,t[Zn]=o.current,ra(t.nodeType===8?t.parentNode:t),Es(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=Iu(l);a.call(c)}}var l=xp(t,0,!1,null,null,!1,!1,"",by);return t._reactRootContainer=l,t[Zn]=l.current,ra(t.nodeType===8?t.parentNode:t),Es(function(){ic(e,l,n,r)}),l}function lc(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Iu(o);a.call(l)}}ic(e,o,t,s)}else o=wT(n,e,t,s,r);return Iu(o)}nw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Io(e.pendingLanes);n!==0&&(Bf(e,n|1),Lt(e,Fe()),!(he&6)&&(Ii=Fe()+500,es()))}break;case 13:Es(function(){var r=er(t,1);if(r!==null){var s=bt();vn(r,t,1,s)}}),Ep(t,1)}};qf=function(t){if(t.tag===13){var e=er(t,134217728);if(e!==null){var n=bt();vn(e,t,134217728,n)}Ep(t,134217728)}};rw=function(t){if(t.tag===13){var e=Fr(t),n=er(t,e);if(n!==null){var r=bt();vn(n,t,e,r)}Ep(t,e)}};sw=function(){return ye};iw=function(t,e){var n=ye;try{return ye=t,e()}finally{ye=n}};fh=function(t,e,n){switch(e){case"input":if(oh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Ju(r);if(!s)throw Error(B(90));V_(r),oh(r,s)}}}break;case"textarea":L_(t,n);break;case"select":e=n.value,e!=null&&oi(t,!!n.multiple,e,!1)}};H_=yp;G_=Es;var xT={usingClientEntryPoint:!1,Events:[Ra,Xs,Ju,B_,q_,yp]},_o={findFiberByHostInstance:ds,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ET={bundleType:_o.bundleType,version:_o.version,rendererPackageName:_o.rendererPackageName,rendererConfig:_o.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:lr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Q_(t),t===null?null:t.stateNode},findFiberByHostInstance:_o.findFiberByHostInstance||_T,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cl.isDisabled&&Cl.supportsFiber)try{Ku=Cl.inject(ET),An=Cl}catch{}}Yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xT;Yt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cp(e))throw Error(B(200));return vT(t,e,null,n)};Yt.createRoot=function(t,e){if(!Cp(t))throw Error(B(299));var n=!1,r="",s=R0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=xp(t,1,!1,null,null,n,!1,r,s),t[Zn]=e.current,ra(t.nodeType===8?t.parentNode:t),new Sp(e)};Yt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(B(188)):(t=Object.keys(t).join(","),Error(B(268,t)));return t=Q_(e),t=t===null?null:t.stateNode,t};Yt.flushSync=function(t){return Es(t)};Yt.hydrate=function(t,e,n){if(!ac(e))throw Error(B(200));return lc(null,t,e,!0,n)};Yt.hydrateRoot=function(t,e,n){if(!Cp(t))throw Error(B(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=R0;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=T0(e,null,t,1,n??null,s,!1,i,o),t[Zn]=e.current,ra(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new oc(e)};Yt.render=function(t,e,n){if(!ac(e))throw Error(B(200));return lc(null,t,e,!1,n)};Yt.unmountComponentAtNode=function(t){if(!ac(t))throw Error(B(40));return t._reactRootContainer?(Es(function(){lc(null,null,t,!1,function(){t._reactRootContainer=null,t[Zn]=null})}),!0):!1};Yt.unstable_batchedUpdates=yp;Yt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!ac(n))throw Error(B(200));if(t==null||t._reactInternals===void 0)throw Error(B(38));return lc(t,e,n,!1,r)};Yt.version="18.3.1-next-f1338f8080-20240426";function A0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(A0)}catch(t){console.error(t)}}A0(),A_.exports=Yt;var ST=A_.exports,ky=ST;Zd.createRoot=ky.createRoot,Zd.hydrateRoot=ky.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ha(){return ha=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ha.apply(this,arguments)}var Nr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Nr||(Nr={}));const Py="popstate";function CT(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return Gh("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Tu(s)}return TT(e,n,null,t)}function ke(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ip(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function IT(){return Math.random().toString(36).substr(2,8)}function Dy(t,e){return{usr:t.state,key:t.key,idx:e}}function Gh(t,e,n,r){return n===void 0&&(n=null),ha({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Fi(e):e,{state:n,key:e&&e.key||r||IT()})}function Tu(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Fi(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function TT(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=Nr.Pop,l=null,c=h();c==null&&(c=0,o.replaceState(ha({},o.state,{idx:c}),""));function h(){return(o.state||{idx:null}).idx}function p(){a=Nr.Pop;let N=h(),S=N==null?null:N-c;c=N,l&&l({action:a,location:E.location,delta:S})}function m(N,S){a=Nr.Push;let _=Gh(E.location,N,S);c=h()+1;let x=Dy(_,c),D=E.createHref(_);try{o.pushState(x,"",D)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(D)}i&&l&&l({action:a,location:E.location,delta:1})}function g(N,S){a=Nr.Replace;let _=Gh(E.location,N,S);c=h();let x=Dy(_,c),D=E.createHref(_);o.replaceState(x,"",D),i&&l&&l({action:a,location:E.location,delta:0})}function v(N){let S=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof N=="string"?N:Tu(N);return _=_.replace(/ $/,"%20"),ke(S,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,S)}let E={get action(){return a},get location(){return t(s,o)},listen(N){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(Py,p),l=N,()=>{s.removeEventListener(Py,p),l=null}},createHref(N){return e(s,N)},createURL:v,encodeLocation(N){let S=v(N);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:m,replace:g,go(N){return o.go(N)}};return E}var jy;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(jy||(jy={}));function RT(t,e,n){return n===void 0&&(n="/"),AT(t,e,n)}function AT(t,e,n,r){let s=typeof e=="string"?Fi(e):e,i=Ti(s.pathname||"/",n);if(i==null)return null;let o=N0(t);NT(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=UT(i);a=LT(o[l],c)}return a}function N0(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(ke(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=$r([r,l.relativePath]),h=n.concat(l);i.children&&i.children.length>0&&(ke(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),N0(i.children,e,h,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:VT(c,i.index),routesMeta:h})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of b0(i.path))s(i,o,l)}),e}function b0(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=b0(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function NT(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:OT(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const bT=/^:[\w-]+$/,kT=3,PT=2,DT=1,jT=10,MT=-2,My=t=>t==="*";function VT(t,e){let n=t.split("/"),r=n.length;return n.some(My)&&(r+=MT),e&&(r+=PT),n.filter(s=>!My(s)).reduce((s,i)=>s+(bT.test(i)?kT:i===""?DT:jT),r)}function OT(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function LT(t,e,n){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",p=Wh({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},h),m=l.route;if(!p)return null;Object.assign(s,p.params),o.push({params:s,pathname:$r([i,p.pathname]),pathnameBase:HT($r([i,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(i=$r([i,p.pathnameBase]))}return o}function Wh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=FT(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((c,h,p)=>{let{paramName:m,isOptional:g}=h;if(m==="*"){let E=a[p]||"";o=i.slice(0,i.length-E.length).replace(/(.)\/+$/,"$1")}const v=a[p];return g&&!v?c[m]=void 0:c[m]=(v||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:t}}function FT(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Ip(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function UT(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ip(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Ti(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}const $T=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zT=t=>$T.test(t);function BT(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Fi(t):t,i;if(n)if(zT(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),Ip(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?i=Vy(n.substring(1),"/"):i=Vy(n,e)}else i=e;return{pathname:i,search:GT(r),hash:WT(s)}}function Vy(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function bd(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function qT(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Tp(t,e){let n=qT(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Rp(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Fi(t):(s=ha({},t),ke(!s.pathname||!s.pathname.includes("?"),bd("?","pathname","search",s)),ke(!s.pathname||!s.pathname.includes("#"),bd("#","pathname","hash",s)),ke(!s.search||!s.search.includes("#"),bd("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let p=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;s.pathname=m.join("/")}a=p>=0?e[p]:"/"}let l=BT(s,a),c=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||h)&&(l.pathname+="/"),l}const $r=t=>t.join("/").replace(/\/\/+/g,"/"),HT=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),GT=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,WT=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function KT(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const k0=["post","put","patch","delete"];new Set(k0);const QT=["get",...k0];new Set(QT);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function fa(){return fa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},fa.apply(this,arguments)}const uc=k.createContext(null),P0=k.createContext(null),ur=k.createContext(null),cc=k.createContext(null),Vn=k.createContext({outlet:null,matches:[],isDataRoute:!1}),D0=k.createContext(null);function YT(t,e){let{relative:n}=e===void 0?{}:e;Ui()||ke(!1);let{basename:r,navigator:s}=k.useContext(ur),{hash:i,pathname:o,search:a}=dc(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:$r([r,o])),s.createHref({pathname:l,search:a,hash:i})}function Ui(){return k.useContext(cc)!=null}function On(){return Ui()||ke(!1),k.useContext(cc).location}function j0(t){k.useContext(ur).static||k.useLayoutEffect(t)}function $t(){let{isDataRoute:t}=k.useContext(Vn);return t?dR():XT()}function XT(){Ui()||ke(!1);let t=k.useContext(uc),{basename:e,future:n,navigator:r}=k.useContext(ur),{matches:s}=k.useContext(Vn),{pathname:i}=On(),o=JSON.stringify(Tp(s,n.v7_relativeSplatPath)),a=k.useRef(!1);return j0(()=>{a.current=!0}),k.useCallback(function(c,h){if(h===void 0&&(h={}),!a.current)return;if(typeof c=="number"){r.go(c);return}let p=Rp(c,JSON.parse(o),i,h.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:$r([e,p.pathname])),(h.replace?r.replace:r.push)(p,h.state,h)},[e,r,o,i,t])}const JT=k.createContext(null);function ZT(t){let e=k.useContext(Vn).outlet;return e&&k.createElement(JT.Provider,{value:t},e)}function Na(){let{matches:t}=k.useContext(Vn),e=t[t.length-1];return e?e.params:{}}function dc(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=k.useContext(ur),{matches:s}=k.useContext(Vn),{pathname:i}=On(),o=JSON.stringify(Tp(s,r.v7_relativeSplatPath));return k.useMemo(()=>Rp(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function eR(t,e){return tR(t,e)}function tR(t,e,n,r){Ui()||ke(!1);let{navigator:s}=k.useContext(ur),{matches:i}=k.useContext(Vn),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=On(),h;if(e){var p;let N=typeof e=="string"?Fi(e):e;l==="/"||(p=N.pathname)!=null&&p.startsWith(l)||ke(!1),h=N}else h=c;let m=h.pathname||"/",g=m;if(l!=="/"){let N=l.replace(/^\//,"").split("/");g="/"+m.replace(/^\//,"").split("/").slice(N.length).join("/")}let v=RT(t,{pathname:g}),E=oR(v&&v.map(N=>Object.assign({},N,{params:Object.assign({},a,N.params),pathname:$r([l,s.encodeLocation?s.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?l:$r([l,s.encodeLocation?s.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),i,n,r);return e&&E?k.createElement(cc.Provider,{value:{location:fa({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Nr.Pop}},E):E}function nR(){let t=cR(),e=KT(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},e),n?k.createElement("pre",{style:s},n):null,null)}const rR=k.createElement(nR,null);class sR extends k.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?k.createElement(Vn.Provider,{value:this.props.routeContext},k.createElement(D0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function iR(t){let{routeContext:e,match:n,children:r}=t,s=k.useContext(uc);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),k.createElement(Vn.Provider,{value:e},r)}function oR(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(s=n)==null?void 0:s.errors;if(a!=null){let h=o.findIndex(p=>p.route.id&&(a==null?void 0:a[p.route.id])!==void 0);h>=0||ke(!1),o=o.slice(0,Math.min(o.length,h+1))}let l=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let p=o[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(c=h),p.route.id){let{loaderData:m,errors:g}=n,v=p.route.loader&&m[p.route.id]===void 0&&(!g||g[p.route.id]===void 0);if(p.route.lazy||v){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((h,p,m)=>{let g,v=!1,E=null,N=null;n&&(g=a&&p.route.id?a[p.route.id]:void 0,E=p.route.errorElement||rR,l&&(c<0&&m===0?(hR("route-fallback"),v=!0,N=null):c===m&&(v=!0,N=p.route.hydrateFallbackElement||null)));let S=e.concat(o.slice(0,m+1)),_=()=>{let x;return g?x=E:v?x=N:p.route.Component?x=k.createElement(p.route.Component,null):p.route.element?x=p.route.element:x=h,k.createElement(iR,{match:p,routeContext:{outlet:h,matches:S,isDataRoute:n!=null},children:x})};return n&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?k.createElement(sR,{location:n.location,revalidation:n.revalidation,component:E,error:g,children:_(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):_()},null)}var M0=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(M0||{}),V0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(V0||{});function aR(t){let e=k.useContext(uc);return e||ke(!1),e}function lR(t){let e=k.useContext(P0);return e||ke(!1),e}function uR(t){let e=k.useContext(Vn);return e||ke(!1),e}function O0(t){let e=uR(),n=e.matches[e.matches.length-1];return n.route.id||ke(!1),n.route.id}function cR(){var t;let e=k.useContext(D0),n=lR(),r=O0();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function dR(){let{router:t}=aR(M0.UseNavigateStable),e=O0(V0.UseNavigateStable),n=k.useRef(!1);return j0(()=>{n.current=!0}),k.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,fa({fromRouteId:e},i)))},[t,e])}const Oy={};function hR(t,e,n){Oy[t]||(Oy[t]=!0)}function fR(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function pR(t){let{to:e,replace:n,state:r,relative:s}=t;Ui()||ke(!1);let{future:i,static:o}=k.useContext(ur),{matches:a}=k.useContext(Vn),{pathname:l}=On(),c=$t(),h=Rp(e,Tp(a,i.v7_relativeSplatPath),l,s==="path"),p=JSON.stringify(h);return k.useEffect(()=>c(JSON.parse(p),{replace:n,state:r,relative:s}),[c,p,s,n,r]),null}function L0(t){return ZT(t.context)}function He(t){ke(!1)}function mR(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Nr.Pop,navigator:i,static:o=!1,future:a}=t;Ui()&&ke(!1);let l=e.replace(/^\/*/,"/"),c=k.useMemo(()=>({basename:l,navigator:i,static:o,future:fa({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof r=="string"&&(r=Fi(r));let{pathname:h="/",search:p="",hash:m="",state:g=null,key:v="default"}=r,E=k.useMemo(()=>{let N=Ti(h,l);return N==null?null:{location:{pathname:N,search:p,hash:m,state:g,key:v},navigationType:s}},[l,h,p,m,g,v,s]);return E==null?null:k.createElement(ur.Provider,{value:c},k.createElement(cc.Provider,{children:n,value:E}))}function Ap(t){let{children:e,location:n}=t;return eR(Kh(e),n)}new Promise(()=>{});function Kh(t,e){e===void 0&&(e=[]);let n=[];return k.Children.forEach(t,(r,s)=>{if(!k.isValidElement(r))return;let i=[...e,s];if(r.type===k.Fragment){n.push.apply(n,Kh(r.props.children,i));return}r.type!==He&&ke(!1),!r.props.index||!r.props.children||ke(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Kh(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ru(){return Ru=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ru.apply(this,arguments)}function F0(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function gR(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function yR(t,e){return t.button===0&&(!e||e==="_self")&&!gR(t)}function Qh(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function vR(t,e){let n=Qh(t);return e&&e.forEach((r,s)=>{n.has(s)||e.getAll(s).forEach(i=>{n.append(s,i)})}),n}const _R=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],wR=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],xR="6";try{window.__reactRouterVersion=xR}catch{}const ER=k.createContext({isTransitioning:!1}),SR="startTransition",Ly=hC[SR];function CR(t){let{basename:e,children:n,future:r,window:s}=t,i=k.useRef();i.current==null&&(i.current=CT({window:s,v5Compat:!0}));let o=i.current,[a,l]=k.useState({action:o.action,location:o.location}),{v7_startTransition:c}=r||{},h=k.useCallback(p=>{c&&Ly?Ly(()=>l(p)):l(p)},[l,c]);return k.useLayoutEffect(()=>o.listen(h),[o,h]),k.useEffect(()=>fR(r),[r]),k.createElement(mR,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}const IR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",TR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,br=k.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:h,viewTransition:p}=e,m=F0(e,_R),{basename:g}=k.useContext(ur),v,E=!1;if(typeof c=="string"&&TR.test(c)&&(v=c,IR))try{let x=new URL(window.location.href),D=c.startsWith("//")?new URL(x.protocol+c):new URL(c),O=Ti(D.pathname,g);D.origin===x.origin&&O!=null?c=O+D.search+D.hash:E=!0}catch{}let N=YT(c,{relative:s}),S=NR(c,{replace:o,state:a,target:l,preventScrollReset:h,relative:s,viewTransition:p});function _(x){r&&r(x),x.defaultPrevented||S(x)}return k.createElement("a",Ru({},m,{href:v||N,onClick:E||i?r:_,ref:n,target:l}))}),RR=k.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:s=!1,className:i="",end:o=!1,style:a,to:l,viewTransition:c,children:h}=e,p=F0(e,wR),m=dc(l,{relative:p.relative}),g=On(),v=k.useContext(P0),{navigator:E,basename:N}=k.useContext(ur),S=v!=null&&kR(m)&&c===!0,_=E.encodeLocation?E.encodeLocation(m).pathname:m.pathname,x=g.pathname,D=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;s||(x=x.toLowerCase(),D=D?D.toLowerCase():null,_=_.toLowerCase()),D&&N&&(D=Ti(D,N)||D);const O=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let j=x===_||!o&&x.startsWith(_)&&x.charAt(O)==="/",R=D!=null&&(D===_||!o&&D.startsWith(_)&&D.charAt(_.length)==="/"),w={isActive:j,isPending:R,isTransitioning:S},C=j?r:void 0,T;typeof i=="function"?T=i(w):T=[i,j?"active":null,R?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let b=typeof a=="function"?a(w):a;return k.createElement(br,Ru({},p,{"aria-current":C,className:T,ref:n,style:b,to:l,viewTransition:c}),typeof h=="function"?h(w):h)});var Yh;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Yh||(Yh={}));var Fy;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Fy||(Fy={}));function AR(t){let e=k.useContext(uc);return e||ke(!1),e}function NR(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,l=$t(),c=On(),h=dc(t,{relative:o});return k.useCallback(p=>{if(yR(p,n)){p.preventDefault();let m=r!==void 0?r:Tu(c)===Tu(h);l(t,{replace:m,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[c,l,h,r,s,n,t,i,o,a])}function bR(t){let e=k.useRef(Qh(t)),n=k.useRef(!1),r=On(),s=k.useMemo(()=>vR(r.search,n.current?null:e.current),[r.search]),i=$t(),o=k.useCallback((a,l)=>{const c=Qh(typeof a=="function"?a(s):a);n.current=!0,i("?"+c,l)},[i,s]);return[s,o]}function kR(t,e){e===void 0&&(e={});let n=k.useContext(ER);n==null&&ke(!1);let{basename:r}=AR(Yh.useViewTransitionState),s=dc(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=Ti(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Ti(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Wh(s.pathname,o)!=null||Wh(s.pathname,i)!=null}function Er({children:t}){return d.jsx("div",{className:"min-h-screen bg-gray-50 text-slate-900",children:t})}var Uy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},PR=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},$0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,h=i>>2,p=(i&3)<<4|a>>4;let m=(a&15)<<2|c>>6,g=c&63;l||(g=64,o||(m=64)),r.push(n[h],n[p],n[m],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(U0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):PR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const p=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||c==null||p==null)throw new DR;const m=i<<2|a>>4;if(r.push(m),c!==64){const g=a<<4&240|c>>2;if(r.push(g),p!==64){const v=c<<6&192|p;r.push(v)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class DR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const jR=function(t){const e=U0(t);return $0.encodeByteArray(e,!0)},Au=function(t){return jR(t).replace(/\./g,"")},z0=function(t){try{return $0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VR=()=>MR().__FIREBASE_DEFAULTS__,OR=()=>{if(typeof process>"u"||typeof Uy>"u")return;const t=Uy.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},LR=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&z0(t[1]);return e&&JSON.parse(e)},hc=()=>{try{return VR()||OR()||LR()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},B0=t=>{var e,n;return(n=(e=hc())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},q0=t=>{const e=B0(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},H0=()=>{var t;return(t=hc())===null||t===void 0?void 0:t.config},G0=t=>{var e;return(e=hc())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UR(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Au(JSON.stringify(n)),Au(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function $R(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Tt())}function zR(){var t;const e=(t=hc())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function BR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function qR(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function HR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function GR(){const t=Tt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function WR(){return!zR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function KR(){try{return typeof indexedDB=="object"}catch{return!1}}function QR(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YR="FirebaseError";class Ln extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=YR,Object.setPrototypeOf(this,Ln.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ba.prototype.create)}}class ba{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?XR(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Ln(s,a,r)}}function XR(t,e){return t.replace(JR,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const JR=/\{\$([^}]+)}/g;function ZR(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Nu(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if($y(i)&&$y(o)){if(!Nu(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function $y(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ka(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ro(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Ao(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function eA(t,e){const n=new tA(t,e);return n.subscribe.bind(n)}class tA{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");nA(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=kd),s.error===void 0&&(s.error=kd),s.complete===void 0&&(s.complete=kd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function nA(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function kd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function De(t){return t&&t._delegate?t._delegate:t}class Wr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rA{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new FR;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(iA(e))try{this.getOrInitializeService({instanceIdentifier:cs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=cs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=cs){return this.instances.has(e)}getOptions(e=cs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:sA(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=cs){return this.component?this.component.multipleInstances?e:cs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function sA(t){return t===cs?void 0:t}function iA(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new rA(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var le;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(le||(le={}));const aA={debug:le.DEBUG,verbose:le.VERBOSE,info:le.INFO,warn:le.WARN,error:le.ERROR,silent:le.SILENT},lA=le.INFO,uA={[le.DEBUG]:"log",[le.VERBOSE]:"log",[le.INFO]:"info",[le.WARN]:"warn",[le.ERROR]:"error"},cA=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=uA[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Np{constructor(e){this.name=e,this._logLevel=lA,this._logHandler=cA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in le))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?aA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,le.DEBUG,...e),this._logHandler(this,le.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,le.VERBOSE,...e),this._logHandler(this,le.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,le.INFO,...e),this._logHandler(this,le.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,le.WARN,...e),this._logHandler(this,le.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,le.ERROR,...e),this._logHandler(this,le.ERROR,...e)}}const dA=(t,e)=>e.some(n=>t instanceof n);let zy,By;function hA(){return zy||(zy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function fA(){return By||(By=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const W0=new WeakMap,Xh=new WeakMap,K0=new WeakMap,Pd=new WeakMap,bp=new WeakMap;function pA(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(zr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&W0.set(n,t)}).catch(()=>{}),bp.set(e,t),e}function mA(t){if(Xh.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Xh.set(t,e)}let Jh={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Xh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||K0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return zr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function gA(t){Jh=t(Jh)}function yA(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Dd(this),e,...n);return K0.set(r,e.sort?e.sort():[e]),zr(r)}:fA().includes(t)?function(...e){return t.apply(Dd(this),e),zr(W0.get(this))}:function(...e){return zr(t.apply(Dd(this),e))}}function vA(t){return typeof t=="function"?yA(t):(t instanceof IDBTransaction&&mA(t),dA(t,hA())?new Proxy(t,Jh):t)}function zr(t){if(t instanceof IDBRequest)return pA(t);if(Pd.has(t))return Pd.get(t);const e=vA(t);return e!==t&&(Pd.set(t,e),bp.set(e,t)),e}const Dd=t=>bp.get(t);function _A(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=zr(o);return r&&o.addEventListener("upgradeneeded",l=>{r(zr(o.result),l.oldVersion,l.newVersion,zr(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const wA=["get","getKey","getAll","getAllKeys","count"],xA=["put","add","delete","clear"],jd=new Map;function qy(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(jd.get(e))return jd.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=xA.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||wA.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&l.done]))[0]};return jd.set(e,i),i}gA(t=>({...t,get:(e,n,r)=>qy(e,n)||t.get(e,n,r),has:(e,n)=>!!qy(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(SA(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function SA(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Zh="@firebase/app",Hy="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nr=new Np("@firebase/app"),CA="@firebase/app-compat",IA="@firebase/analytics-compat",TA="@firebase/analytics",RA="@firebase/app-check-compat",AA="@firebase/app-check",NA="@firebase/auth",bA="@firebase/auth-compat",kA="@firebase/database",PA="@firebase/data-connect",DA="@firebase/database-compat",jA="@firebase/functions",MA="@firebase/functions-compat",VA="@firebase/installations",OA="@firebase/installations-compat",LA="@firebase/messaging",FA="@firebase/messaging-compat",UA="@firebase/performance",$A="@firebase/performance-compat",zA="@firebase/remote-config",BA="@firebase/remote-config-compat",qA="@firebase/storage",HA="@firebase/storage-compat",GA="@firebase/firestore",WA="@firebase/vertexai-preview",KA="@firebase/firestore-compat",QA="firebase",YA="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ef="[DEFAULT]",XA={[Zh]:"fire-core",[CA]:"fire-core-compat",[TA]:"fire-analytics",[IA]:"fire-analytics-compat",[AA]:"fire-app-check",[RA]:"fire-app-check-compat",[NA]:"fire-auth",[bA]:"fire-auth-compat",[kA]:"fire-rtdb",[PA]:"fire-data-connect",[DA]:"fire-rtdb-compat",[jA]:"fire-fn",[MA]:"fire-fn-compat",[VA]:"fire-iid",[OA]:"fire-iid-compat",[LA]:"fire-fcm",[FA]:"fire-fcm-compat",[UA]:"fire-perf",[$A]:"fire-perf-compat",[zA]:"fire-rc",[BA]:"fire-rc-compat",[qA]:"fire-gcs",[HA]:"fire-gcs-compat",[GA]:"fire-fst",[KA]:"fire-fst-compat",[WA]:"fire-vertex","fire-js":"fire-js",[QA]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bu=new Map,JA=new Map,tf=new Map;function Gy(t,e){try{t.container.addComponent(e)}catch(n){nr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ss(t){const e=t.name;if(tf.has(e))return nr.debug(`There were multiple attempts to register component ${e}.`),!1;tf.set(e,t);for(const n of bu.values())Gy(n,t);for(const n of JA.values())Gy(n,t);return!0}function fc(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Rn(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Br=new ba("app","Firebase",ZA);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Wr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Br.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $i=YA;function Q0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:ef,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Br.create("bad-app-name",{appName:String(s)});if(n||(n=H0()),!n)throw Br.create("no-options");const i=bu.get(s);if(i){if(Nu(n,i.options)&&Nu(r,i.config))return i;throw Br.create("duplicate-app",{appName:s})}const o=new oA(s);for(const l of tf.values())o.addComponent(l);const a=new e1(n,r,o);return bu.set(s,a),a}function kp(t=ef){const e=bu.get(t);if(!e&&t===ef&&H0())return Q0();if(!e)throw Br.create("no-app",{appName:t});return e}function bn(t,e,n){var r;let s=(r=XA[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),nr.warn(a.join(" "));return}Ss(new Wr(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t1="firebase-heartbeat-database",n1=1,pa="firebase-heartbeat-store";let Md=null;function Y0(){return Md||(Md=_A(t1,n1,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(pa)}catch(n){console.warn(n)}}}}).catch(t=>{throw Br.create("idb-open",{originalErrorMessage:t.message})})),Md}async function r1(t){try{const n=(await Y0()).transaction(pa),r=await n.objectStore(pa).get(X0(t));return await n.done,r}catch(e){if(e instanceof Ln)nr.warn(e.message);else{const n=Br.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});nr.warn(n.message)}}}async function Wy(t,e){try{const r=(await Y0()).transaction(pa,"readwrite");await r.objectStore(pa).put(e,X0(t)),await r.done}catch(n){if(n instanceof Ln)nr.warn(n.message);else{const r=Br.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});nr.warn(r.message)}}}function X0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s1=1024,i1=30*24*60*60*1e3;class o1{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new l1(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Ky();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=i1}),this._storage.overwrite(this._heartbeatsCache))}catch(r){nr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Ky(),{heartbeatsToSend:r,unsentEntries:s}=a1(this._heartbeatsCache.heartbeats),i=Au(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return nr.warn(n),""}}}function Ky(){return new Date().toISOString().substring(0,10)}function a1(t,e=s1){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Qy(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Qy(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class l1{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return KR()?QR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await r1(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Wy(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Wy(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Qy(t){return Au(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u1(t){Ss(new Wr("platform-logger",e=>new EA(e),"PRIVATE")),Ss(new Wr("heartbeat",e=>new o1(e),"PRIVATE")),bn(Zh,Hy,t),bn(Zh,Hy,"esm2017"),bn("fire-js","")}u1("");function Pp(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function J0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const c1=J0,Z0=new ba("auth","Firebase",J0());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ku=new Np("@firebase/auth");function d1(t,...e){ku.logLevel<=le.WARN&&ku.warn(`Auth (${$i}): ${t}`,...e)}function Wl(t,...e){ku.logLevel<=le.ERROR&&ku.error(`Auth (${$i}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xn(t,...e){throw Dp(t,...e)}function kn(t,...e){return Dp(t,...e)}function ex(t,e,n){const r=Object.assign(Object.assign({},c1()),{[e]:n});return new ba("auth","Firebase",r).create(e,{appName:t.name})}function Yn(t){return ex(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Dp(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Z0.create(t,...e)}function ee(t,e,...n){if(!t)throw Dp(e,...n)}function Gn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Wl(e),new Error(e)}function rr(t,e){t||Gn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nf(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function h1(){return Yy()==="http:"||Yy()==="https:"}function Yy(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f1(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(h1()||qR()||"connection"in navigator)?navigator.onLine:!0}function p1(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e,n){this.shortDelay=e,this.longDelay=n,rr(n>e,"Short delay should be less than long delay!"),this.isMobile=$R()||HR()}get(){return f1()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jp(t,e){rr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tx{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Gn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Gn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Gn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m1={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g1=new Pa(3e4,6e4);function ts(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function cr(t,e,n,r,s={}){return nx(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=ka(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},i);return BR()||(c.referrerPolicy="no-referrer"),tx.fetch()(rx(t,t.config.apiHost,n,a),c)})}async function nx(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},m1),e);try{const s=new v1(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Il(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Il(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Il(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Il(t,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw ex(t,h,c);xn(t,h)}}catch(s){if(s instanceof Ln)throw s;xn(t,"network-request-failed",{message:String(s)})}}async function Da(t,e,n,r,s={}){const i=await cr(t,e,n,r,s);return"mfaPendingCredential"in i&&xn(t,"multi-factor-auth-required",{_serverResponse:i}),i}function rx(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?jp(t.config,s):`${t.config.apiScheme}://${s}`}function y1(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class v1{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(kn(this.auth,"network-request-failed")),g1.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Il(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=kn(t,e,r);return s.customData._tokenResponse=n,s}function Xy(t){return t!==void 0&&t.enterprise!==void 0}class _1{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return y1(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function w1(t,e){return cr(t,"GET","/v2/recaptchaConfig",ts(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x1(t,e){return cr(t,"POST","/v1/accounts:delete",e)}async function sx(t,e){return cr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function E1(t,e=!1){const n=De(t),r=await n.getIdToken(e),s=Mp(r);ee(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Bo(Vd(s.auth_time)),issuedAtTime:Bo(Vd(s.iat)),expirationTime:Bo(Vd(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Vd(t){return Number(t)*1e3}function Mp(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Wl("JWT malformed, contained fewer than 3 sections"),null;try{const s=z0(n);return s?JSON.parse(s):(Wl("Failed to decode base64 JWT payload"),null)}catch(s){return Wl("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Jy(t){const e=Mp(t);return ee(e,"internal-error"),ee(typeof e.exp<"u","internal-error"),ee(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ri(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ln&&S1(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function S1({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Bo(this.lastLoginAt),this.creationTime=Bo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pu(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Ri(t,sx(n,{idToken:r}));ee(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?ix(i.providerUserInfo):[],a=T1(t.providerData,o),l=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),h=l?c:!1,p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new rf(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,p)}async function I1(t){const e=De(t);await Pu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function T1(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function ix(t){return t.map(e=>{var{providerId:n}=e,r=Pp(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R1(t,e){const n=await nx(t,{},async()=>{const r=ka({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=rx(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",tx.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function A1(t,e){return cr(t,"POST","/v2/accounts:revokeToken",ts(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ee(e.idToken,"internal-error"),ee(typeof e.idToken<"u","internal-error"),ee(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Jy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ee(e.length!==0,"internal-error");const n=Jy(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ee(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await R1(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new hi;return r&&(ee(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ee(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ee(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new hi,this.toJSON())}_performRefresh(){return Gn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yr(t,e){ee(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Wn{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Pp(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new C1(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new rf(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Ri(this,this.stsTokenManager.getToken(this.auth,e));return ee(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return E1(this,e)}reload(){return I1(this)}_assign(e){this!==e&&(ee(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Wn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ee(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Pu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Rn(this.auth.app))return Promise.reject(Yn(this.auth));const e=await this.getIdToken();return await Ri(this,x1(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,a,l,c,h;const p=(r=n.displayName)!==null&&r!==void 0?r:void 0,m=(s=n.email)!==null&&s!==void 0?s:void 0,g=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,v=(o=n.photoURL)!==null&&o!==void 0?o:void 0,E=(a=n.tenantId)!==null&&a!==void 0?a:void 0,N=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,S=(c=n.createdAt)!==null&&c!==void 0?c:void 0,_=(h=n.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:x,emailVerified:D,isAnonymous:O,providerData:j,stsTokenManager:R}=n;ee(x&&R,e,"internal-error");const w=hi.fromJSON(this.name,R);ee(typeof x=="string",e,"internal-error"),yr(p,e.name),yr(m,e.name),ee(typeof D=="boolean",e,"internal-error"),ee(typeof O=="boolean",e,"internal-error"),yr(g,e.name),yr(v,e.name),yr(E,e.name),yr(N,e.name),yr(S,e.name),yr(_,e.name);const C=new Wn({uid:x,auth:e,email:m,emailVerified:D,displayName:p,isAnonymous:O,photoURL:v,phoneNumber:g,tenantId:E,stsTokenManager:w,createdAt:S,lastLoginAt:_});return j&&Array.isArray(j)&&(C.providerData=j.map(T=>Object.assign({},T))),N&&(C._redirectEventId=N),C}static async _fromIdTokenResponse(e,n,r=!1){const s=new hi;s.updateFromServerResponse(n);const i=new Wn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Pu(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ee(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?ix(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new hi;a.updateFromIdToken(r);const l=new Wn({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new rf(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zy=new Map;function Kn(t){rr(t instanceof Function,"Expected a class definition");let e=Zy.get(t);return e?(rr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Zy.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ox{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}ox.type="NONE";const ev=ox;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kl(t,e,n){return`firebase:${t}:${e}:${n}`}class fi{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Kl(this.userKey,s.apiKey,i),this.fullPersistenceKey=Kl("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Wn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new fi(Kn(ev),e,r);const s=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||Kn(ev);const o=Kl(r,e.config.apiKey,e.name);let a=null;for(const c of n)try{const h=await c._get(o);if(h){const p=Wn._fromJSON(e,h);c!==i&&(a=p),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new fi(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new fi(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tv(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(cx(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ax(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(hx(e))return"Blackberry";if(fx(e))return"Webos";if(lx(e))return"Safari";if((e.includes("chrome/")||ux(e))&&!e.includes("edge/"))return"Chrome";if(dx(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function ax(t=Tt()){return/firefox\//i.test(t)}function lx(t=Tt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ux(t=Tt()){return/crios\//i.test(t)}function cx(t=Tt()){return/iemobile/i.test(t)}function dx(t=Tt()){return/android/i.test(t)}function hx(t=Tt()){return/blackberry/i.test(t)}function fx(t=Tt()){return/webos/i.test(t)}function Vp(t=Tt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function N1(t=Tt()){var e;return Vp(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function b1(){return GR()&&document.documentMode===10}function px(t=Tt()){return Vp(t)||dx(t)||fx(t)||hx(t)||/windows phone/i.test(t)||cx(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mx(t,e=[]){let n;switch(t){case"Browser":n=tv(Tt());break;case"Worker":n=`${tv(Tt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${$i}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P1(t,e={}){return cr(t,"GET","/v2/passwordPolicy",ts(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1=6;class j1{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:D1,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new nv(this),this.idTokenSubscription=new nv(this),this.beforeStateQueue=new k1(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Z0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Kn(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await fi.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await sx(this,{idToken:e}),r=await Wn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Rn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ee(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Pu(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=p1()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Rn(this.app))return Promise.reject(Yn(this));const n=e?De(e):null;return n&&ee(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ee(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Rn(this.app)?Promise.reject(Yn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Rn(this.app)?Promise.reject(Yn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Kn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await P1(this),n=new j1(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ba("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await A1(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Kn(e)||this._popupRedirectResolver;ee(n,this,"argument-error"),this.redirectPersistenceManager=await fi.create(this,[Kn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ee(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ee(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=mx(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&d1(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Ps(t){return De(t)}class nv{constructor(e){this.auth=e,this.observer=null,this.addObserver=eA(n=>this.observer=n)}get next(){return ee(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function V1(t){pc=t}function gx(t){return pc.loadJS(t)}function O1(){return pc.recaptchaEnterpriseScript}function L1(){return pc.gapiScript}function F1(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const U1="recaptcha-enterprise",$1="NO_RECAPTCHA";class z1{constructor(e){this.type=U1,this.auth=Ps(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{w1(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new _1(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;Xy(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o($1)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&Xy(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=O1();l.length!==0&&(l+=a),gx(l).then(()=>{s(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function rv(t,e,n,r=!1){const s=new z1(t);let i;try{i=await s.verify(n)}catch{i=await s.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function sf(t,e,n,r){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await rv(t,e,n,n==="getOobCode");return r(t,i)}else return r(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await rv(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B1(t,e){const n=fc(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Nu(i,e??{}))return s;xn(s,"already-initialized")}return n.initialize({options:e})}function q1(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Kn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function H1(t,e,n){const r=Ps(t);ee(r._canInitEmulator,r,"emulator-config-failed"),ee(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=yx(e),{host:o,port:a}=G1(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),W1()}function yx(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function G1(t){const e=yx(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:sv(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:sv(o)}}}function sv(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function W1(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Op{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Gn("not implemented")}_getIdTokenResponse(e){return Gn("not implemented")}_linkToIdToken(e,n){return Gn("not implemented")}_getReauthenticationResolver(e){return Gn("not implemented")}}async function K1(t,e){return cr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q1(t,e){return Da(t,"POST","/v1/accounts:signInWithPassword",ts(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y1(t,e){return Da(t,"POST","/v1/accounts:signInWithEmailLink",ts(t,e))}async function X1(t,e){return Da(t,"POST","/v1/accounts:signInWithEmailLink",ts(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma extends Op{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new ma(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new ma(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return sf(e,n,"signInWithPassword",Q1);case"emailLink":return Y1(e,{email:this._email,oobCode:this._password});default:xn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return sf(e,r,"signUpPassword",K1);case"emailLink":return X1(e,{idToken:n,email:this._email,oobCode:this._password});default:xn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pi(t,e){return Da(t,"POST","/v1/accounts:signInWithIdp",ts(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J1="http://localhost";class Cs extends Op{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Cs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):xn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Pp(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Cs(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return pi(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,pi(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,pi(e,n)}buildRequest(){const e={requestUri:J1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ka(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z1(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function eN(t){const e=Ro(Ao(t)).link,n=e?Ro(Ao(e)).deep_link_id:null,r=Ro(Ao(t)).deep_link_id;return(r?Ro(Ao(r)).link:null)||r||n||e||t}class Lp{constructor(e){var n,r,s,i,o,a;const l=Ro(Ao(e)),c=(n=l.apiKey)!==null&&n!==void 0?n:null,h=(r=l.oobCode)!==null&&r!==void 0?r:null,p=Z1((s=l.mode)!==null&&s!==void 0?s:null);ee(c&&h&&p,"argument-error"),this.apiKey=c,this.operation=p,this.code=h,this.continueUrl=(i=l.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=eN(e);try{return new Lp(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(){this.providerId=zi.PROVIDER_ID}static credential(e,n){return ma._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Lp.parseLink(n);return ee(r,"argument-error"),ma._fromEmailAndCode(e,r.code,r.tenantId)}}zi.PROVIDER_ID="password";zi.EMAIL_PASSWORD_SIGN_IN_METHOD="password";zi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja extends vx{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr extends ja{constructor(){super("facebook.com")}static credential(e){return Cs._fromParams({providerId:Sr.PROVIDER_ID,signInMethod:Sr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Sr.credentialFromTaggedObject(e)}static credentialFromError(e){return Sr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Sr.credential(e.oauthAccessToken)}catch{return null}}}Sr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Sr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr extends ja{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Cs._fromParams({providerId:Cr.PROVIDER_ID,signInMethod:Cr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Cr.credentialFromTaggedObject(e)}static credentialFromError(e){return Cr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Cr.credential(n,r)}catch{return null}}}Cr.GOOGLE_SIGN_IN_METHOD="google.com";Cr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir extends ja{constructor(){super("github.com")}static credential(e){return Cs._fromParams({providerId:Ir.PROVIDER_ID,signInMethod:Ir.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ir.credentialFromTaggedObject(e)}static credentialFromError(e){return Ir.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ir.credential(e.oauthAccessToken)}catch{return null}}}Ir.GITHUB_SIGN_IN_METHOD="github.com";Ir.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr extends ja{constructor(){super("twitter.com")}static credential(e,n){return Cs._fromParams({providerId:Tr.PROVIDER_ID,signInMethod:Tr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Tr.credentialFromTaggedObject(e)}static credentialFromError(e){return Tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Tr.credential(n,r)}catch{return null}}}Tr.TWITTER_SIGN_IN_METHOD="twitter.com";Tr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tN(t,e){return Da(t,"POST","/v1/accounts:signUp",ts(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Wn._fromIdTokenResponse(e,r,s),o=iv(r);return new Is({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=iv(r);return new Is({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function iv(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du extends Ln{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Du.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Du(e,n,r,s)}}function _x(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Du._fromErrorAndOperation(t,i,e,r):i})}async function nN(t,e,n=!1){const r=await Ri(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Is._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rN(t,e,n=!1){const{auth:r}=t;if(Rn(r.app))return Promise.reject(Yn(r));const s="reauthenticate";try{const i=await Ri(t,_x(r,s,e,t),n);ee(i.idToken,r,"internal-error");const o=Mp(i.idToken);ee(o,r,"internal-error");const{sub:a}=o;return ee(t.uid===a,r,"user-mismatch"),Is._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&xn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wx(t,e,n=!1){if(Rn(t.app))return Promise.reject(Yn(t));const r="signIn",s=await _x(t,r,e),i=await Is._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function sN(t,e){return wx(Ps(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xx(t){const e=Ps(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function iN(t,e,n){if(Rn(t.app))return Promise.reject(Yn(t));const r=Ps(t),o=await sf(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",tN).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&xx(t),l}),a=await Is._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function oN(t,e,n){return Rn(t.app)?Promise.reject(Yn(t)):sN(De(t),zi.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&xx(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aN(t,e){return cr(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lN(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=De(t),i={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await Ri(r,aN(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function uN(t,e,n,r){return De(t).onIdTokenChanged(e,n,r)}function cN(t,e,n){return De(t).beforeAuthStateChanged(e,n)}function dN(t,e,n,r){return De(t).onAuthStateChanged(e,n,r)}function hN(t){return De(t).signOut()}const ju="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(ju,"1"),this.storage.removeItem(ju),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fN=1e3,pN=10;class Sx extends Ex{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=px(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);b1()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,pN):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},fN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Sx.type="LOCAL";const mN=Sx;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx extends Ex{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Cx.type="SESSION";const Ix=Cx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gN(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new mc(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async c=>c(n.origin,i)),l=await gN(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}mc.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fp(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=Fp("",20);s.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(p){const m=p;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(m.data.response);break;default:clearTimeout(h),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pn(){return window}function vN(t){Pn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tx(){return typeof Pn().WorkerGlobalScope<"u"&&typeof Pn().importScripts=="function"}async function _N(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function wN(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function xN(){return Tx()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rx="firebaseLocalStorageDb",EN=1,Mu="firebaseLocalStorage",Ax="fbase_key";class Ma{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function gc(t,e){return t.transaction([Mu],e?"readwrite":"readonly").objectStore(Mu)}function SN(){const t=indexedDB.deleteDatabase(Rx);return new Ma(t).toPromise()}function of(){const t=indexedDB.open(Rx,EN);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Mu,{keyPath:Ax})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Mu)?e(r):(r.close(),await SN(),e(await of()))})})}async function ov(t,e,n){const r=gc(t,!0).put({[Ax]:e,value:n});return new Ma(r).toPromise()}async function CN(t,e){const n=gc(t,!1).get(e),r=await new Ma(n).toPromise();return r===void 0?null:r.value}function av(t,e){const n=gc(t,!0).delete(e);return new Ma(n).toPromise()}const IN=800,TN=3;class Nx{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await of(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>TN)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Tx()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=mc._getInstance(xN()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await _N(),!this.activeServiceWorker)return;this.sender=new yN(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||wN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await of();return await ov(e,ju,"1"),await av(e,ju),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>ov(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>CN(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>av(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=gc(s,!1).getAll();return new Ma(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),IN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Nx.type="LOCAL";const RN=Nx;new Pa(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AN(t,e){return e?Kn(e):(ee(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up extends Op{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return pi(e,this._buildIdpRequest())}_linkToIdToken(e,n){return pi(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return pi(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function NN(t){return wx(t.auth,new Up(t),t.bypassAuthState)}function bN(t){const{auth:e,user:n}=t;return ee(n,e,"internal-error"),rN(n,new Up(t),t.bypassAuthState)}async function kN(t){const{auth:e,user:n}=t;return ee(n,e,"internal-error"),nN(n,new Up(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return NN;case"linkViaPopup":case"linkViaRedirect":return kN;case"reauthViaPopup":case"reauthViaRedirect":return bN;default:xn(this.auth,"internal-error")}}resolve(e){rr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){rr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PN=new Pa(2e3,1e4);class si extends bx{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,si.currentPopupAction&&si.currentPopupAction.cancel(),si.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ee(e,this.auth,"internal-error"),e}async onExecution(){rr(this.filter.length===1,"Popup operations only handle one event");const e=Fp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(kn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(kn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,si.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(kn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,PN.get())};e()}}si.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DN="pendingRedirect",Ql=new Map;class jN extends bx{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ql.get(this.auth._key());if(!e){try{const r=await MN(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ql.set(this.auth._key(),e)}return this.bypassAuthState||Ql.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function MN(t,e){const n=LN(e),r=ON(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function VN(t,e){Ql.set(t._key(),e)}function ON(t){return Kn(t._redirectPersistence)}function LN(t){return Kl(DN,t.config.apiKey,t.name)}async function FN(t,e,n=!1){if(Rn(t.app))return Promise.reject(Yn(t));const r=Ps(t),s=AN(r,e),o=await new jN(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UN=10*60*1e3;class $N{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!zN(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!kx(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(kn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=UN&&this.cachedEventUids.clear(),this.cachedEventUids.has(lv(e))}saveEventToCache(e){this.cachedEventUids.add(lv(e)),this.lastProcessedEventTime=Date.now()}}function lv(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function kx({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function zN(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return kx(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BN(t,e={}){return cr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,HN=/^https?/;async function GN(t){if(t.config.emulator)return;const{authorizedDomains:e}=await BN(t);for(const n of e)try{if(WN(n))return}catch{}xn(t,"unauthorized-domain")}function WN(t){const e=nf(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!HN.test(n))return!1;if(qN.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KN=new Pa(3e4,6e4);function uv(){const t=Pn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function QN(t){return new Promise((e,n)=>{var r,s,i;function o(){uv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{uv(),n(kn(t,"network-request-failed"))},timeout:KN.get()})}if(!((s=(r=Pn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Pn().gapi)===null||i===void 0)&&i.load)o();else{const a=F1("iframefcb");return Pn()[a]=()=>{gapi.load?o():n(kn(t,"network-request-failed"))},gx(`${L1()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Yl=null,e})}let Yl=null;function YN(t){return Yl=Yl||QN(t),Yl}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XN=new Pa(5e3,15e3),JN="__/auth/iframe",ZN="emulator/auth/iframe",eb={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},tb=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function nb(t){const e=t.config;ee(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?jp(e,ZN):`https://${t.config.authDomain}/${JN}`,r={apiKey:e.apiKey,appName:t.name,v:$i},s=tb.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${ka(r).slice(1)}`}async function rb(t){const e=await YN(t),n=Pn().gapi;return ee(n,t,"internal-error"),e.open({where:document.body,url:nb(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:eb,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=kn(t,"network-request-failed"),a=Pn().setTimeout(()=>{i(o)},XN.get());function l(){Pn().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sb={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ib=500,ob=600,ab="_blank",lb="http://localhost";class cv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function ub(t,e,n,r=ib,s=ob){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},sb),{width:r.toString(),height:s.toString(),top:i,left:o}),c=Tt().toLowerCase();n&&(a=ux(c)?ab:n),ax(c)&&(e=e||lb,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[g,v])=>`${m}${g}=${v},`,"");if(N1(c)&&a!=="_self")return cb(e||"",a),new cv(null);const p=window.open(e||"",a,h);ee(p,t,"popup-blocked");try{p.focus()}catch{}return new cv(p)}function cb(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const db="__/auth/handler",hb="emulator/auth/handler",fb=encodeURIComponent("fac");async function dv(t,e,n,r,s,i){ee(t.config.authDomain,t,"auth-domain-config-required"),ee(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:$i,eventId:s};if(e instanceof vx){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",ZR(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))o[h]=p}if(e instanceof ja){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await t._getAppCheckToken(),c=l?`#${fb}=${encodeURIComponent(l)}`:"";return`${pb(t)}?${ka(a).slice(1)}${c}`}function pb({config:t}){return t.emulator?jp(t,hb):`https://${t.authDomain}/${db}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Od="webStorageSupport";class mb{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ix,this._completeRedirectFn=FN,this._overrideRedirectResult=VN}async _openPopup(e,n,r,s){var i;rr((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await dv(e,n,r,nf(),s);return ub(e,o,Fp())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await dv(e,n,r,nf(),s);return vN(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(rr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await rb(e),r=new $N(e);return n.register("authEvent",s=>(ee(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Od,{type:Od},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Od];o!==void 0&&n(!!o),xn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=GN(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return px()||lx()||Vp()}}const gb=mb;var hv="@firebase/auth",fv="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yb{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ee(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vb(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function _b(t){Ss(new Wr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ee(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:mx(t)},c=new M1(r,s,i,l);return q1(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ss(new Wr("auth-internal",e=>{const n=Ps(e.getProvider("auth").getImmediate());return(r=>new yb(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),bn(hv,fv,vb(t)),bn(hv,fv,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wb=5*60,xb=G0("authIdTokenMaxAge")||wb;let pv=null;const Eb=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>xb)return;const s=n==null?void 0:n.token;pv!==s&&(pv=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Sb(t=kp()){const e=fc(t,"auth");if(e.isInitialized())return e.getImmediate();const n=B1(t,{popupRedirectResolver:gb,persistence:[RN,mN,Ix]}),r=G0("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=Eb(i.toString());cN(n,o,()=>o(n.currentUser)),uN(n,a=>o(a))}}const s=B0("auth");return s&&H1(n,`http://${s}`),n}function Cb(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}V1({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=kn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",Cb().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});_b("Browser");var Ib="firebase",Tb="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bn(Ib,Tb,"app");var mv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ys,Px;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(R,w){function C(){}C.prototype=w.prototype,R.D=w.prototype,R.prototype=new C,R.prototype.constructor=R,R.C=function(T,b,P){for(var A=Array(arguments.length-2),X=2;X<arguments.length;X++)A[X-2]=arguments[X];return w.prototype[b].apply(T,A)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(R,w,C){C||(C=0);var T=Array(16);if(typeof w=="string")for(var b=0;16>b;++b)T[b]=w.charCodeAt(C++)|w.charCodeAt(C++)<<8|w.charCodeAt(C++)<<16|w.charCodeAt(C++)<<24;else for(b=0;16>b;++b)T[b]=w[C++]|w[C++]<<8|w[C++]<<16|w[C++]<<24;w=R.g[0],C=R.g[1],b=R.g[2];var P=R.g[3],A=w+(P^C&(b^P))+T[0]+3614090360&4294967295;w=C+(A<<7&4294967295|A>>>25),A=P+(b^w&(C^b))+T[1]+3905402710&4294967295,P=w+(A<<12&4294967295|A>>>20),A=b+(C^P&(w^C))+T[2]+606105819&4294967295,b=P+(A<<17&4294967295|A>>>15),A=C+(w^b&(P^w))+T[3]+3250441966&4294967295,C=b+(A<<22&4294967295|A>>>10),A=w+(P^C&(b^P))+T[4]+4118548399&4294967295,w=C+(A<<7&4294967295|A>>>25),A=P+(b^w&(C^b))+T[5]+1200080426&4294967295,P=w+(A<<12&4294967295|A>>>20),A=b+(C^P&(w^C))+T[6]+2821735955&4294967295,b=P+(A<<17&4294967295|A>>>15),A=C+(w^b&(P^w))+T[7]+4249261313&4294967295,C=b+(A<<22&4294967295|A>>>10),A=w+(P^C&(b^P))+T[8]+1770035416&4294967295,w=C+(A<<7&4294967295|A>>>25),A=P+(b^w&(C^b))+T[9]+2336552879&4294967295,P=w+(A<<12&4294967295|A>>>20),A=b+(C^P&(w^C))+T[10]+4294925233&4294967295,b=P+(A<<17&4294967295|A>>>15),A=C+(w^b&(P^w))+T[11]+2304563134&4294967295,C=b+(A<<22&4294967295|A>>>10),A=w+(P^C&(b^P))+T[12]+1804603682&4294967295,w=C+(A<<7&4294967295|A>>>25),A=P+(b^w&(C^b))+T[13]+4254626195&4294967295,P=w+(A<<12&4294967295|A>>>20),A=b+(C^P&(w^C))+T[14]+2792965006&4294967295,b=P+(A<<17&4294967295|A>>>15),A=C+(w^b&(P^w))+T[15]+1236535329&4294967295,C=b+(A<<22&4294967295|A>>>10),A=w+(b^P&(C^b))+T[1]+4129170786&4294967295,w=C+(A<<5&4294967295|A>>>27),A=P+(C^b&(w^C))+T[6]+3225465664&4294967295,P=w+(A<<9&4294967295|A>>>23),A=b+(w^C&(P^w))+T[11]+643717713&4294967295,b=P+(A<<14&4294967295|A>>>18),A=C+(P^w&(b^P))+T[0]+3921069994&4294967295,C=b+(A<<20&4294967295|A>>>12),A=w+(b^P&(C^b))+T[5]+3593408605&4294967295,w=C+(A<<5&4294967295|A>>>27),A=P+(C^b&(w^C))+T[10]+38016083&4294967295,P=w+(A<<9&4294967295|A>>>23),A=b+(w^C&(P^w))+T[15]+3634488961&4294967295,b=P+(A<<14&4294967295|A>>>18),A=C+(P^w&(b^P))+T[4]+3889429448&4294967295,C=b+(A<<20&4294967295|A>>>12),A=w+(b^P&(C^b))+T[9]+568446438&4294967295,w=C+(A<<5&4294967295|A>>>27),A=P+(C^b&(w^C))+T[14]+3275163606&4294967295,P=w+(A<<9&4294967295|A>>>23),A=b+(w^C&(P^w))+T[3]+4107603335&4294967295,b=P+(A<<14&4294967295|A>>>18),A=C+(P^w&(b^P))+T[8]+1163531501&4294967295,C=b+(A<<20&4294967295|A>>>12),A=w+(b^P&(C^b))+T[13]+2850285829&4294967295,w=C+(A<<5&4294967295|A>>>27),A=P+(C^b&(w^C))+T[2]+4243563512&4294967295,P=w+(A<<9&4294967295|A>>>23),A=b+(w^C&(P^w))+T[7]+1735328473&4294967295,b=P+(A<<14&4294967295|A>>>18),A=C+(P^w&(b^P))+T[12]+2368359562&4294967295,C=b+(A<<20&4294967295|A>>>12),A=w+(C^b^P)+T[5]+4294588738&4294967295,w=C+(A<<4&4294967295|A>>>28),A=P+(w^C^b)+T[8]+2272392833&4294967295,P=w+(A<<11&4294967295|A>>>21),A=b+(P^w^C)+T[11]+1839030562&4294967295,b=P+(A<<16&4294967295|A>>>16),A=C+(b^P^w)+T[14]+4259657740&4294967295,C=b+(A<<23&4294967295|A>>>9),A=w+(C^b^P)+T[1]+2763975236&4294967295,w=C+(A<<4&4294967295|A>>>28),A=P+(w^C^b)+T[4]+1272893353&4294967295,P=w+(A<<11&4294967295|A>>>21),A=b+(P^w^C)+T[7]+4139469664&4294967295,b=P+(A<<16&4294967295|A>>>16),A=C+(b^P^w)+T[10]+3200236656&4294967295,C=b+(A<<23&4294967295|A>>>9),A=w+(C^b^P)+T[13]+681279174&4294967295,w=C+(A<<4&4294967295|A>>>28),A=P+(w^C^b)+T[0]+3936430074&4294967295,P=w+(A<<11&4294967295|A>>>21),A=b+(P^w^C)+T[3]+3572445317&4294967295,b=P+(A<<16&4294967295|A>>>16),A=C+(b^P^w)+T[6]+76029189&4294967295,C=b+(A<<23&4294967295|A>>>9),A=w+(C^b^P)+T[9]+3654602809&4294967295,w=C+(A<<4&4294967295|A>>>28),A=P+(w^C^b)+T[12]+3873151461&4294967295,P=w+(A<<11&4294967295|A>>>21),A=b+(P^w^C)+T[15]+530742520&4294967295,b=P+(A<<16&4294967295|A>>>16),A=C+(b^P^w)+T[2]+3299628645&4294967295,C=b+(A<<23&4294967295|A>>>9),A=w+(b^(C|~P))+T[0]+4096336452&4294967295,w=C+(A<<6&4294967295|A>>>26),A=P+(C^(w|~b))+T[7]+1126891415&4294967295,P=w+(A<<10&4294967295|A>>>22),A=b+(w^(P|~C))+T[14]+2878612391&4294967295,b=P+(A<<15&4294967295|A>>>17),A=C+(P^(b|~w))+T[5]+4237533241&4294967295,C=b+(A<<21&4294967295|A>>>11),A=w+(b^(C|~P))+T[12]+1700485571&4294967295,w=C+(A<<6&4294967295|A>>>26),A=P+(C^(w|~b))+T[3]+2399980690&4294967295,P=w+(A<<10&4294967295|A>>>22),A=b+(w^(P|~C))+T[10]+4293915773&4294967295,b=P+(A<<15&4294967295|A>>>17),A=C+(P^(b|~w))+T[1]+2240044497&4294967295,C=b+(A<<21&4294967295|A>>>11),A=w+(b^(C|~P))+T[8]+1873313359&4294967295,w=C+(A<<6&4294967295|A>>>26),A=P+(C^(w|~b))+T[15]+4264355552&4294967295,P=w+(A<<10&4294967295|A>>>22),A=b+(w^(P|~C))+T[6]+2734768916&4294967295,b=P+(A<<15&4294967295|A>>>17),A=C+(P^(b|~w))+T[13]+1309151649&4294967295,C=b+(A<<21&4294967295|A>>>11),A=w+(b^(C|~P))+T[4]+4149444226&4294967295,w=C+(A<<6&4294967295|A>>>26),A=P+(C^(w|~b))+T[11]+3174756917&4294967295,P=w+(A<<10&4294967295|A>>>22),A=b+(w^(P|~C))+T[2]+718787259&4294967295,b=P+(A<<15&4294967295|A>>>17),A=C+(P^(b|~w))+T[9]+3951481745&4294967295,R.g[0]=R.g[0]+w&4294967295,R.g[1]=R.g[1]+(b+(A<<21&4294967295|A>>>11))&4294967295,R.g[2]=R.g[2]+b&4294967295,R.g[3]=R.g[3]+P&4294967295}r.prototype.u=function(R,w){w===void 0&&(w=R.length);for(var C=w-this.blockSize,T=this.B,b=this.h,P=0;P<w;){if(b==0)for(;P<=C;)s(this,R,P),P+=this.blockSize;if(typeof R=="string"){for(;P<w;)if(T[b++]=R.charCodeAt(P++),b==this.blockSize){s(this,T),b=0;break}}else for(;P<w;)if(T[b++]=R[P++],b==this.blockSize){s(this,T),b=0;break}}this.h=b,this.o+=w},r.prototype.v=function(){var R=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);R[0]=128;for(var w=1;w<R.length-8;++w)R[w]=0;var C=8*this.o;for(w=R.length-8;w<R.length;++w)R[w]=C&255,C/=256;for(this.u(R),R=Array(16),w=C=0;4>w;++w)for(var T=0;32>T;T+=8)R[C++]=this.g[w]>>>T&255;return R};function i(R,w){var C=a;return Object.prototype.hasOwnProperty.call(C,R)?C[R]:C[R]=w(R)}function o(R,w){this.h=w;for(var C=[],T=!0,b=R.length-1;0<=b;b--){var P=R[b]|0;T&&P==w||(C[b]=P,T=!1)}this.g=C}var a={};function l(R){return-128<=R&&128>R?i(R,function(w){return new o([w|0],0>w?-1:0)}):new o([R|0],0>R?-1:0)}function c(R){if(isNaN(R)||!isFinite(R))return p;if(0>R)return N(c(-R));for(var w=[],C=1,T=0;R>=C;T++)w[T]=R/C|0,C*=4294967296;return new o(w,0)}function h(R,w){if(R.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(R.charAt(0)=="-")return N(h(R.substring(1),w));if(0<=R.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=c(Math.pow(w,8)),T=p,b=0;b<R.length;b+=8){var P=Math.min(8,R.length-b),A=parseInt(R.substring(b,b+P),w);8>P?(P=c(Math.pow(w,P)),T=T.j(P).add(c(A))):(T=T.j(C),T=T.add(c(A)))}return T}var p=l(0),m=l(1),g=l(16777216);t=o.prototype,t.m=function(){if(E(this))return-N(this).m();for(var R=0,w=1,C=0;C<this.g.length;C++){var T=this.i(C);R+=(0<=T?T:4294967296+T)*w,w*=4294967296}return R},t.toString=function(R){if(R=R||10,2>R||36<R)throw Error("radix out of range: "+R);if(v(this))return"0";if(E(this))return"-"+N(this).toString(R);for(var w=c(Math.pow(R,6)),C=this,T="";;){var b=D(C,w).g;C=S(C,b.j(w));var P=((0<C.g.length?C.g[0]:C.h)>>>0).toString(R);if(C=b,v(C))return P+T;for(;6>P.length;)P="0"+P;T=P+T}},t.i=function(R){return 0>R?0:R<this.g.length?this.g[R]:this.h};function v(R){if(R.h!=0)return!1;for(var w=0;w<R.g.length;w++)if(R.g[w]!=0)return!1;return!0}function E(R){return R.h==-1}t.l=function(R){return R=S(this,R),E(R)?-1:v(R)?0:1};function N(R){for(var w=R.g.length,C=[],T=0;T<w;T++)C[T]=~R.g[T];return new o(C,~R.h).add(m)}t.abs=function(){return E(this)?N(this):this},t.add=function(R){for(var w=Math.max(this.g.length,R.g.length),C=[],T=0,b=0;b<=w;b++){var P=T+(this.i(b)&65535)+(R.i(b)&65535),A=(P>>>16)+(this.i(b)>>>16)+(R.i(b)>>>16);T=A>>>16,P&=65535,A&=65535,C[b]=A<<16|P}return new o(C,C[C.length-1]&-2147483648?-1:0)};function S(R,w){return R.add(N(w))}t.j=function(R){if(v(this)||v(R))return p;if(E(this))return E(R)?N(this).j(N(R)):N(N(this).j(R));if(E(R))return N(this.j(N(R)));if(0>this.l(g)&&0>R.l(g))return c(this.m()*R.m());for(var w=this.g.length+R.g.length,C=[],T=0;T<2*w;T++)C[T]=0;for(T=0;T<this.g.length;T++)for(var b=0;b<R.g.length;b++){var P=this.i(T)>>>16,A=this.i(T)&65535,X=R.i(b)>>>16,ge=R.i(b)&65535;C[2*T+2*b]+=A*ge,_(C,2*T+2*b),C[2*T+2*b+1]+=P*ge,_(C,2*T+2*b+1),C[2*T+2*b+1]+=A*X,_(C,2*T+2*b+1),C[2*T+2*b+2]+=P*X,_(C,2*T+2*b+2)}for(T=0;T<w;T++)C[T]=C[2*T+1]<<16|C[2*T];for(T=w;T<2*w;T++)C[T]=0;return new o(C,0)};function _(R,w){for(;(R[w]&65535)!=R[w];)R[w+1]+=R[w]>>>16,R[w]&=65535,w++}function x(R,w){this.g=R,this.h=w}function D(R,w){if(v(w))throw Error("division by zero");if(v(R))return new x(p,p);if(E(R))return w=D(N(R),w),new x(N(w.g),N(w.h));if(E(w))return w=D(R,N(w)),new x(N(w.g),w.h);if(30<R.g.length){if(E(R)||E(w))throw Error("slowDivide_ only works with positive integers.");for(var C=m,T=w;0>=T.l(R);)C=O(C),T=O(T);var b=j(C,1),P=j(T,1);for(T=j(T,2),C=j(C,2);!v(T);){var A=P.add(T);0>=A.l(R)&&(b=b.add(C),P=A),T=j(T,1),C=j(C,1)}return w=S(R,b.j(w)),new x(b,w)}for(b=p;0<=R.l(w);){for(C=Math.max(1,Math.floor(R.m()/w.m())),T=Math.ceil(Math.log(C)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),P=c(C),A=P.j(w);E(A)||0<A.l(R);)C-=T,P=c(C),A=P.j(w);v(P)&&(P=m),b=b.add(P),R=S(R,A)}return new x(b,R)}t.A=function(R){return D(this,R).h},t.and=function(R){for(var w=Math.max(this.g.length,R.g.length),C=[],T=0;T<w;T++)C[T]=this.i(T)&R.i(T);return new o(C,this.h&R.h)},t.or=function(R){for(var w=Math.max(this.g.length,R.g.length),C=[],T=0;T<w;T++)C[T]=this.i(T)|R.i(T);return new o(C,this.h|R.h)},t.xor=function(R){for(var w=Math.max(this.g.length,R.g.length),C=[],T=0;T<w;T++)C[T]=this.i(T)^R.i(T);return new o(C,this.h^R.h)};function O(R){for(var w=R.g.length+1,C=[],T=0;T<w;T++)C[T]=R.i(T)<<1|R.i(T-1)>>>31;return new o(C,R.h)}function j(R,w){var C=w>>5;w%=32;for(var T=R.g.length-C,b=[],P=0;P<T;P++)b[P]=0<w?R.i(P+C)>>>w|R.i(P+C+1)<<32-w:R.i(P+C);return new o(b,R.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Px=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=h,ys=o}).apply(typeof mv<"u"?mv:typeof self<"u"?self:typeof window<"u"?window:{});var Tl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Dx,No,jx,Xl,af,Mx,Vx,Ox;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,f,y){return u==Array.prototype||u==Object.prototype||(u[f]=y.value),u};function n(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Tl=="object"&&Tl];for(var f=0;f<u.length;++f){var y=u[f];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=n(this);function s(u,f){if(f)e:{var y=r;u=u.split(".");for(var I=0;I<u.length-1;I++){var M=u[I];if(!(M in y))break e;y=y[M]}u=u[u.length-1],I=y[u],f=f(I),f!=I&&f!=null&&e(y,u,{configurable:!0,writable:!0,value:f})}}function i(u,f){u instanceof String&&(u+="");var y=0,I=!1,M={next:function(){if(!I&&y<u.length){var L=y++;return{value:f(L,u[L]),done:!1}}return I=!0,{done:!0,value:void 0}}};return M[Symbol.iterator]=function(){return M},M}s("Array.prototype.values",function(u){return u||function(){return i(this,function(f,y){return y})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(u){var f=typeof u;return f=f!="object"?f:u?Array.isArray(u)?"array":f:"null",f=="array"||f=="object"&&typeof u.length=="number"}function c(u){var f=typeof u;return f=="object"&&u!=null||f=="function"}function h(u,f,y){return u.call.apply(u.bind,arguments)}function p(u,f,y){if(!u)throw Error();if(2<arguments.length){var I=Array.prototype.slice.call(arguments,2);return function(){var M=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(M,I),u.apply(f,M)}}return function(){return u.apply(f,arguments)}}function m(u,f,y){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,m.apply(null,arguments)}function g(u,f){var y=Array.prototype.slice.call(arguments,1);return function(){var I=y.slice();return I.push.apply(I,arguments),u.apply(this,I)}}function v(u,f){function y(){}y.prototype=f.prototype,u.aa=f.prototype,u.prototype=new y,u.prototype.constructor=u,u.Qb=function(I,M,L){for(var q=Array(arguments.length-2),we=2;we<arguments.length;we++)q[we-2]=arguments[we];return f.prototype[M].apply(I,q)}}function E(u){const f=u.length;if(0<f){const y=Array(f);for(let I=0;I<f;I++)y[I]=u[I];return y}return[]}function N(u,f){for(let y=1;y<arguments.length;y++){const I=arguments[y];if(l(I)){const M=u.length||0,L=I.length||0;u.length=M+L;for(let q=0;q<L;q++)u[M+q]=I[q]}else u.push(I)}}class S{constructor(f,y){this.i=f,this.j=y,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function _(u){return/^[\s\xa0]*$/.test(u)}function x(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function D(u){return D[" "](u),u}D[" "]=function(){};var O=x().indexOf("Gecko")!=-1&&!(x().toLowerCase().indexOf("webkit")!=-1&&x().indexOf("Edge")==-1)&&!(x().indexOf("Trident")!=-1||x().indexOf("MSIE")!=-1)&&x().indexOf("Edge")==-1;function j(u,f,y){for(const I in u)f.call(y,u[I],I,u)}function R(u,f){for(const y in u)f.call(void 0,u[y],y,u)}function w(u){const f={};for(const y in u)f[y]=u[y];return f}const C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(u,f){let y,I;for(let M=1;M<arguments.length;M++){I=arguments[M];for(y in I)u[y]=I[y];for(let L=0;L<C.length;L++)y=C[L],Object.prototype.hasOwnProperty.call(I,y)&&(u[y]=I[y])}}function b(u){var f=1;u=u.split(":");const y=[];for(;0<f&&u.length;)y.push(u.shift()),f--;return u.length&&y.push(u.join(":")),y}function P(u){a.setTimeout(()=>{throw u},0)}function A(){var u=V;let f=null;return u.g&&(f=u.g,u.g=u.g.next,u.g||(u.h=null),f.next=null),f}class X{constructor(){this.h=this.g=null}add(f,y){const I=ge.get();I.set(f,y),this.h?this.h.next=I:this.g=I,this.h=I}}var ge=new S(()=>new Se,u=>u.reset());class Se{constructor(){this.next=this.g=this.h=null}set(f,y){this.h=f,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let fe,z=!1,V=new X,$=()=>{const u=a.Promise.resolve(void 0);fe=()=>{u.then(Q)}};var Q=()=>{for(var u;u=A();){try{u.h.call(u.g)}catch(y){P(y)}var f=ge;f.j(u),100>f.h&&(f.h++,u.next=f.g,f.g=u)}z=!1};function se(){this.s=this.s,this.C=this.C}se.prototype.s=!1,se.prototype.ma=function(){this.s||(this.s=!0,this.N())},se.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ce(u,f){this.type=u,this.g=this.target=f,this.defaultPrevented=!1}ce.prototype.h=function(){this.defaultPrevented=!0};var ft=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,f=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const y=()=>{};a.addEventListener("test",y,f),a.removeEventListener("test",y,f)}catch{}return u}();function Rt(u,f){if(ce.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var y=this.type=u.type,I=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=f,f=u.relatedTarget){if(O){e:{try{D(f.nodeName);var M=!0;break e}catch{}M=!1}M||(f=null)}}else y=="mouseover"?f=u.fromElement:y=="mouseout"&&(f=u.toElement);this.relatedTarget=f,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:Ue[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Rt.aa.h.call(this)}}v(Rt,ce);var Ue={2:"touch",3:"pen",4:"mouse"};Rt.prototype.h=function(){Rt.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Ye="closure_listenable_"+(1e6*Math.random()|0),un=0;function Ms(u,f,y,I,M){this.listener=u,this.proxy=null,this.src=f,this.type=y,this.capture=!!I,this.ha=M,this.key=++un,this.da=this.fa=!1}function hr(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function _e(u){this.src=u,this.g={},this.h=0}_e.prototype.add=function(u,f,y,I,M){var L=u.toString();u=this.g[L],u||(u=this.g[L]=[],this.h++);var q=zt(u,f,I,M);return-1<q?(f=u[q],y||(f.fa=!1)):(f=new Ms(f,this.src,L,!!I,M),f.fa=y,u.push(f)),f};function Jt(u,f){var y=f.type;if(y in u.g){var I=u.g[y],M=Array.prototype.indexOf.call(I,f,void 0),L;(L=0<=M)&&Array.prototype.splice.call(I,M,1),L&&(hr(f),u.g[y].length==0&&(delete u.g[y],u.h--))}}function zt(u,f,y,I){for(var M=0;M<u.length;++M){var L=u[M];if(!L.da&&L.listener==f&&L.capture==!!y&&L.ha==I)return M}return-1}var Qi="closure_lm_"+(1e6*Math.random()|0),Yi={};function qa(u,f,y,I,M){if(Array.isArray(f)){for(var L=0;L<f.length;L++)qa(u,f[L],y,I,M);return null}return y=Ji(y),u&&u[Ye]?u.K(f,y,c(I)?!!I.capture:!1,M):Uc(u,f,y,!1,I,M)}function Uc(u,f,y,I,M,L){if(!f)throw Error("Invalid event type");var q=c(M)?!!M.capture:!!M,we=Xi(u);if(we||(u[Qi]=we=new _e(u)),y=we.add(f,y,I,q,L),y.proxy)return y;if(I=$c(),y.proxy=I,I.src=u,I.listener=y,u.addEventListener)ft||(M=q),M===void 0&&(M=!1),u.addEventListener(f.toString(),I,M);else if(u.attachEvent)u.attachEvent(rs(f.toString()),I);else if(u.addListener&&u.removeListener)u.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return y}function $c(){function u(y){return f.call(u.src,u.listener,y)}const f=zc;return u}function Ha(u,f,y,I,M){if(Array.isArray(f))for(var L=0;L<f.length;L++)Ha(u,f[L],y,I,M);else I=c(I)?!!I.capture:!!I,y=Ji(y),u&&u[Ye]?(u=u.i,f=String(f).toString(),f in u.g&&(L=u.g[f],y=zt(L,y,I,M),-1<y&&(hr(L[y]),Array.prototype.splice.call(L,y,1),L.length==0&&(delete u.g[f],u.h--)))):u&&(u=Xi(u))&&(f=u.g[f.toString()],u=-1,f&&(u=zt(f,y,I,M)),(y=-1<u?f[u]:null)&&Sn(y))}function Sn(u){if(typeof u!="number"&&u&&!u.da){var f=u.src;if(f&&f[Ye])Jt(f.i,u);else{var y=u.type,I=u.proxy;f.removeEventListener?f.removeEventListener(y,I,u.capture):f.detachEvent?f.detachEvent(rs(y),I):f.addListener&&f.removeListener&&f.removeListener(I),(y=Xi(f))?(Jt(y,u),y.h==0&&(y.src=null,f[Qi]=null)):hr(u)}}}function rs(u){return u in Yi?Yi[u]:Yi[u]="on"+u}function zc(u,f){if(u.da)u=!0;else{f=new Rt(f,this);var y=u.listener,I=u.ha||u.src;u.fa&&Sn(u),u=y.call(I,f)}return u}function Xi(u){return u=u[Qi],u instanceof _e?u:null}var Vs="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ji(u){return typeof u=="function"?u:(u[Vs]||(u[Vs]=function(f){return u.handleEvent(f)}),u[Vs])}function qe(){se.call(this),this.i=new _e(this),this.M=this,this.F=null}v(qe,se),qe.prototype[Ye]=!0,qe.prototype.removeEventListener=function(u,f,y,I){Ha(this,u,f,y,I)};function Xe(u,f){var y,I=u.F;if(I)for(y=[];I;I=I.F)y.push(I);if(u=u.M,I=f.type||f,typeof f=="string")f=new ce(f,u);else if(f instanceof ce)f.target=f.target||u;else{var M=f;f=new ce(I,u),T(f,M)}if(M=!0,y)for(var L=y.length-1;0<=L;L--){var q=f.g=y[L];M=H(q,I,!0,f)&&M}if(q=f.g=u,M=H(q,I,!0,f)&&M,M=H(q,I,!1,f)&&M,y)for(L=0;L<y.length;L++)q=f.g=y[L],M=H(q,I,!1,f)&&M}qe.prototype.N=function(){if(qe.aa.N.call(this),this.i){var u=this.i,f;for(f in u.g){for(var y=u.g[f],I=0;I<y.length;I++)hr(y[I]);delete u.g[f],u.h--}}this.F=null},qe.prototype.K=function(u,f,y,I){return this.i.add(String(u),f,!1,y,I)},qe.prototype.L=function(u,f,y,I){return this.i.add(String(u),f,!0,y,I)};function H(u,f,y,I){if(f=u.i.g[String(f)],!f)return!0;f=f.concat();for(var M=!0,L=0;L<f.length;++L){var q=f[L];if(q&&!q.da&&q.capture==y){var we=q.listener,st=q.ha||q.src;q.fa&&Jt(u.i,q),M=we.call(st,I)!==!1&&M}}return M&&!I.defaultPrevented}function ae(u,f,y){if(typeof u=="function")y&&(u=m(u,y));else if(u&&typeof u.handleEvent=="function")u=m(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(u,f||0)}function Je(u){u.g=ae(()=>{u.g=null,u.i&&(u.i=!1,Je(u))},u.l);const f=u.h;u.h=null,u.m.apply(null,f)}class xe extends se{constructor(f,y){super(),this.m=f,this.l=y,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:Je(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function pt(u){se.call(this),this.h=u,this.g={}}v(pt,se);var Oe=[];function cn(u){j(u.g,function(f,y){this.g.hasOwnProperty(y)&&Sn(f)},u),u.g={}}pt.prototype.N=function(){pt.aa.N.call(this),cn(this)},pt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Os=a.JSON.stringify,Ga=a.JSON.parse,IS=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function Bc(){}Bc.prototype.h=null;function Pm(u){return u.h||(u.h=u.i())}function Dm(){}var Zi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function qc(){ce.call(this,"d")}v(qc,ce);function Hc(){ce.call(this,"c")}v(Hc,ce);var ss={},jm=null;function Wa(){return jm=jm||new qe}ss.La="serverreachability";function Mm(u){ce.call(this,ss.La,u)}v(Mm,ce);function eo(u){const f=Wa();Xe(f,new Mm(f))}ss.STAT_EVENT="statevent";function Vm(u,f){ce.call(this,ss.STAT_EVENT,u),this.stat=f}v(Vm,ce);function At(u){const f=Wa();Xe(f,new Vm(f,u))}ss.Ma="timingevent";function Om(u,f){ce.call(this,ss.Ma,u),this.size=f}v(Om,ce);function to(u,f){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},f)}function no(){this.g=!0}no.prototype.xa=function(){this.g=!1};function TS(u,f,y,I,M,L){u.info(function(){if(u.g)if(L)for(var q="",we=L.split("&"),st=0;st<we.length;st++){var pe=we[st].split("=");if(1<pe.length){var mt=pe[0];pe=pe[1];var gt=mt.split("_");q=2<=gt.length&&gt[1]=="type"?q+(mt+"="+pe+"&"):q+(mt+"=redacted&")}}else q=null;else q=L;return"XMLHTTP REQ ("+I+") [attempt "+M+"]: "+f+`
`+y+`
`+q})}function RS(u,f,y,I,M,L,q){u.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+M+"]: "+f+`
`+y+`
`+L+" "+q})}function Ls(u,f,y,I){u.info(function(){return"XMLHTTP TEXT ("+f+"): "+NS(u,y)+(I?" "+I:"")})}function AS(u,f){u.info(function(){return"TIMEOUT: "+f})}no.prototype.info=function(){};function NS(u,f){if(!u.g)return f;if(!f)return null;try{var y=JSON.parse(f);if(y){for(u=0;u<y.length;u++)if(Array.isArray(y[u])){var I=y[u];if(!(2>I.length)){var M=I[1];if(Array.isArray(M)&&!(1>M.length)){var L=M[0];if(L!="noop"&&L!="stop"&&L!="close")for(var q=1;q<M.length;q++)M[q]=""}}}}return Os(y)}catch{return f}}var Ka={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Lm={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Gc;function Qa(){}v(Qa,Bc),Qa.prototype.g=function(){return new XMLHttpRequest},Qa.prototype.i=function(){return{}},Gc=new Qa;function fr(u,f,y,I){this.j=u,this.i=f,this.l=y,this.R=I||1,this.U=new pt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Fm}function Fm(){this.i=null,this.g="",this.h=!1}var Um={},Wc={};function Kc(u,f,y){u.L=1,u.v=Za(Fn(f)),u.m=y,u.P=!0,$m(u,null)}function $m(u,f){u.F=Date.now(),Ya(u),u.A=Fn(u.v);var y=u.A,I=u.R;Array.isArray(I)||(I=[String(I)]),tg(y.i,"t",I),u.C=0,y=u.j.J,u.h=new Fm,u.g=_g(u.j,y?f:null,!u.m),0<u.O&&(u.M=new xe(m(u.Y,u,u.g),u.O)),f=u.U,y=u.g,I=u.ca;var M="readystatechange";Array.isArray(M)||(M&&(Oe[0]=M.toString()),M=Oe);for(var L=0;L<M.length;L++){var q=qa(y,M[L],I||f.handleEvent,!1,f.h||f);if(!q)break;f.g[q.key]=q}f=u.H?w(u.H):{},u.m?(u.u||(u.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,f)):(u.u="GET",u.g.ea(u.A,u.u,null,f)),eo(),TS(u.i,u.u,u.A,u.l,u.R,u.m)}fr.prototype.ca=function(u){u=u.target;const f=this.M;f&&Un(u)==3?f.j():this.Y(u)},fr.prototype.Y=function(u){try{if(u==this.g)e:{const gt=Un(this.g);var f=this.g.Ba();const $s=this.g.Z();if(!(3>gt)&&(gt!=3||this.g&&(this.h.h||this.g.oa()||lg(this.g)))){this.J||gt!=4||f==7||(f==8||0>=$s?eo(3):eo(2)),Qc(this);var y=this.g.Z();this.X=y;t:if(zm(this)){var I=lg(this.g);u="";var M=I.length,L=Un(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){is(this),ro(this);var q="";break t}this.h.i=new a.TextDecoder}for(f=0;f<M;f++)this.h.h=!0,u+=this.h.i.decode(I[f],{stream:!(L&&f==M-1)});I.length=0,this.h.g+=u,this.C=0,q=this.h.g}else q=this.g.oa();if(this.o=y==200,RS(this.i,this.u,this.A,this.l,this.R,gt,y),this.o){if(this.T&&!this.K){t:{if(this.g){var we,st=this.g;if((we=st.g?st.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(we)){var pe=we;break t}}pe=null}if(y=pe)Ls(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Yc(this,y);else{this.o=!1,this.s=3,At(12),is(this),ro(this);break e}}if(this.P){y=!0;let dn;for(;!this.J&&this.C<q.length;)if(dn=bS(this,q),dn==Wc){gt==4&&(this.s=4,At(14),y=!1),Ls(this.i,this.l,null,"[Incomplete Response]");break}else if(dn==Um){this.s=4,At(15),Ls(this.i,this.l,q,"[Invalid Chunk]"),y=!1;break}else Ls(this.i,this.l,dn,null),Yc(this,dn);if(zm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),gt!=4||q.length!=0||this.h.h||(this.s=1,At(16),y=!1),this.o=this.o&&y,!y)Ls(this.i,this.l,q,"[Invalid Chunked Response]"),is(this),ro(this);else if(0<q.length&&!this.W){this.W=!0;var mt=this.j;mt.g==this&&mt.ba&&!mt.M&&(mt.j.info("Great, no buffering proxy detected. Bytes received: "+q.length),nd(mt),mt.M=!0,At(11))}}else Ls(this.i,this.l,q,null),Yc(this,q);gt==4&&is(this),this.o&&!this.J&&(gt==4?mg(this.j,this):(this.o=!1,Ya(this)))}else WS(this.g),y==400&&0<q.indexOf("Unknown SID")?(this.s=3,At(12)):(this.s=0,At(13)),is(this),ro(this)}}}catch{}finally{}};function zm(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function bS(u,f){var y=u.C,I=f.indexOf(`
`,y);return I==-1?Wc:(y=Number(f.substring(y,I)),isNaN(y)?Um:(I+=1,I+y>f.length?Wc:(f=f.slice(I,I+y),u.C=I+y,f)))}fr.prototype.cancel=function(){this.J=!0,is(this)};function Ya(u){u.S=Date.now()+u.I,Bm(u,u.I)}function Bm(u,f){if(u.B!=null)throw Error("WatchDog timer not null");u.B=to(m(u.ba,u),f)}function Qc(u){u.B&&(a.clearTimeout(u.B),u.B=null)}fr.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(AS(this.i,this.A),this.L!=2&&(eo(),At(17)),is(this),this.s=2,ro(this)):Bm(this,this.S-u)};function ro(u){u.j.G==0||u.J||mg(u.j,u)}function is(u){Qc(u);var f=u.M;f&&typeof f.ma=="function"&&f.ma(),u.M=null,cn(u.U),u.g&&(f=u.g,u.g=null,f.abort(),f.ma())}function Yc(u,f){try{var y=u.j;if(y.G!=0&&(y.g==u||Xc(y.h,u))){if(!u.K&&Xc(y.h,u)&&y.G==3){try{var I=y.Da.g.parse(f)}catch{I=null}if(Array.isArray(I)&&I.length==3){var M=I;if(M[0]==0){e:if(!y.u){if(y.g)if(y.g.F+3e3<u.F)il(y),rl(y);else break e;td(y),At(18)}}else y.za=M[1],0<y.za-y.T&&37500>M[2]&&y.F&&y.v==0&&!y.C&&(y.C=to(m(y.Za,y),6e3));if(1>=Gm(y.h)&&y.ca){try{y.ca()}catch{}y.ca=void 0}}else as(y,11)}else if((u.K||y.g==u)&&il(y),!_(f))for(M=y.Da.g.parse(f),f=0;f<M.length;f++){let pe=M[f];if(y.T=pe[0],pe=pe[1],y.G==2)if(pe[0]=="c"){y.K=pe[1],y.ia=pe[2];const mt=pe[3];mt!=null&&(y.la=mt,y.j.info("VER="+y.la));const gt=pe[4];gt!=null&&(y.Aa=gt,y.j.info("SVER="+y.Aa));const $s=pe[5];$s!=null&&typeof $s=="number"&&0<$s&&(I=1.5*$s,y.L=I,y.j.info("backChannelRequestTimeoutMs_="+I)),I=y;const dn=u.g;if(dn){const al=dn.g?dn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(al){var L=I.h;L.g||al.indexOf("spdy")==-1&&al.indexOf("quic")==-1&&al.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(Jc(L,L.h),L.h=null))}if(I.D){const rd=dn.g?dn.g.getResponseHeader("X-HTTP-Session-Id"):null;rd&&(I.ya=rd,Ce(I.I,I.D,rd))}}y.G=3,y.l&&y.l.ua(),y.ba&&(y.R=Date.now()-u.F,y.j.info("Handshake RTT: "+y.R+"ms")),I=y;var q=u;if(I.qa=vg(I,I.J?I.ia:null,I.W),q.K){Wm(I.h,q);var we=q,st=I.L;st&&(we.I=st),we.B&&(Qc(we),Ya(we)),I.g=q}else fg(I);0<y.i.length&&sl(y)}else pe[0]!="stop"&&pe[0]!="close"||as(y,7);else y.G==3&&(pe[0]=="stop"||pe[0]=="close"?pe[0]=="stop"?as(y,7):ed(y):pe[0]!="noop"&&y.l&&y.l.ta(pe),y.v=0)}}eo(4)}catch{}}var kS=class{constructor(u,f){this.g=u,this.map=f}};function qm(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Hm(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Gm(u){return u.h?1:u.g?u.g.size:0}function Xc(u,f){return u.h?u.h==f:u.g?u.g.has(f):!1}function Jc(u,f){u.g?u.g.add(f):u.h=f}function Wm(u,f){u.h&&u.h==f?u.h=null:u.g&&u.g.has(f)&&u.g.delete(f)}qm.prototype.cancel=function(){if(this.i=Km(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Km(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let f=u.i;for(const y of u.g.values())f=f.concat(y.D);return f}return E(u.i)}function PS(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var f=[],y=u.length,I=0;I<y;I++)f.push(u[I]);return f}f=[],y=0;for(I in u)f[y++]=u[I];return f}function DS(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var f=[];u=u.length;for(var y=0;y<u;y++)f.push(y);return f}f=[],y=0;for(const I in u)f[y++]=I;return f}}}function Qm(u,f){if(u.forEach&&typeof u.forEach=="function")u.forEach(f,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,f,void 0);else for(var y=DS(u),I=PS(u),M=I.length,L=0;L<M;L++)f.call(void 0,I[L],y&&y[L],u)}var Ym=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function jS(u,f){if(u){u=u.split("&");for(var y=0;y<u.length;y++){var I=u[y].indexOf("="),M=null;if(0<=I){var L=u[y].substring(0,I);M=u[y].substring(I+1)}else L=u[y];f(L,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function os(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof os){this.h=u.h,Xa(this,u.j),this.o=u.o,this.g=u.g,Ja(this,u.s),this.l=u.l;var f=u.i,y=new oo;y.i=f.i,f.g&&(y.g=new Map(f.g),y.h=f.h),Xm(this,y),this.m=u.m}else u&&(f=String(u).match(Ym))?(this.h=!1,Xa(this,f[1]||"",!0),this.o=so(f[2]||""),this.g=so(f[3]||"",!0),Ja(this,f[4]),this.l=so(f[5]||"",!0),Xm(this,f[6]||"",!0),this.m=so(f[7]||"")):(this.h=!1,this.i=new oo(null,this.h))}os.prototype.toString=function(){var u=[],f=this.j;f&&u.push(io(f,Jm,!0),":");var y=this.g;return(y||f=="file")&&(u.push("//"),(f=this.o)&&u.push(io(f,Jm,!0),"@"),u.push(encodeURIComponent(String(y)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.s,y!=null&&u.push(":",String(y))),(y=this.l)&&(this.g&&y.charAt(0)!="/"&&u.push("/"),u.push(io(y,y.charAt(0)=="/"?OS:VS,!0))),(y=this.i.toString())&&u.push("?",y),(y=this.m)&&u.push("#",io(y,FS)),u.join("")};function Fn(u){return new os(u)}function Xa(u,f,y){u.j=y?so(f,!0):f,u.j&&(u.j=u.j.replace(/:$/,""))}function Ja(u,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);u.s=f}else u.s=null}function Xm(u,f,y){f instanceof oo?(u.i=f,US(u.i,u.h)):(y||(f=io(f,LS)),u.i=new oo(f,u.h))}function Ce(u,f,y){u.i.set(f,y)}function Za(u){return Ce(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function so(u,f){return u?f?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function io(u,f,y){return typeof u=="string"?(u=encodeURI(u).replace(f,MS),y&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function MS(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Jm=/[#\/\?@]/g,VS=/[#\?:]/g,OS=/[#\?]/g,LS=/[#\?@]/g,FS=/#/g;function oo(u,f){this.h=this.g=null,this.i=u||null,this.j=!!f}function pr(u){u.g||(u.g=new Map,u.h=0,u.i&&jS(u.i,function(f,y){u.add(decodeURIComponent(f.replace(/\+/g," ")),y)}))}t=oo.prototype,t.add=function(u,f){pr(this),this.i=null,u=Fs(this,u);var y=this.g.get(u);return y||this.g.set(u,y=[]),y.push(f),this.h+=1,this};function Zm(u,f){pr(u),f=Fs(u,f),u.g.has(f)&&(u.i=null,u.h-=u.g.get(f).length,u.g.delete(f))}function eg(u,f){return pr(u),f=Fs(u,f),u.g.has(f)}t.forEach=function(u,f){pr(this),this.g.forEach(function(y,I){y.forEach(function(M){u.call(f,M,I,this)},this)},this)},t.na=function(){pr(this);const u=Array.from(this.g.values()),f=Array.from(this.g.keys()),y=[];for(let I=0;I<f.length;I++){const M=u[I];for(let L=0;L<M.length;L++)y.push(f[I])}return y},t.V=function(u){pr(this);let f=[];if(typeof u=="string")eg(this,u)&&(f=f.concat(this.g.get(Fs(this,u))));else{u=Array.from(this.g.values());for(let y=0;y<u.length;y++)f=f.concat(u[y])}return f},t.set=function(u,f){return pr(this),this.i=null,u=Fs(this,u),eg(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[f]),this.h+=1,this},t.get=function(u,f){return u?(u=this.V(u),0<u.length?String(u[0]):f):f};function tg(u,f,y){Zm(u,f),0<y.length&&(u.i=null,u.g.set(Fs(u,f),E(y)),u.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],f=Array.from(this.g.keys());for(var y=0;y<f.length;y++){var I=f[y];const L=encodeURIComponent(String(I)),q=this.V(I);for(I=0;I<q.length;I++){var M=L;q[I]!==""&&(M+="="+encodeURIComponent(String(q[I]))),u.push(M)}}return this.i=u.join("&")};function Fs(u,f){return f=String(f),u.j&&(f=f.toLowerCase()),f}function US(u,f){f&&!u.j&&(pr(u),u.i=null,u.g.forEach(function(y,I){var M=I.toLowerCase();I!=M&&(Zm(this,I),tg(this,M,y))},u)),u.j=f}function $S(u,f){const y=new no;if(a.Image){const I=new Image;I.onload=g(mr,y,"TestLoadImage: loaded",!0,f,I),I.onerror=g(mr,y,"TestLoadImage: error",!1,f,I),I.onabort=g(mr,y,"TestLoadImage: abort",!1,f,I),I.ontimeout=g(mr,y,"TestLoadImage: timeout",!1,f,I),a.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=u}else f(!1)}function zS(u,f){const y=new no,I=new AbortController,M=setTimeout(()=>{I.abort(),mr(y,"TestPingServer: timeout",!1,f)},1e4);fetch(u,{signal:I.signal}).then(L=>{clearTimeout(M),L.ok?mr(y,"TestPingServer: ok",!0,f):mr(y,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(M),mr(y,"TestPingServer: error",!1,f)})}function mr(u,f,y,I,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),I(y)}catch{}}function BS(){this.g=new IS}function qS(u,f,y){const I=y||"";try{Qm(u,function(M,L){let q=M;c(M)&&(q=Os(M)),f.push(I+L+"="+encodeURIComponent(q))})}catch(M){throw f.push(I+"type="+encodeURIComponent("_badmap")),M}}function el(u){this.l=u.Ub||null,this.j=u.eb||!1}v(el,Bc),el.prototype.g=function(){return new tl(this.l,this.j)},el.prototype.i=function(u){return function(){return u}}({});function tl(u,f){qe.call(this),this.D=u,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(tl,qe),t=tl.prototype,t.open=function(u,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=f,this.readyState=1,lo(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(f.body=u),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ao(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,lo(this)),this.g&&(this.readyState=3,lo(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ng(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function ng(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var f=u.value?u.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!u.done}))&&(this.response=this.responseText+=f)}u.done?ao(this):lo(this),this.readyState==3&&ng(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,ao(this))},t.Qa=function(u){this.g&&(this.response=u,ao(this))},t.ga=function(){this.g&&ao(this)};function ao(u){u.readyState=4,u.l=null,u.j=null,u.v=null,lo(u)}t.setRequestHeader=function(u,f){this.u.append(u,f)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],f=this.h.entries();for(var y=f.next();!y.done;)y=y.value,u.push(y[0]+": "+y[1]),y=f.next();return u.join(`\r
`)};function lo(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(tl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function rg(u){let f="";return j(u,function(y,I){f+=I,f+=":",f+=y,f+=`\r
`}),f}function Zc(u,f,y){e:{for(I in y){var I=!1;break e}I=!0}I||(y=rg(y),typeof u=="string"?y!=null&&encodeURIComponent(String(y)):Ce(u,f,y))}function Me(u){qe.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(Me,qe);var HS=/^https?$/i,GS=["POST","PUT"];t=Me.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,f,y,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);f=f?f.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Gc.g(),this.v=this.o?Pm(this.o):Pm(Gc),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(f,String(u),!0),this.B=!1}catch(L){sg(this,L);return}if(u=y||"",y=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var M in I)y.set(M,I[M]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const L of I.keys())y.set(L,I.get(L));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(y.keys()).find(L=>L.toLowerCase()=="content-type"),M=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(GS,f,void 0))||I||M||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[L,q]of y)this.g.setRequestHeader(L,q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ag(this),this.u=!0,this.g.send(u),this.u=!1}catch(L){sg(this,L)}};function sg(u,f){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=f,u.m=5,ig(u),nl(u)}function ig(u){u.A||(u.A=!0,Xe(u,"complete"),Xe(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Xe(this,"complete"),Xe(this,"abort"),nl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),nl(this,!0)),Me.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?og(this):this.bb())},t.bb=function(){og(this)};function og(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Un(u)!=4||u.Z()!=2)){if(u.u&&Un(u)==4)ae(u.Ea,0,u);else if(Xe(u,"readystatechange"),Un(u)==4){u.h=!1;try{const q=u.Z();e:switch(q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var y;if(!(y=f)){var I;if(I=q===0){var M=String(u.D).match(Ym)[1]||null;!M&&a.self&&a.self.location&&(M=a.self.location.protocol.slice(0,-1)),I=!HS.test(M?M.toLowerCase():"")}y=I}if(y)Xe(u,"complete"),Xe(u,"success");else{u.m=6;try{var L=2<Un(u)?u.g.statusText:""}catch{L=""}u.l=L+" ["+u.Z()+"]",ig(u)}}finally{nl(u)}}}}function nl(u,f){if(u.g){ag(u);const y=u.g,I=u.v[0]?()=>{}:null;u.g=null,u.v=null,f||Xe(u,"ready");try{y.onreadystatechange=I}catch{}}}function ag(u){u.I&&(a.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function Un(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<Un(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var f=this.g.responseText;return u&&f.indexOf(u)==0&&(f=f.substring(u.length)),Ga(f)}};function lg(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function WS(u){const f={};u=(u.g&&2<=Un(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<u.length;I++){if(_(u[I]))continue;var y=b(u[I]);const M=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const L=f[M]||[];f[M]=L,L.push(y)}R(f,function(I){return I.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function uo(u,f,y){return y&&y.internalChannelParams&&y.internalChannelParams[u]||f}function ug(u){this.Aa=0,this.i=[],this.j=new no,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=uo("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=uo("baseRetryDelayMs",5e3,u),this.cb=uo("retryDelaySeedMs",1e4,u),this.Wa=uo("forwardChannelMaxRetries",2,u),this.wa=uo("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new qm(u&&u.concurrentRequestLimit),this.Da=new BS,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=ug.prototype,t.la=8,t.G=1,t.connect=function(u,f,y,I){At(0),this.W=u,this.H=f||{},y&&I!==void 0&&(this.H.OSID=y,this.H.OAID=I),this.F=this.X,this.I=vg(this,null,this.W),sl(this)};function ed(u){if(cg(u),u.G==3){var f=u.U++,y=Fn(u.I);if(Ce(y,"SID",u.K),Ce(y,"RID",f),Ce(y,"TYPE","terminate"),co(u,y),f=new fr(u,u.j,f),f.L=2,f.v=Za(Fn(y)),y=!1,a.navigator&&a.navigator.sendBeacon)try{y=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!y&&a.Image&&(new Image().src=f.v,y=!0),y||(f.g=_g(f.j,null),f.g.ea(f.v)),f.F=Date.now(),Ya(f)}yg(u)}function rl(u){u.g&&(nd(u),u.g.cancel(),u.g=null)}function cg(u){rl(u),u.u&&(a.clearTimeout(u.u),u.u=null),il(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function sl(u){if(!Hm(u.h)&&!u.s){u.s=!0;var f=u.Ga;fe||$(),z||(fe(),z=!0),V.add(f,u),u.B=0}}function KS(u,f){return Gm(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=f.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=to(m(u.Ga,u,f),gg(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const M=new fr(this,this.j,u);let L=this.o;if(this.S&&(L?(L=w(L),T(L,this.S)):L=this.S),this.m!==null||this.O||(M.H=L,L=null),this.P)e:{for(var f=0,y=0;y<this.i.length;y++){t:{var I=this.i[y];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(f+=I,4096<f){f=y;break e}if(f===4096||y===this.i.length-1){f=y+1;break e}}f=1e3}else f=1e3;f=hg(this,M,f),y=Fn(this.I),Ce(y,"RID",u),Ce(y,"CVER",22),this.D&&Ce(y,"X-HTTP-Session-Id",this.D),co(this,y),L&&(this.O?f="headers="+encodeURIComponent(String(rg(L)))+"&"+f:this.m&&Zc(y,this.m,L)),Jc(this.h,M),this.Ua&&Ce(y,"TYPE","init"),this.P?(Ce(y,"$req",f),Ce(y,"SID","null"),M.T=!0,Kc(M,y,null)):Kc(M,y,f),this.G=2}}else this.G==3&&(u?dg(this,u):this.i.length==0||Hm(this.h)||dg(this))};function dg(u,f){var y;f?y=f.l:y=u.U++;const I=Fn(u.I);Ce(I,"SID",u.K),Ce(I,"RID",y),Ce(I,"AID",u.T),co(u,I),u.m&&u.o&&Zc(I,u.m,u.o),y=new fr(u,u.j,y,u.B+1),u.m===null&&(y.H=u.o),f&&(u.i=f.D.concat(u.i)),f=hg(u,y,1e3),y.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Jc(u.h,y),Kc(y,I,f)}function co(u,f){u.H&&j(u.H,function(y,I){Ce(f,I,y)}),u.l&&Qm({},function(y,I){Ce(f,I,y)})}function hg(u,f,y){y=Math.min(u.i.length,y);var I=u.l?m(u.l.Na,u.l,u):null;e:{var M=u.i;let L=-1;for(;;){const q=["count="+y];L==-1?0<y?(L=M[0].g,q.push("ofs="+L)):L=0:q.push("ofs="+L);let we=!0;for(let st=0;st<y;st++){let pe=M[st].g;const mt=M[st].map;if(pe-=L,0>pe)L=Math.max(0,M[st].g-100),we=!1;else try{qS(mt,q,"req"+pe+"_")}catch{I&&I(mt)}}if(we){I=q.join("&");break e}}}return u=u.i.splice(0,y),f.D=u,I}function fg(u){if(!u.g&&!u.u){u.Y=1;var f=u.Fa;fe||$(),z||(fe(),z=!0),V.add(f,u),u.v=0}}function td(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=to(m(u.Fa,u),gg(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,pg(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=to(m(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,At(10),rl(this),pg(this))};function nd(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function pg(u){u.g=new fr(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var f=Fn(u.qa);Ce(f,"RID","rpc"),Ce(f,"SID",u.K),Ce(f,"AID",u.T),Ce(f,"CI",u.F?"0":"1"),!u.F&&u.ja&&Ce(f,"TO",u.ja),Ce(f,"TYPE","xmlhttp"),co(u,f),u.m&&u.o&&Zc(f,u.m,u.o),u.L&&(u.g.I=u.L);var y=u.g;u=u.ia,y.L=1,y.v=Za(Fn(f)),y.m=null,y.P=!0,$m(y,u)}t.Za=function(){this.C!=null&&(this.C=null,rl(this),td(this),At(19))};function il(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function mg(u,f){var y=null;if(u.g==f){il(u),nd(u),u.g=null;var I=2}else if(Xc(u.h,f))y=f.D,Wm(u.h,f),I=1;else return;if(u.G!=0){if(f.o)if(I==1){y=f.m?f.m.length:0,f=Date.now()-f.F;var M=u.B;I=Wa(),Xe(I,new Om(I,y)),sl(u)}else fg(u);else if(M=f.s,M==3||M==0&&0<f.X||!(I==1&&KS(u,f)||I==2&&td(u)))switch(y&&0<y.length&&(f=u.h,f.i=f.i.concat(y)),M){case 1:as(u,5);break;case 4:as(u,10);break;case 3:as(u,6);break;default:as(u,2)}}}function gg(u,f){let y=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(y*=2),y*f}function as(u,f){if(u.j.info("Error code "+f),f==2){var y=m(u.fb,u),I=u.Xa;const M=!I;I=new os(I||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Xa(I,"https"),Za(I),M?$S(I.toString(),y):zS(I.toString(),y)}else At(2);u.G=0,u.l&&u.l.sa(f),yg(u),cg(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),At(2)):(this.j.info("Failed to ping google.com"),At(1))};function yg(u){if(u.G=0,u.ka=[],u.l){const f=Km(u.h);(f.length!=0||u.i.length!=0)&&(N(u.ka,f),N(u.ka,u.i),u.h.i.length=0,E(u.i),u.i.length=0),u.l.ra()}}function vg(u,f,y){var I=y instanceof os?Fn(y):new os(y);if(I.g!="")f&&(I.g=f+"."+I.g),Ja(I,I.s);else{var M=a.location;I=M.protocol,f=f?f+"."+M.hostname:M.hostname,M=+M.port;var L=new os(null);I&&Xa(L,I),f&&(L.g=f),M&&Ja(L,M),y&&(L.l=y),I=L}return y=u.D,f=u.ya,y&&f&&Ce(I,y,f),Ce(I,"VER",u.la),co(u,I),I}function _g(u,f,y){if(f&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=u.Ca&&!u.pa?new Me(new el({eb:y})):new Me(u.pa),f.Ha(u.J),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function wg(){}t=wg.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ol(){}ol.prototype.g=function(u,f){return new Bt(u,f)};function Bt(u,f){qe.call(this),this.g=new ug(f),this.l=u,this.h=f&&f.messageUrlParams||null,u=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(u?u["X-WebChannel-Content-Type"]=f.messageContentType:u={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(u?u["X-WebChannel-Client-Profile"]=f.va:u={"X-WebChannel-Client-Profile":f.va}),this.g.S=u,(u=f&&f.Sb)&&!_(u)&&(this.g.m=u),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!_(f)&&(this.g.D=f,u=this.h,u!==null&&f in u&&(u=this.h,f in u&&delete u[f])),this.j=new Us(this)}v(Bt,qe),Bt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Bt.prototype.close=function(){ed(this.g)},Bt.prototype.o=function(u){var f=this.g;if(typeof u=="string"){var y={};y.__data__=u,u=y}else this.u&&(y={},y.__data__=Os(u),u=y);f.i.push(new kS(f.Ya++,u)),f.G==3&&sl(f)},Bt.prototype.N=function(){this.g.l=null,delete this.j,ed(this.g),delete this.g,Bt.aa.N.call(this)};function xg(u){qc.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var f=u.__sm__;if(f){e:{for(const y in f){u=y;break e}u=void 0}(this.i=u)&&(u=this.i,f=f!==null&&u in f?f[u]:void 0),this.data=f}else this.data=u}v(xg,qc);function Eg(){Hc.call(this),this.status=1}v(Eg,Hc);function Us(u){this.g=u}v(Us,wg),Us.prototype.ua=function(){Xe(this.g,"a")},Us.prototype.ta=function(u){Xe(this.g,new xg(u))},Us.prototype.sa=function(u){Xe(this.g,new Eg)},Us.prototype.ra=function(){Xe(this.g,"b")},ol.prototype.createWebChannel=ol.prototype.g,Bt.prototype.send=Bt.prototype.o,Bt.prototype.open=Bt.prototype.m,Bt.prototype.close=Bt.prototype.close,Ox=function(){return new ol},Vx=function(){return Wa()},Mx=ss,af={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ka.NO_ERROR=0,Ka.TIMEOUT=8,Ka.HTTP_ERROR=6,Xl=Ka,Lm.COMPLETE="complete",jx=Lm,Dm.EventType=Zi,Zi.OPEN="a",Zi.CLOSE="b",Zi.ERROR="c",Zi.MESSAGE="d",qe.prototype.listen=qe.prototype.K,No=Dm,Me.prototype.listenOnce=Me.prototype.L,Me.prototype.getLastError=Me.prototype.Ka,Me.prototype.getLastErrorCode=Me.prototype.Ba,Me.prototype.getStatus=Me.prototype.Z,Me.prototype.getResponseJson=Me.prototype.Oa,Me.prototype.getResponseText=Me.prototype.oa,Me.prototype.send=Me.prototype.ea,Me.prototype.setWithCredentials=Me.prototype.Ha,Dx=Me}).apply(typeof Tl<"u"?Tl:typeof self<"u"?self:typeof window<"u"?window:{});const gv="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}xt.UNAUTHENTICATED=new xt(null),xt.GOOGLE_CREDENTIALS=new xt("google-credentials-uid"),xt.FIRST_PARTY=new xt("first-party-uid"),xt.MOCK_USER=new xt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bi="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ts=new Np("@firebase/firestore");function wo(){return Ts.logLevel}function K(t,...e){if(Ts.logLevel<=le.DEBUG){const n=e.map($p);Ts.debug(`Firestore (${Bi}): ${t}`,...n)}}function sr(t,...e){if(Ts.logLevel<=le.ERROR){const n=e.map($p);Ts.error(`Firestore (${Bi}): ${t}`,...n)}}function Ai(t,...e){if(Ts.logLevel<=le.WARN){const n=e.map($p);Ts.warn(`Firestore (${Bi}): ${t}`,...n)}}function $p(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function te(t="Unexpected state"){const e=`FIRESTORE (${Bi}) INTERNAL ASSERTION FAILED: `+t;throw sr(e),new Error(e)}function ve(t,e){t||te()}function re(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class G extends Ln{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lx{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Rb{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(xt.UNAUTHENTICATED))}shutdown(){}}class Ab{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Nb{constructor(e){this.t=e,this.currentUser=xt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ve(this.o===void 0);let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new Xn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Xn,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{K("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(K("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Xn)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(K("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ve(typeof r.accessToken=="string"),new Lx(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ve(e===null||typeof e=="string"),new xt(e)}}class bb{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=xt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class kb{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new bb(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(xt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Pb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Db{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){ve(this.o===void 0);const r=i=>{i.error!=null&&K("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,K("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{K("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):K("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ve(typeof n.token=="string"),this.R=n.token,new Pb(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jb(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fx{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=jb(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function me(t,e){return t<e?-1:t>e?1:0}function Ni(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new G(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new G(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new G(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new G(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ke.fromMillis(Date.now())}static fromDate(e){return Ke.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Ke(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?me(this.nanoseconds,e.nanoseconds):me(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ne(e)}static min(){return new ne(new Ke(0,0))}static max(){return new ne(new Ke(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(e,n,r){n===void 0?n=0:n>e.length&&te(),r===void 0?r=e.length-n:r>e.length-n&&te(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ga.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ga?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Te extends ga{construct(e,n,r){return new Te(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new G(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Te(n)}static emptyPath(){return new Te([])}}const Mb=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class at extends ga{construct(e,n,r){return new at(e,n,r)}static isValidIdentifier(e){return Mb.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),at.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new at(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new G(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new G(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new G(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new G(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new at(n)}static emptyPath(){return new at([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(e){this.path=e}static fromPath(e){return new Y(Te.fromString(e))}static fromName(e){return new Y(Te.fromString(e).popFirst(5))}static empty(){return new Y(Te.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Te.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Te.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Y(new Te(e.slice()))}}function Vb(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ne.fromTimestamp(r===1e9?new Ke(n+1,0):new Ke(n,r));return new Kr(s,Y.empty(),e)}function Ob(t){return new Kr(t.readTime,t.key,-1)}class Kr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Kr(ne.min(),Y.empty(),-1)}static max(){return new Kr(ne.max(),Y.empty(),-1)}}function Lb(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Y.comparator(t.documentKey,e.documentKey),n!==0?n:me(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ub{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Va(t){if(t.code!==F.FAILED_PRECONDITION||t.message!==Fb)throw t;K("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&te(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new U((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof U?n:U.resolve(n)}catch(n){return U.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):U.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):U.reject(n)}static resolve(e){return new U((n,r)=>{n(e)})}static reject(e){return new U((n,r)=>{r(e)})}static waitFor(e){return new U((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=U.resolve(!1);for(const r of e)n=n.next(s=>s?U.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new U((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;n(e[c]).next(h=>{o[c]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new U((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function $b(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Oa(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zp{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}zp.oe=-1;function yc(t){return t==null}function Vu(t){return t===0&&1/t==-1/0}function zb(t){return typeof t=="number"&&Number.isInteger(t)&&!Vu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yv(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ds(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ux(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(e,n){this.comparator=e,this.root=n||ot.EMPTY}insert(e,n){return new je(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ot.BLACK,null,null))}remove(e){return new je(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ot.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Rl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Rl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Rl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Rl(this.root,e,this.comparator,!0)}}class Rl{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ot{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ot.RED,this.left=s??ot.EMPTY,this.right=i??ot.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new ot(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ot.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return ot.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ot.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ot.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw te();const e=this.left.check();if(e!==this.right.check())throw te();return e+(this.isRed()?0:1)}}ot.EMPTY=null,ot.RED=!0,ot.BLACK=!1;ot.EMPTY=new class{constructor(){this.size=0}get key(){throw te()}get value(){throw te()}get color(){throw te()}get left(){throw te()}get right(){throw te()}copy(e,n,r,s,i){return this}insert(e,n,r){return new ot(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(e){this.comparator=e,this.data=new je(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new vv(this.data.getIterator())}getIteratorFrom(e){return new vv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof ut)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new ut(this.comparator);return n.data=e,n}}class vv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.fields=e,e.sort(at.comparator)}static empty(){return new Gt([])}unionWith(e){let n=new ut(at.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Gt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ni(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $x extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new $x("Invalid base64 string: "+i):i}}(e);return new ht(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new ht(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return me(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ht.EMPTY_BYTE_STRING=new ht("");const Bb=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qr(t){if(ve(!!t),typeof t=="string"){let e=0;const n=Bb.exec(t);if(ve(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Le(t.seconds),nanos:Le(t.nanos)}}function Le(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Rs(t){return typeof t=="string"?ht.fromBase64String(t):ht.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bp(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function qp(t){const e=t.mapValue.fields.__previous_value__;return Bp(e)?qp(e):e}function ya(t){const e=Qr(t.mapValue.fields.__local_write_time__.timestampValue);return new Ke(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qb{constructor(e,n,r,s,i,o,a,l,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class va{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new va("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof va&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Al={mapValue:{}};function As(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Bp(t)?4:Gb(t)?9007199254740991:Hb(t)?10:11:te()}function Mn(t,e){if(t===e)return!0;const n=As(t);if(n!==As(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ya(t).isEqual(ya(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Qr(s.timestampValue),a=Qr(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Rs(s.bytesValue).isEqual(Rs(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Le(s.geoPointValue.latitude)===Le(i.geoPointValue.latitude)&&Le(s.geoPointValue.longitude)===Le(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Le(s.integerValue)===Le(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Le(s.doubleValue),a=Le(i.doubleValue);return o===a?Vu(o)===Vu(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Ni(t.arrayValue.values||[],e.arrayValue.values||[],Mn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(yv(o)!==yv(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Mn(o[l],a[l])))return!1;return!0}(t,e);default:return te()}}function _a(t,e){return(t.values||[]).find(n=>Mn(n,e))!==void 0}function bi(t,e){if(t===e)return 0;const n=As(t),r=As(e);if(n!==r)return me(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return me(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Le(i.integerValue||i.doubleValue),l=Le(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return _v(t.timestampValue,e.timestampValue);case 4:return _v(ya(t),ya(e));case 5:return me(t.stringValue,e.stringValue);case 6:return function(i,o){const a=Rs(i),l=Rs(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const h=me(a[c],l[c]);if(h!==0)return h}return me(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=me(Le(i.latitude),Le(o.latitude));return a!==0?a:me(Le(i.longitude),Le(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return wv(t.arrayValue,e.arrayValue);case 10:return function(i,o){var a,l,c,h;const p=i.fields||{},m=o.fields||{},g=(a=p.value)===null||a===void 0?void 0:a.arrayValue,v=(l=m.value)===null||l===void 0?void 0:l.arrayValue,E=me(((c=g==null?void 0:g.values)===null||c===void 0?void 0:c.length)||0,((h=v==null?void 0:v.values)===null||h===void 0?void 0:h.length)||0);return E!==0?E:wv(g,v)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Al.mapValue&&o===Al.mapValue)return 0;if(i===Al.mapValue)return 1;if(o===Al.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let p=0;p<l.length&&p<h.length;++p){const m=me(l[p],h[p]);if(m!==0)return m;const g=bi(a[l[p]],c[h[p]]);if(g!==0)return g}return me(l.length,h.length)}(t.mapValue,e.mapValue);default:throw te()}}function _v(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return me(t,e);const n=Qr(t),r=Qr(e),s=me(n.seconds,r.seconds);return s!==0?s:me(n.nanos,r.nanos)}function wv(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=bi(n[s],r[s]);if(i)return i}return me(n.length,r.length)}function ki(t){return lf(t)}function lf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Qr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Rs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Y.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=lf(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${lf(n.fields[o])}`;return s+"}"}(t.mapValue):te()}function xv(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function uf(t){return!!t&&"integerValue"in t}function Hp(t){return!!t&&"arrayValue"in t}function Ev(t){return!!t&&"nullValue"in t}function Sv(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Jl(t){return!!t&&"mapValue"in t}function Hb(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function qo(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ds(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=qo(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=qo(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Gb(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e){this.value=e}static empty(){return new jt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Jl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=qo(n)}setAll(e){let n=at.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=qo(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Jl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Mn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Jl(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Ds(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new jt(qo(this.value))}}function zx(t){const e=[];return Ds(t.fields,(n,r)=>{const s=new at([n]);if(Jl(r)){const i=zx(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Gt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new St(e,0,ne.min(),ne.min(),ne.min(),jt.empty(),0)}static newFoundDocument(e,n,r,s){return new St(e,1,n,ne.min(),r,s,0)}static newNoDocument(e,n){return new St(e,2,n,ne.min(),ne.min(),jt.empty(),0)}static newUnknownDocument(e,n){return new St(e,3,n,ne.min(),ne.min(),jt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ne.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=jt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=jt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ne.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof St&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new St(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e,n){this.position=e,this.inclusive=n}}function Cv(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=Y.comparator(Y.fromName(o.referenceValue),n.key):r=bi(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Iv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Mn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e,n="asc"){this.field=e,this.dir=n}}function Wb(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{}class Be extends Bx{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Qb(e,n,r):n==="array-contains"?new Jb(e,r):n==="in"?new Zb(e,r):n==="not-in"?new ek(e,r):n==="array-contains-any"?new tk(e,r):new Be(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new Yb(e,r):new Xb(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(bi(n,this.value)):n!==null&&As(this.value)===As(n)&&this.matchesComparison(bi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return te()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class En extends Bx{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new En(e,n)}matches(e){return qx(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function qx(t){return t.op==="and"}function Hx(t){return Kb(t)&&qx(t)}function Kb(t){for(const e of t.filters)if(e instanceof En)return!1;return!0}function cf(t){if(t instanceof Be)return t.field.canonicalString()+t.op.toString()+ki(t.value);if(Hx(t))return t.filters.map(e=>cf(e)).join(",");{const e=t.filters.map(n=>cf(n)).join(",");return`${t.op}(${e})`}}function Gx(t,e){return t instanceof Be?function(r,s){return s instanceof Be&&r.op===s.op&&r.field.isEqual(s.field)&&Mn(r.value,s.value)}(t,e):t instanceof En?function(r,s){return s instanceof En&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&Gx(o,s.filters[a]),!0):!1}(t,e):void te()}function Wx(t){return t instanceof Be?function(n){return`${n.field.canonicalString()} ${n.op} ${ki(n.value)}`}(t):t instanceof En?function(n){return n.op.toString()+" {"+n.getFilters().map(Wx).join(" ,")+"}"}(t):"Filter"}class Qb extends Be{constructor(e,n,r){super(e,n,r),this.key=Y.fromName(r.referenceValue)}matches(e){const n=Y.comparator(e.key,this.key);return this.matchesComparison(n)}}class Yb extends Be{constructor(e,n){super(e,"in",n),this.keys=Kx("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Xb extends Be{constructor(e,n){super(e,"not-in",n),this.keys=Kx("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Kx(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Y.fromName(r.referenceValue))}class Jb extends Be{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Hp(n)&&_a(n.arrayValue,this.value)}}class Zb extends Be{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&_a(this.value.arrayValue,n)}}class ek extends Be{constructor(e,n){super(e,"not-in",n)}matches(e){if(_a(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!_a(this.value.arrayValue,n)}}class tk extends Be{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Hp(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>_a(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function Tv(t,e=null,n=[],r=[],s=null,i=null,o=null){return new nk(t,e,n,r,s,i,o)}function Gp(t){const e=re(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>cf(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),yc(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ki(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ki(r)).join(",")),e.ue=n}return e.ue}function Wp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Wb(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Gx(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Iv(t.startAt,e.startAt)&&Iv(t.endAt,e.endAt)}function df(t){return Y.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function rk(t,e,n,r,s,i,o,a){return new qi(t,e,n,r,s,i,o,a)}function vc(t){return new qi(t)}function Rv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Qx(t){return t.collectionGroup!==null}function Ho(t){const e=re(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new ut(at.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new wa(i,r))}),n.has(at.keyField().canonicalString())||e.ce.push(new wa(at.keyField(),r))}return e.ce}function Dn(t){const e=re(t);return e.le||(e.le=sk(e,Ho(t))),e.le}function sk(t,e){if(t.limitType==="F")return Tv(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new wa(s.field,i)});const n=t.endAt?new Ou(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ou(t.startAt.position,t.startAt.inclusive):null;return Tv(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function hf(t,e){const n=t.filters.concat([e]);return new qi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Lu(t,e,n){return new qi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function _c(t,e){return Wp(Dn(t),Dn(e))&&t.limitType===e.limitType}function Yx(t){return`${Gp(Dn(t))}|lt:${t.limitType}`}function Bs(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>Wx(s)).join(", ")}]`),yc(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>ki(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>ki(s)).join(",")),`Target(${r})`}(Dn(t))}; limitType=${t.limitType})`}function wc(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Y.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Ho(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const c=Cv(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,Ho(r),s)||r.endAt&&!function(o,a,l){const c=Cv(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,Ho(r),s))}(t,e)}function ik(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Xx(t){return(e,n)=>{let r=!1;for(const s of Ho(t)){const i=ok(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function ok(t,e,n){const r=t.field.isKeyField()?Y.comparator(e.key,n.key):function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?bi(l,c):te()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return te()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ds(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Ux(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ak=new je(Y.comparator);function ir(){return ak}const Jx=new je(Y.comparator);function bo(...t){let e=Jx;for(const n of t)e=e.insert(n.key,n);return e}function Zx(t){let e=Jx;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ps(){return Go()}function eE(){return Go()}function Go(){return new Hi(t=>t.toString(),(t,e)=>t.isEqual(e))}const lk=new je(Y.comparator),uk=new ut(Y.comparator);function oe(...t){let e=uk;for(const n of t)e=e.add(n);return e}const ck=new ut(me);function dk(){return ck}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vu(e)?"-0":e}}function tE(t){return{integerValue:""+t}}function hk(t,e){return zb(e)?tE(e):Kp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{constructor(){this._=void 0}}function fk(t,e,n){return t instanceof xa?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Bp(i)&&(i=qp(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof Ea?rE(t,e):t instanceof Sa?sE(t,e):function(s,i){const o=nE(s,i),a=Av(o)+Av(s.Pe);return uf(o)&&uf(s.Pe)?tE(a):Kp(s.serializer,a)}(t,e)}function pk(t,e,n){return t instanceof Ea?rE(t,e):t instanceof Sa?sE(t,e):n}function nE(t,e){return t instanceof Fu?function(r){return uf(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class xa extends xc{}class Ea extends xc{constructor(e){super(),this.elements=e}}function rE(t,e){const n=iE(e);for(const r of t.elements)n.some(s=>Mn(s,r))||n.push(r);return{arrayValue:{values:n}}}class Sa extends xc{constructor(e){super(),this.elements=e}}function sE(t,e){let n=iE(e);for(const r of t.elements)n=n.filter(s=>!Mn(s,r));return{arrayValue:{values:n}}}class Fu extends xc{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Av(t){return Le(t.integerValue||t.doubleValue)}function iE(t){return Hp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(e,n){this.field=e,this.transform=n}}function gk(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Ea&&s instanceof Ea||r instanceof Sa&&s instanceof Sa?Ni(r.elements,s.elements,Mn):r instanceof Fu&&s instanceof Fu?Mn(r.Pe,s.Pe):r instanceof xa&&s instanceof xa}(t.transform,e.transform)}class yk{constructor(e,n){this.version=e,this.transformResults=n}}class on{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new on}static exists(e){return new on(void 0,e)}static updateTime(e){return new on(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Zl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ec{}function oE(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Qp(t.key,on.none()):new La(t.key,t.data,on.none());{const n=t.data,r=jt.empty();let s=new ut(at.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new ns(t.key,r,new Gt(s.toArray()),on.none())}}function vk(t,e,n){t instanceof La?function(s,i,o){const a=s.value.clone(),l=bv(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof ns?function(s,i,o){if(!Zl(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=bv(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(aE(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Wo(t,e,n,r){return t instanceof La?function(i,o,a,l){if(!Zl(i.precondition,o))return a;const c=i.value.clone(),h=kv(i.fieldTransforms,l,o);return c.setAll(h),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof ns?function(i,o,a,l){if(!Zl(i.precondition,o))return a;const c=kv(i.fieldTransforms,l,o),h=o.data;return h.setAll(aE(i)),h.setAll(c),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(i,o,a){return Zl(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function _k(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=nE(r.transform,s||null);i!=null&&(n===null&&(n=jt.empty()),n.set(r.field,i))}return n||null}function Nv(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ni(r,s,(i,o)=>gk(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class La extends Ec{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ns extends Ec{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function aE(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function bv(t,e,n){const r=new Map;ve(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,pk(o,a,n[s]))}return r}function kv(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,fk(i,o,e))}return r}class Qp extends Ec{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class wk extends Ec{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xk{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&vk(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Wo(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Wo(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=eE();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=oE(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(ne.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),oe())}isEqual(e){return this.batchId===e.batchId&&Ni(this.mutations,e.mutations,(n,r)=>Nv(n,r))&&Ni(this.baseMutations,e.baseMutations,(n,r)=>Nv(n,r))}}class Yp{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){ve(e.mutations.length===r.length);let s=function(){return lk}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Yp(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ek{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sk{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $e,de;function Ck(t){switch(t){default:return te();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0}}function lE(t){if(t===void 0)return sr("GRPC error has no .code"),F.UNKNOWN;switch(t){case $e.OK:return F.OK;case $e.CANCELLED:return F.CANCELLED;case $e.UNKNOWN:return F.UNKNOWN;case $e.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case $e.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case $e.INTERNAL:return F.INTERNAL;case $e.UNAVAILABLE:return F.UNAVAILABLE;case $e.UNAUTHENTICATED:return F.UNAUTHENTICATED;case $e.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case $e.NOT_FOUND:return F.NOT_FOUND;case $e.ALREADY_EXISTS:return F.ALREADY_EXISTS;case $e.PERMISSION_DENIED:return F.PERMISSION_DENIED;case $e.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case $e.ABORTED:return F.ABORTED;case $e.OUT_OF_RANGE:return F.OUT_OF_RANGE;case $e.UNIMPLEMENTED:return F.UNIMPLEMENTED;case $e.DATA_LOSS:return F.DATA_LOSS;default:return te()}}(de=$e||($e={}))[de.OK=0]="OK",de[de.CANCELLED=1]="CANCELLED",de[de.UNKNOWN=2]="UNKNOWN",de[de.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",de[de.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",de[de.NOT_FOUND=5]="NOT_FOUND",de[de.ALREADY_EXISTS=6]="ALREADY_EXISTS",de[de.PERMISSION_DENIED=7]="PERMISSION_DENIED",de[de.UNAUTHENTICATED=16]="UNAUTHENTICATED",de[de.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",de[de.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",de[de.ABORTED=10]="ABORTED",de[de.OUT_OF_RANGE=11]="OUT_OF_RANGE",de[de.UNIMPLEMENTED=12]="UNIMPLEMENTED",de[de.INTERNAL=13]="INTERNAL",de[de.UNAVAILABLE=14]="UNAVAILABLE",de[de.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ik(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tk=new ys([4294967295,4294967295],0);function Pv(t){const e=Ik().encode(t),n=new Px;return n.update(e),new Uint8Array(n.digest())}function Dv(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ys([n,r],0),new ys([s,i],0)]}class Xp{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ko(`Invalid padding: ${n}`);if(r<0)throw new ko(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ko(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ko(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=ys.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(ys.fromNumber(r)));return s.compare(Tk)===1&&(s=new ys([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Pv(e),[r,s]=Dv(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Xp(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const n=Pv(e),[r,s]=Dv(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class ko extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Fa.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Sc(ne.min(),s,new je(me),ir(),oe())}}class Fa{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Fa(r,n,oe(),oe(),oe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class uE{constructor(e,n){this.targetId=e,this.me=n}}class cE{constructor(e,n,r=ht.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class jv{constructor(){this.fe=0,this.ge=Vv(),this.pe=ht.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=oe(),n=oe(),r=oe();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:te()}}),new Fa(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Vv()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ve(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Rk{constructor(e){this.Le=e,this.Be=new Map,this.ke=ir(),this.qe=Mv(),this.Qe=new je(me)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:te()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(df(i))if(r===0){const o=new Y(i.path);this.Ue(n,o,St.newNoDocument(o,ne.min()))}else ve(r===1);else{const o=this.Ye(n);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,c)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=Rs(r).toUint8Array()}catch(l){if(l instanceof $x)return Ai("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Xp(o,s,i)}catch(l){return Ai(l instanceof ko?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&df(a.target)){const l=new Y(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,St.newNoDocument(l,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=oe();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new Sc(e,n,this.Qe,this.ke,r);return this.ke=ir(),this.qe=Mv(),this.Qe=new je(me),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new jv,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new ut(me),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||K("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new jv),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Mv(){return new je(Y.comparator)}function Vv(){return new je(Y.comparator)}const Ak={asc:"ASCENDING",desc:"DESCENDING"},Nk={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},bk={and:"AND",or:"OR"};class kk{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ff(t,e){return t.useProto3Json||yc(e)?e:{value:e}}function Uu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function dE(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Pk(t,e){return Uu(t,e.toTimestamp())}function jn(t){return ve(!!t),ne.fromTimestamp(function(n){const r=Qr(n);return new Ke(r.seconds,r.nanos)}(t))}function Jp(t,e){return pf(t,e).canonicalString()}function pf(t,e){const n=function(s){return new Te(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function hE(t){const e=Te.fromString(t);return ve(yE(e)),e}function mf(t,e){return Jp(t.databaseId,e.path)}function Ld(t,e){const n=hE(e);if(n.get(1)!==t.databaseId.projectId)throw new G(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new G(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Y(pE(n))}function fE(t,e){return Jp(t.databaseId,e)}function Dk(t){const e=hE(t);return e.length===4?Te.emptyPath():pE(e)}function gf(t){return new Te(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function pE(t){return ve(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Ov(t,e,n){return{name:mf(t,e),fields:n.value.mapValue.fields}}function jk(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:te()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,h){return c.useProto3Json?(ve(h===void 0||typeof h=="string"),ht.fromBase64String(h||"")):(ve(h===void 0||h instanceof Buffer||h instanceof Uint8Array),ht.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const h=c.code===void 0?F.UNKNOWN:lE(c.code);return new G(h,c.message||"")}(o);n=new cE(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ld(t,r.document.name),i=jn(r.document.updateTime),o=r.document.createTime?jn(r.document.createTime):ne.min(),a=new jt({mapValue:{fields:r.document.fields}}),l=St.newFoundDocument(s,i,o,a),c=r.targetIds||[],h=r.removedTargetIds||[];n=new eu(c,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ld(t,r.document),i=r.readTime?jn(r.readTime):ne.min(),o=St.newNoDocument(s,i),a=r.removedTargetIds||[];n=new eu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ld(t,r.document),i=r.removedTargetIds||[];n=new eu([],i,s,null)}else{if(!("filter"in e))return te();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new Sk(s,i),a=r.targetId;n=new uE(a,o)}}return n}function Mk(t,e){let n;if(e instanceof La)n={update:Ov(t,e.key,e.value)};else if(e instanceof Qp)n={delete:mf(t,e.key)};else if(e instanceof ns)n={update:Ov(t,e.key,e.data),updateMask:qk(e.fieldMask)};else{if(!(e instanceof wk))return te();n={verify:mf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof xa)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ea)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Sa)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Fu)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw te()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:Pk(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:te()}(t,e.precondition)),n}function Vk(t,e){return t&&t.length>0?(ve(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?jn(s.updateTime):jn(i);return o.isEqual(ne.min())&&(o=jn(i)),new yk(o,s.transformResults||[])}(n,e))):[]}function Ok(t,e){return{documents:[fE(t,e.path)]}}function Lk(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=fE(t,s);const i=function(c){if(c.length!==0)return gE(En.create(c,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(h=>function(m){return{field:qs(m.field),direction:$k(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=ff(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:n,parent:s}}function Fk(t){let e=Dk(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){ve(r===1);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(p){const m=mE(p);return m instanceof En&&Hx(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(m=>function(v){return new wa(Hs(v.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(p){let m;return m=typeof p=="object"?p.value:p,yc(m)?null:m}(n.limit));let l=null;n.startAt&&(l=function(p){const m=!!p.before,g=p.values||[];return new Ou(g,m)}(n.startAt));let c=null;return n.endAt&&(c=function(p){const m=!p.before,g=p.values||[];return new Ou(g,m)}(n.endAt)),rk(e,s,o,i,a,"F",l,c)}function Uk(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return te()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function mE(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Hs(n.unaryFilter.field);return Be.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Hs(n.unaryFilter.field);return Be.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Hs(n.unaryFilter.field);return Be.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Hs(n.unaryFilter.field);return Be.create(o,"!=",{nullValue:"NULL_VALUE"});default:return te()}}(t):t.fieldFilter!==void 0?function(n){return Be.create(Hs(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return te()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return En.create(n.compositeFilter.filters.map(r=>mE(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return te()}}(n.compositeFilter.op))}(t):te()}function $k(t){return Ak[t]}function zk(t){return Nk[t]}function Bk(t){return bk[t]}function qs(t){return{fieldPath:t.canonicalString()}}function Hs(t){return at.fromServerFormat(t.fieldPath)}function gE(t){return t instanceof Be?function(n){if(n.op==="=="){if(Sv(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NAN"}};if(Ev(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Sv(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NOT_NAN"}};if(Ev(n.value))return{unaryFilter:{field:qs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qs(n.field),op:zk(n.op),value:n.value}}}(t):t instanceof En?function(n){const r=n.getFilters().map(s=>gE(s));return r.length===1?r[0]:{compositeFilter:{op:Bk(n.op),filters:r}}}(t):te()}function qk(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function yE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(e,n,r,s,i=ne.min(),o=ne.min(),a=ht.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new kr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new kr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new kr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new kr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(e){this.ct=e}}function Gk(t){const e=Fk({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Lu(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wk{constructor(){this.un=new Kk}addToCollectionParentIndex(e,n){return this.un.add(n),U.resolve()}getCollectionParents(e,n){return U.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return U.resolve()}deleteFieldIndex(e,n){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,n){return U.resolve()}getDocumentsMatchingTarget(e,n){return U.resolve(null)}getIndexType(e,n){return U.resolve(0)}getFieldIndexes(e,n){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,n){return U.resolve(Kr.min())}getMinOffsetFromCollectionGroup(e,n){return U.resolve(Kr.min())}updateCollectionGroup(e,n,r){return U.resolve()}updateIndexEntries(e,n){return U.resolve()}}class Kk{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new ut(Te.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new ut(Te.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Pi(0)}static kn(){return new Pi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qk{constructor(){this.changes=new Hi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,St.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?U.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yk{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xk{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Wo(r.mutation,s,Gt.empty(),Ke.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,oe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=oe()){const s=ps();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=bo();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=ps();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,oe()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=ir();const o=Go(),a=function(){return Go()}();return n.forEach((l,c)=>{const h=r.get(c.key);s.has(c.key)&&(h===void 0||h.mutation instanceof ns)?i=i.insert(c.key,c):h!==void 0?(o.set(c.key,h.mutation.getFieldMask()),Wo(h.mutation,c,h.mutation.getFieldMask(),Ke.now())):o.set(c.key,Gt.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,h)=>o.set(c,h)),n.forEach((c,h)=>{var p;return a.set(c,new Yk(h,(p=o.get(c))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Go();let s=new je((o,a)=>o-a),i=oe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let h=r.get(l)||Gt.empty();h=a.applyToLocalView(c,h),r.set(l,h);const p=(s.get(a.batchId)||oe()).add(l);s=s.insert(a.batchId,p)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,h=l.value,p=eE();h.forEach(m=>{if(!i.has(m)){const g=oE(n.get(m),r.get(m));g!==null&&p.set(m,g),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,p))}return U.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return Y.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Qx(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):U.resolve(ps());let a=-1,l=i;return o.next(c=>U.forEach(c,(h,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),i.get(h)?U.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{l=l.insert(h,m)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,oe())).next(h=>({batchId:a,changes:Zx(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Y(n)).next(r=>{let s=bo();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=bo();return this.indexManager.getCollectionParents(e,i).next(a=>U.forEach(a,l=>{const c=function(p,m){return new qi(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(h=>{h.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((l,c)=>{const h=c.getKey();o.get(h)===null&&(o=o.insert(h,St.newInvalidDocument(h)))});let a=bo();return o.forEach((l,c)=>{const h=i.get(l);h!==void 0&&Wo(h.mutation,c,Gt.empty(),Ke.now()),wc(n,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jk{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return U.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:jn(s.createTime)}}(n)),U.resolve()}getNamedQuery(e,n){return U.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:Gk(s.bundledQuery),readTime:jn(s.readTime)}}(n)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zk{constructor(){this.overlays=new je(Y.comparator),this.Ir=new Map}getOverlay(e,n){return U.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ps();return U.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),U.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),U.resolve()}getOverlaysForCollection(e,n,r){const s=ps(),i=n.length+1,o=new Y(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return U.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new je((c,h)=>c-h);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let h=i.get(c.largestBatchId);h===null&&(h=ps(),i=i.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const a=ps(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,h)=>a.set(c,h)),!(a.size()>=s)););return U.resolve(a)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Ek(n,r));let i=this.Ir.get(n);i===void 0&&(i=oe(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{constructor(){this.sessionToken=ht.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp{constructor(){this.Tr=new ut(Ze.Er),this.dr=new ut(Ze.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Ze(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Ze(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new Y(new Te([])),r=new Ze(n,e),s=new Ze(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new Y(new Te([])),r=new Ze(n,e),s=new Ze(n,e+1);let i=oe();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Ze(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ze{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return Y.comparator(e.key,n.key)||me(e.wr,n.wr)}static Ar(e,n){return me(e.wr,n.wr)||Y.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new ut(Ze.Er)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new xk(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.br=this.br.add(new Ze(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return U.resolve(o)}lookupMutationBatch(e,n){return U.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return U.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ze(n,0),s=new Ze(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const a=this.Dr(o.wr);i.push(a)}),U.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ut(me);return n.forEach(s=>{const i=new Ze(s,0),o=new Ze(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],a=>{r=r.add(a.wr)})}),U.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;Y.isDocumentKey(i)||(i=i.child(""));const o=new Ze(new Y(i),0);let a=new ut(me);return this.br.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.wr)),!0)},o),U.resolve(this.Cr(a))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){ve(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return U.forEach(n.mutations,s=>{const i=new Ze(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Ze(n,0),s=this.br.firstAfterOrEqual(r);return U.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(e){this.Mr=e,this.docs=function(){return new je(Y.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return U.resolve(r?r.document.mutableCopy():St.newInvalidDocument(n))}getEntries(e,n){let r=ir();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():St.newInvalidDocument(s))}),U.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=ir();const o=n.path,a=new Y(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||Lb(Ob(h),r)<=0||(s.has(h.key)||wc(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return U.resolve(i)}getAllFromCollectionGroup(e,n,r,s){te()}Or(e,n){return U.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new rP(this)}getSize(e){return U.resolve(this.size)}}class rP extends Qk{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),U.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(e){this.persistence=e,this.Nr=new Hi(n=>Gp(n),Wp),this.lastRemoteSnapshotVersion=ne.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Zp,this.targetCount=0,this.kr=Pi.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),U.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Pi(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,U.resolve()}updateTargetData(e,n){return this.Kn(n),U.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),U.waitFor(i).next(()=>s)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return U.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),U.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),U.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),U.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return U.resolve(r)}containsKey(e,n){return U.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(e,n){this.qr={},this.overlays={},this.Qr=new zp(0),this.Kr=!1,this.Kr=!0,this.$r=new eP,this.referenceDelegate=e(this),this.Ur=new sP(this),this.indexManager=new Wk,this.remoteDocumentCache=function(s){return new nP(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new Hk(n),this.Gr=new Jk(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Zk,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new tP(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){K("MemoryPersistence","Starting transaction:",e);const s=new oP(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return U.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class oP extends Ub{constructor(e){super(),this.currentSequenceNumber=e}}class em{constructor(e){this.persistence=e,this.Jr=new Zp,this.Yr=null}static Zr(e){return new em(e)}get Xr(){if(this.Yr)return this.Yr;throw te()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),U.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),U.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.Xr,r=>{const s=Y.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,ne.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return U.or([()=>U.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=oe(),s=oe();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new tm(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return WR()?8:$b(Tt())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new aP;return this.Xi(e,n,o).next(a=>{if(i.result=a,this.zi)return this.es(e,n,o,a.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(wo()<=le.DEBUG&&K("QueryEngine","SDK will not create cache indexes for query:",Bs(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),U.resolve()):(wo()<=le.DEBUG&&K("QueryEngine","Query:",Bs(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(wo()<=le.DEBUG&&K("QueryEngine","The SDK decides to create cache indexes for query:",Bs(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Dn(n))):U.resolve())}Yi(e,n){if(Rv(n))return U.resolve(null);let r=Dn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Lu(n,null,"F"),r=Dn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=oe(...i);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.ts(n,a);return this.ns(n,c,o,l.readTime)?this.Yi(e,Lu(n,null,"F")):this.rs(e,c,n,l)}))})))}Zi(e,n,r,s){return Rv(n)||s.isEqual(ne.min())?U.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?U.resolve(null):(wo()<=le.DEBUG&&K("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Bs(n)),this.rs(e,o,n,Vb(s,-1)).next(a=>a))})}ts(e,n){let r=new ut(Xx(e));return n.forEach((s,i)=>{wc(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return wo()<=le.DEBUG&&K("QueryEngine","Using full collection scan to execute query:",Bs(n)),this.Ji.getDocumentsMatchingQuery(e,n,Kr.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uP{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new je(me),this._s=new Hi(i=>Gp(i),Wp),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Xk(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function cP(t,e,n,r){return new uP(t,e,n,r)}async function vE(t,e){const n=re(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=oe();for(const c of s){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of i){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(r,l).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:a}))})})}function dP(t,e){const n=re(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,h){const p=c.batch,m=p.keys();let g=U.resolve();return m.forEach(v=>{g=g.next(()=>h.getEntry(l,v)).next(E=>{const N=c.docVersions.get(v);ve(N!==null),E.version.compareTo(N)<0&&(p.applyToRemoteDocument(E,c),E.isValidDocument()&&(E.setReadTime(c.commitVersion),h.addEntry(E)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,p))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=oe();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function _E(t){const e=re(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function hP(t,e){const n=re(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const a=[];e.targetChanges.forEach((h,p)=>{const m=s.get(p);if(!m)return;a.push(n.Ur.removeMatchingKeys(i,h.removedDocuments,p).next(()=>n.Ur.addMatchingKeys(i,h.addedDocuments,p)));let g=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(p)!==null?g=g.withResumeToken(ht.EMPTY_BYTE_STRING,ne.min()).withLastLimboFreeSnapshotVersion(ne.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,r)),s=s.insert(p,g),function(E,N,S){return E.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=3e8?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(m,g,h)&&a.push(n.Ur.updateTargetData(i,g))});let l=ir(),c=oe();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(fP(i,o,e.documentUpdates).next(h=>{l=h.Ps,c=h.Is})),!r.isEqual(ne.min())){const h=n.Ur.getLastRemoteSnapshotVersion(i).next(p=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return U.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(n.os=s,i))}function fP(t,e,n){let r=oe(),s=oe();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=ir();return n.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(ne.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):K("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Ps:o,Is:s}})}function pP(t,e){const n=re(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function mP(t,e){const n=re(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,U.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new kr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function yf(t,e,n){const r=re(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Oa(o))throw o;K("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Lv(t,e,n){const r=re(t);let s=ne.min(),i=oe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,h){const p=re(l),m=p._s.get(h);return m!==void 0?U.resolve(p.os.get(m)):p.Ur.getTargetData(c,h)}(r,o,Dn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:ne.min(),n?i:oe())).next(a=>(gP(r,ik(e),a),{documents:a,Ts:i})))}function gP(t,e,n){let r=t.us.get(e)||ne.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class Fv{constructor(){this.activeTargetIds=dk()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class yP{constructor(){this.so=new Fv,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Fv,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){K("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){K("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nl=null;function Fd(){return Nl===null?Nl=function(){return 268435456+Math.round(2147483648*Math.random())}():Nl++,"0x"+Nl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _P={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _t="WebChannelConnection";class xP extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const a=Fd(),l=this.xo(n,r.toUriEncodedString());K("RestConnection",`Sending RPC '${n}' ${a}:`,l,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,i,o),this.No(n,l,c,s).then(h=>(K("RestConnection",`Received RPC '${n}' ${a}: `,h),h),h=>{throw Ai("RestConnection",`RPC '${n}' ${a} failed with error: `,h,"url: ",l,"request:",s),h})}Lo(n,r,s,i,o,a){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Bi}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=_P[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=Fd();return new Promise((o,a)=>{const l=new Dx;l.setWithCredentials(!0),l.listenOnce(jx.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Xl.NO_ERROR:const h=l.getResponseJson();K(_t,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),o(h);break;case Xl.TIMEOUT:K(_t,`RPC '${e}' ${i} timed out`),a(new G(F.DEADLINE_EXCEEDED,"Request time out"));break;case Xl.HTTP_ERROR:const p=l.getStatus();if(K(_t,`RPC '${e}' ${i} failed with status:`,p,"response text:",l.getResponseText()),p>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const g=m==null?void 0:m.error;if(g&&g.status&&g.message){const v=function(N){const S=N.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(S)>=0?S:F.UNKNOWN}(g.status);a(new G(v,g.message))}else a(new G(F.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new G(F.UNAVAILABLE,"Connection failed."));break;default:te()}}finally{K(_t,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);K(_t,`RPC '${e}' ${i} sending request:`,s),l.send(n,"POST",c,r,15)})}Bo(e,n,r){const s=Fd(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Ox(),a=Vx(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const h=i.join("");K(_t,`Creating RPC '${e}' stream ${s}: ${h}`,l);const p=o.createWebChannel(h,l);let m=!1,g=!1;const v=new wP({Io:N=>{g?K(_t,`Not sending because RPC '${e}' stream ${s} is closed:`,N):(m||(K(_t,`Opening RPC '${e}' stream ${s} transport.`),p.open(),m=!0),K(_t,`RPC '${e}' stream ${s} sending:`,N),p.send(N))},To:()=>p.close()}),E=(N,S,_)=>{N.listen(S,x=>{try{_(x)}catch(D){setTimeout(()=>{throw D},0)}})};return E(p,No.EventType.OPEN,()=>{g||(K(_t,`RPC '${e}' stream ${s} transport opened.`),v.yo())}),E(p,No.EventType.CLOSE,()=>{g||(g=!0,K(_t,`RPC '${e}' stream ${s} transport closed`),v.So())}),E(p,No.EventType.ERROR,N=>{g||(g=!0,Ai(_t,`RPC '${e}' stream ${s} transport errored:`,N),v.So(new G(F.UNAVAILABLE,"The operation could not be completed")))}),E(p,No.EventType.MESSAGE,N=>{var S;if(!g){const _=N.data[0];ve(!!_);const x=_,D=x.error||((S=x[0])===null||S===void 0?void 0:S.error);if(D){K(_t,`RPC '${e}' stream ${s} received error:`,D);const O=D.status;let j=function(C){const T=$e[C];if(T!==void 0)return lE(T)}(O),R=D.message;j===void 0&&(j=F.INTERNAL,R="Unknown error status: "+O+" with message "+D.message),g=!0,v.So(new G(j,R)),p.close()}else K(_t,`RPC '${e}' stream ${s} received:`,_),v.bo(_)}}),E(a,Mx.STAT_EVENT,N=>{N.stat===af.PROXY?K(_t,`RPC '${e}' stream ${s} detected buffering proxy`):N.stat===af.NOPROXY&&K(_t,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{v.wo()},0),v}}function Ud(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cc(t){return new kk(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&K("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xE{constructor(e,n,r,s,i,o,a,l){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new wE(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===F.RESOURCE_EXHAUSTED?(sr(n.toString()),sr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new G(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return K("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(K("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class EP extends xE{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=jk(this.serializer,e),r=function(i){if(!("targetChange"in i))return ne.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ne.min():o.readTime?jn(o.readTime):ne.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=gf(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=df(l)?{documents:Ok(i,l)}:{query:Lk(i,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=dE(i,o.resumeToken);const c=ff(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(ne.min())>0){a.readTime=Uu(i,o.snapshotVersion.toTimestamp());const c=ff(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=Uk(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=gf(this.serializer),n.removeTarget=e,this.a_(n)}}class SP extends xE{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return ve(!!e.streamToken),this.lastStreamToken=e.streamToken,ve(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ve(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=Vk(e.writeResults,e.commitTime),r=jn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=gf(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Mk(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new G(F.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,pf(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new G(F.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,pf(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new G(F.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class IP{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(sr(n),this.D_=!1):K("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{js(this)&&(K("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=re(l);c.L_.add(4),await Ua(c),c.q_.set("Unknown"),c.L_.delete(4),await Ic(c)}(this))})}),this.q_=new IP(r,s)}}async function Ic(t){if(js(t))for(const e of t.B_)await e(!0)}async function Ua(t){for(const e of t.B_)await e(!1)}function EE(t,e){const n=re(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),im(n)?sm(n):Gi(n).r_()&&rm(n,e))}function nm(t,e){const n=re(t),r=Gi(n);n.N_.delete(e),r.r_()&&SE(n,e),n.N_.size===0&&(r.r_()?r.o_():js(n)&&n.q_.set("Unknown"))}function rm(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ne.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Gi(t).A_(e)}function SE(t,e){t.Q_.xe(e),Gi(t).R_(e)}function sm(t){t.Q_=new Rk({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Gi(t).start(),t.q_.v_()}function im(t){return js(t)&&!Gi(t).n_()&&t.N_.size>0}function js(t){return re(t).L_.size===0}function CE(t){t.Q_=void 0}async function RP(t){t.q_.set("Online")}async function AP(t){t.N_.forEach((e,n)=>{rm(t,e)})}async function NP(t,e){CE(t),im(t)?(t.q_.M_(e),sm(t)):t.q_.set("Unknown")}async function bP(t,e,n){if(t.q_.set("Online"),e instanceof cE&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.N_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.N_.delete(a),s.Q_.removeTarget(a))}(t,e)}catch(r){K("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await $u(t,r)}else if(e instanceof eu?t.Q_.Ke(e):e instanceof uE?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ne.min()))try{const r=await _E(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.Q_.rt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=i.N_.get(c);h&&i.N_.set(c,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const h=i.N_.get(l);if(!h)return;i.N_.set(l,h.withResumeToken(ht.EMPTY_BYTE_STRING,h.snapshotVersion)),SE(i,l);const p=new kr(h.target,l,c,h.sequenceNumber);rm(i,p)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){K("RemoteStore","Failed to raise snapshot:",r),await $u(t,r)}}async function $u(t,e,n){if(!Oa(e))throw e;t.L_.add(1),await Ua(t),t.q_.set("Offline"),n||(n=()=>_E(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{K("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Ic(t)})}function IE(t,e){return e().catch(n=>$u(t,n,e))}async function Tc(t){const e=re(t),n=Yr(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;kP(e);)try{const s=await pP(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,PP(e,s)}catch(s){await $u(e,s)}TE(e)&&RE(e)}function kP(t){return js(t)&&t.O_.length<10}function PP(t,e){t.O_.push(e);const n=Yr(t);n.r_()&&n.V_&&n.m_(e.mutations)}function TE(t){return js(t)&&!Yr(t).n_()&&t.O_.length>0}function RE(t){Yr(t).start()}async function DP(t){Yr(t).p_()}async function jP(t){const e=Yr(t);for(const n of t.O_)e.m_(n.mutations)}async function MP(t,e,n){const r=t.O_.shift(),s=Yp.from(r,e,n);await IE(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Tc(t)}async function VP(t,e){e&&Yr(t).V_&&await async function(r,s){if(function(o){return Ck(o)&&o!==F.ABORTED}(s.code)){const i=r.O_.shift();Yr(r).s_(),await IE(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Tc(r)}}(t,e),TE(t)&&RE(t)}async function $v(t,e){const n=re(t);n.asyncQueue.verifyOperationInProgress(),K("RemoteStore","RemoteStore received new credentials");const r=js(n);n.L_.add(3),await Ua(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Ic(n)}async function OP(t,e){const n=re(t);e?(n.L_.delete(2),await Ic(n)):e||(n.L_.add(2),await Ua(n),n.q_.set("Unknown"))}function Gi(t){return t.K_||(t.K_=function(n,r,s){const i=re(n);return i.w_(),new EP(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:RP.bind(null,t),Ro:AP.bind(null,t),mo:NP.bind(null,t),d_:bP.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),im(t)?sm(t):t.q_.set("Unknown")):(await t.K_.stop(),CE(t))})),t.K_}function Yr(t){return t.U_||(t.U_=function(n,r,s){const i=re(n);return i.w_(),new SP(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:DP.bind(null,t),mo:VP.bind(null,t),f_:jP.bind(null,t),g_:MP.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Tc(t)):(await t.U_.stop(),t.O_.length>0&&(K("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Xn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new om(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new G(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function am(t,e){if(sr("AsyncQueue",`${e}: ${t}`),Oa(t))return new G(F.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e){this.comparator=e?(n,r)=>e(n,r)||Y.comparator(n.key,r.key):(n,r)=>Y.comparator(n.key,r.key),this.keyedMap=bo(),this.sortedSet=new je(this.comparator)}static emptySet(e){return new mi(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof mi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new mi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(){this.W_=new je(Y.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):te():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Di{constructor(e,n,r,s,i,o,a,l,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Di(e,n,mi.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&_c(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class FP{constructor(){this.queries=Bv(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=re(n),i=s.queries;s.queries=Bv(),i.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})})(this,new G(F.ABORTED,"Firestore shutting down"))}}function Bv(){return new Hi(t=>Yx(t),_c)}async function lm(t,e){const n=re(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new LP,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=am(o,`Initialization of query '${Bs(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&cm(n)}async function um(t,e){const n=re(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function UP(t,e){const n=re(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.j_)a.X_(s)&&(r=!0);o.z_=s}}r&&cm(n)}function $P(t,e,n){const r=re(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function cm(t){t.Y_.forEach(e=>{e.next()})}var vf,qv;(qv=vf||(vf={})).ea="default",qv.Cache="cache";class dm{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Di(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Di.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==vf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{constructor(e){this.key=e}}class NE{constructor(e){this.key=e}}class zP{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=oe(),this.mutatedKeys=oe(),this.Aa=Xx(e),this.Ra=new mi(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new zv,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,p)=>{const m=s.get(h),g=wc(this.query,p)?p:null,v=!!m&&this.mutatedKeys.has(m.key),E=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let N=!1;m&&g?m.data.isEqual(g.data)?v!==E&&(r.track({type:3,doc:g}),N=!0):this.ga(m,g)||(r.track({type:2,doc:g}),N=!0,(l&&this.Aa(g,l)>0||c&&this.Aa(g,c)<0)&&(a=!0)):!m&&g?(r.track({type:0,doc:g}),N=!0):m&&!g&&(r.track({type:1,doc:m}),N=!0,(l||c)&&(a=!0)),N&&(g?(o=o.add(g),i=E?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{Ra:o,fa:r,ns:a,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((h,p)=>function(g,v){const E=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return te()}};return E(g)-E(v)}(h.type,p.type)||this.Aa(h.doc,p.doc)),this.pa(r),s=s!=null&&s;const a=n&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,c=l!==this.Ea;return this.Ea=l,o.length!==0||c?{snapshot:new Di(this.query,e.Ra,i,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new zv,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=oe(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new NE(r))}),this.da.forEach(r=>{e.has(r)||n.push(new AE(r))}),n}ba(e){this.Ta=e.Ts,this.da=oe();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Di.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class BP{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class qP{constructor(e){this.key=e,this.va=!1}}class HP{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Hi(a=>Yx(a),_c),this.Ma=new Map,this.xa=new Set,this.Oa=new je(Y.comparator),this.Na=new Map,this.La=new Zp,this.Ba={},this.ka=new Map,this.qa=Pi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function GP(t,e,n=!0){const r=ME(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await bE(r,e,n,!0),s}async function WP(t,e){const n=ME(t);await bE(n,e,!0,!1)}async function bE(t,e,n,r){const s=await mP(t.localStore,Dn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await KP(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&EE(t.remoteStore,s),a}async function KP(t,e,n,r,s){t.Ka=(p,m,g)=>async function(E,N,S,_){let x=N.view.ma(S);x.ns&&(x=await Lv(E.localStore,N.query,!1).then(({documents:R})=>N.view.ma(R,x)));const D=_&&_.targetChanges.get(N.targetId),O=_&&_.targetMismatches.get(N.targetId)!=null,j=N.view.applyChanges(x,E.isPrimaryClient,D,O);return Gv(E,N.targetId,j.wa),j.snapshot}(t,p,m,g);const i=await Lv(t.localStore,e,!0),o=new zP(e,i.Ts),a=o.ma(i.documents),l=Fa.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),c=o.applyChanges(a,t.isPrimaryClient,l);Gv(t,n,c.wa);const h=new BP(e,n,o);return t.Fa.set(e,h),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),c.snapshot}async function QP(t,e,n){const r=re(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!_c(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await yf(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&nm(r.remoteStore,s.targetId),_f(r,s.targetId)}).catch(Va)):(_f(r,s.targetId),await yf(r.localStore,s.targetId,!0))}async function YP(t,e){const n=re(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),nm(n.remoteStore,r.targetId))}async function XP(t,e,n){const r=s2(t);try{const s=await function(o,a){const l=re(o),c=Ke.now(),h=a.reduce((g,v)=>g.add(v.key),oe());let p,m;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let v=ir(),E=oe();return l.cs.getEntries(g,h).next(N=>{v=N,v.forEach((S,_)=>{_.isValidDocument()||(E=E.add(S))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,v)).next(N=>{p=N;const S=[];for(const _ of a){const x=_k(_,p.get(_.key).overlayedDocument);x!=null&&S.push(new ns(_.key,x,zx(x.value.mapValue),on.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,S,a)}).next(N=>{m=N;const S=N.applyToLocalDocumentSet(p,E);return l.documentOverlayCache.saveOverlays(g,N.batchId,S)})}).then(()=>({batchId:m.batchId,changes:Zx(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let c=o.Ba[o.currentUser.toKey()];c||(c=new je(me)),c=c.insert(a,l),o.Ba[o.currentUser.toKey()]=c}(r,s.batchId,n),await $a(r,s.changes),await Tc(r.remoteStore)}catch(s){const i=am(s,"Failed to persist write");n.reject(i)}}async function kE(t,e){const n=re(t);try{const r=await hP(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(ve(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?ve(o.va):s.removedDocuments.size>0&&(ve(o.va),o.va=!1))}),await $a(n,r,e)}catch(r){await Va(r)}}function Hv(t,e,n){const r=re(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const a=o.view.Z_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=re(o);l.onlineState=a;let c=!1;l.queries.forEach((h,p)=>{for(const m of p.j_)m.Z_(a)&&(c=!0)}),c&&cm(l)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function JP(t,e,n){const r=re(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new je(Y.comparator);o=o.insert(i,St.newNoDocument(i,ne.min()));const a=oe().add(i),l=new Sc(ne.min(),new Map,new je(me),o,a);await kE(r,l),r.Oa=r.Oa.remove(i),r.Na.delete(e),hm(r)}else await yf(r.localStore,e,!1).then(()=>_f(r,e,n)).catch(Va)}async function ZP(t,e){const n=re(t),r=e.batch.batchId;try{const s=await dP(n.localStore,e);DE(n,r,null),PE(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await $a(n,s)}catch(s){await Va(s)}}async function e2(t,e,n){const r=re(t);try{const s=await function(o,a){const l=re(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let h;return l.mutationQueue.lookupMutationBatch(c,a).next(p=>(ve(p!==null),h=p.keys(),l.mutationQueue.removeMutationBatch(c,p))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h)).next(()=>l.localDocuments.getDocuments(c,h))})}(r.localStore,e);DE(r,e,n),PE(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await $a(r,s)}catch(s){await Va(s)}}function PE(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function DE(t,e,n){const r=re(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function _f(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||jE(t,r)})}function jE(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(nm(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),hm(t))}function Gv(t,e,n){for(const r of n)r instanceof AE?(t.La.addReference(r.key,e),t2(t,r)):r instanceof NE?(K("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||jE(t,r.key)):te()}function t2(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(K("SyncEngine","New document in limbo: "+n),t.xa.add(r),hm(t))}function hm(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new Y(Te.fromString(e)),r=t.qa.next();t.Na.set(r,new qP(n)),t.Oa=t.Oa.insert(n,r),EE(t.remoteStore,new kr(Dn(vc(n.path)),r,"TargetPurposeLimboResolution",zp.oe))}}async function $a(t,e,n){const r=re(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,n).then(c=>{var h;if((c||n)&&r.isPrimaryClient){const p=c?!c.fromCache:(h=n==null?void 0:n.targetChanges.get(l.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(c){s.push(c);const p=tm.Wi(l.targetId,c);i.push(p)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(l,c){const h=re(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>U.forEach(c,m=>U.forEach(m.$i,g=>h.persistence.referenceDelegate.addReference(p,m.targetId,g)).next(()=>U.forEach(m.Ui,g=>h.persistence.referenceDelegate.removeReference(p,m.targetId,g)))))}catch(p){if(!Oa(p))throw p;K("LocalStore","Failed to update sequence numbers: "+p)}for(const p of c){const m=p.targetId;if(!p.fromCache){const g=h.os.get(m),v=g.snapshotVersion,E=g.withLastLimboFreeSnapshotVersion(v);h.os=h.os.insert(m,E)}}}(r.localStore,i))}async function n2(t,e){const n=re(t);if(!n.currentUser.isEqual(e)){K("SyncEngine","User change. New user:",e.toKey());const r=await vE(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(a=>{a.forEach(l=>{l.reject(new G(F.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await $a(n,r.hs)}}function r2(t,e){const n=re(t),r=n.Na.get(e);if(r&&r.va)return oe().add(r.key);{let s=oe();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const a=n.Fa.get(o);s=s.unionWith(a.view.Va)}return s}}function ME(t){const e=re(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=kE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=r2.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=JP.bind(null,e),e.Ca.d_=UP.bind(null,e.eventManager),e.Ca.$a=$P.bind(null,e.eventManager),e}function s2(t){const e=re(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ZP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=e2.bind(null,e),e}class zu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Cc(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return cP(this.persistence,new lP,e.initialUser,this.serializer)}Ga(e){return new iP(em.Zr,this.serializer)}Wa(e){return new yP}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}zu.provider={build:()=>new zu};class wf{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Hv(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=n2.bind(null,this.syncEngine),await OP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new FP}()}createDatastore(e){const n=Cc(e.databaseInfo.databaseId),r=function(i){return new xP(i)}(e.databaseInfo);return function(i,o,a,l){return new CP(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new TP(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Hv(this.syncEngine,n,0),function(){return Uv.D()?new Uv:new vP}())}createSyncEngine(e,n){return function(s,i,o,a,l,c,h){const p=new HP(s,i,o,a,l,c);return h&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=re(s);K("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Ua(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}wf.provider={build:()=>new wf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):sr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=xt.UNAUTHENTICATED,this.clientId=Fx.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{K("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(K("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Xn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=am(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function $d(t,e){t.asyncQueue.verifyOperationInProgress(),K("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await vE(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Wv(t,e){t.asyncQueue.verifyOperationInProgress();const n=await o2(t);K("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>$v(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>$v(e.remoteStore,s)),t._onlineComponents=e}async function o2(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){K("FirestoreClient","Using user provided OfflineComponentProvider");try{await $d(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===F.FAILED_PRECONDITION||s.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Ai("Error using user provided cache. Falling back to memory cache: "+n),await $d(t,new zu)}}else K("FirestoreClient","Using default OfflineComponentProvider"),await $d(t,new zu);return t._offlineComponents}async function VE(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(K("FirestoreClient","Using user provided OnlineComponentProvider"),await Wv(t,t._uninitializedComponentsProvider._online)):(K("FirestoreClient","Using default OnlineComponentProvider"),await Wv(t,new wf))),t._onlineComponents}function a2(t){return VE(t).then(e=>e.syncEngine)}async function Bu(t){const e=await VE(t),n=e.eventManager;return n.onListen=GP.bind(null,e.syncEngine),n.onUnlisten=QP.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=WP.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=YP.bind(null,e.syncEngine),n}function l2(t,e,n={}){const r=new Xn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const h=new fm({next:m=>{h.Za(),o.enqueueAndForget(()=>um(i,p));const g=m.docs.has(a);!g&&m.fromCache?c.reject(new G(F.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&m.fromCache&&l&&l.source==="server"?c.reject(new G(F.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),p=new dm(vc(a.path),h,{includeMetadataChanges:!0,_a:!0});return lm(i,p)}(await Bu(t),t.asyncQueue,e,n,r)),r.promise}function u2(t,e,n={}){const r=new Xn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const h=new fm({next:m=>{h.Za(),o.enqueueAndForget(()=>um(i,p)),m.fromCache&&l.source==="server"?c.reject(new G(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),p=new dm(a,h,{includeMetadataChanges:!0,_a:!0});return lm(i,p)}(await Bu(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OE(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kv=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LE(t,e,n){if(!n)throw new G(F.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function c2(t,e,n,r){if(e===!0&&r===!0)throw new G(F.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Qv(t){if(!Y.isDocumentKey(t))throw new G(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Yv(t){if(Y.isDocumentKey(t))throw new G(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Rc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":te()}function Ft(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new G(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Rc(t);throw new G(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xv{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new G(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new G(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}c2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=OE((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ac{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Xv({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new G(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new G(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Xv(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Rb;switch(r.type){case"firstParty":return new kb(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new G(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Kv.get(n);r&&(K("ComponentProvider","Removing Datastore"),Kv.delete(n),r.terminate())}(this),Promise.resolve()}}function d2(t,e,n,r={}){var s;const i=(t=Ft(t,Ac))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Ai("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=xt.MOCK_USER;else{a=UR(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new G(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new xt(c)}t._authCredentials=new Ab(new Lx(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new dr(this.firestore,e,this._query)}}class Ct{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new qr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ct(this.firestore,e,this._key)}}class qr extends dr{constructor(e,n,r){super(e,n,vc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ct(this.firestore,null,new Y(e))}withConverter(e){return new qr(this.firestore,e,this._path)}}function tt(t,e,...n){if(t=De(t),LE("collection","path",e),t instanceof Ac){const r=Te.fromString(e,...n);return Yv(r),new qr(t,null,r)}{if(!(t instanceof Ct||t instanceof qr))throw new G(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Te.fromString(e,...n));return Yv(r),new qr(t.firestore,null,r)}}function nt(t,e,...n){if(t=De(t),arguments.length===1&&(e=Fx.newId()),LE("doc","path",e),t instanceof Ac){const r=Te.fromString(e,...n);return Qv(r),new Ct(t,null,new Y(r))}{if(!(t instanceof Ct||t instanceof qr))throw new G(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Te.fromString(e,...n));return Qv(r),new Ct(t.firestore,t instanceof qr?t.converter:null,new Y(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new wE(this,"async_queue_retry"),this.Vu=()=>{const r=Ud();r&&K("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Ud();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Ud();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Xn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Oa(e))throw e;K("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw sr("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=om.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&te()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function Zv(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class or extends Ac{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Jv,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Jv(e),this._firestoreClient=void 0,await e}}}function h2(t,e){const n=typeof t=="object"?t:kp(),r=typeof t=="string"?t:"(default)",s=fc(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=q0("firestore");i&&d2(s,...i)}return s}function Nc(t){if(t._terminated)throw new G(F.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||f2(t),t._firestoreClient}function f2(t){var e,n,r;const s=t._freezeSettings(),i=function(a,l,c,h){return new qb(a,l,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,OE(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new i2(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ji(ht.fromBase64String(e))}catch(n){throw new G(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ji(ht.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new G(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new at(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new G(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new G(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return me(this._lat,e._lat)||me(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mm{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p2=/^__.*__$/;class m2{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ns(e,this.data,this.fieldMask,n,this.fieldTransforms):new La(e,this.data,n,this.fieldTransforms)}}class FE{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ns(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function UE(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw te()}}class gm{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new gm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return qu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(UE(this.Cu)&&p2.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class g2{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Cc(e)}Qu(e,n,r,s=!1){return new gm({Cu:e,methodName:n,qu:r,path:at.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Pc(t){const e=t._freezeSettings(),n=Cc(t._databaseId);return new g2(t._databaseId,!!e.ignoreUndefinedProperties,n)}function $E(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);vm("Data must be an object, but it was:",o,r);const a=zE(r,o);let l,c;if(i.merge)l=new Gt(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const p of i.mergeFields){const m=xf(e,p,n);if(!o.contains(m))throw new G(F.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);qE(h,m)||h.push(m)}l=new Gt(h),c=o.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,c=o.fieldTransforms;return new m2(new jt(a),l,c)}class Dc extends kc{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Dc}}class ym extends kc{_toFieldTransform(e){return new mk(e.path,new xa)}isEqual(e){return e instanceof ym}}function y2(t,e,n,r){const s=t.Qu(1,e,n);vm("Data must be an object, but it was:",s,r);const i=[],o=jt.empty();Ds(r,(l,c)=>{const h=_m(e,l,n);c=De(c);const p=s.Nu(h);if(c instanceof Dc)i.push(h);else{const m=za(c,p);m!=null&&(i.push(h),o.set(h,m))}});const a=new Gt(i);return new FE(o,a,s.fieldTransforms)}function v2(t,e,n,r,s,i){const o=t.Qu(1,e,n),a=[xf(e,r,n)],l=[s];if(i.length%2!=0)throw new G(F.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)a.push(xf(e,i[m])),l.push(i[m+1]);const c=[],h=jt.empty();for(let m=a.length-1;m>=0;--m)if(!qE(c,a[m])){const g=a[m];let v=l[m];v=De(v);const E=o.Nu(g);if(v instanceof Dc)c.push(g);else{const N=za(v,E);N!=null&&(c.push(g),h.set(g,N))}}const p=new Gt(c);return new FE(h,p,o.fieldTransforms)}function _2(t,e,n,r=!1){return za(n,t.Qu(r?4:3,e))}function za(t,e){if(BE(t=De(t)))return vm("Unsupported field value:",e,t),zE(t,e);if(t instanceof kc)return function(r,s){if(!UE(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=za(a,s.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=De(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return hk(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Ke.fromDate(r);return{timestampValue:Uu(s.serializer,i)}}if(r instanceof Ke){const i=new Ke(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Uu(s.serializer,i)}}if(r instanceof pm)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ji)return{bytesValue:dE(s.serializer,r._byteString)};if(r instanceof Ct){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Jp(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof mm)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return Kp(a.serializer,l)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Rc(r)}`)}(t,e)}function zE(t,e){const n={};return Ux(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ds(t,(r,s)=>{const i=za(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function BE(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ke||t instanceof pm||t instanceof ji||t instanceof Ct||t instanceof kc||t instanceof mm)}function vm(t,e,n){if(!BE(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Rc(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function xf(t,e,n){if((e=De(e))instanceof bc)return e._internalPath;if(typeof e=="string")return _m(t,e);throw qu("Field path arguments must be of type string or ",t,!1,void 0,n)}const w2=new RegExp("[~\\*/\\[\\]]");function _m(t,e,n){if(e.search(w2)>=0)throw qu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new bc(...e.split("."))._internalPath}catch{throw qu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function qu(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new G(F.INVALID_ARGUMENT,a+t+l)}function qE(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ct(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new x2(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(jc("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class x2 extends HE{data(){return super.data()}}function jc(t,e){return typeof e=="string"?_m(t,e):e instanceof bc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GE(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new G(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class wm{}class xm extends wm{}function ar(t,e,...n){let r=[];e instanceof wm&&r.push(e),r=r.concat(n),function(i){const o=i.filter(l=>l instanceof Em).length,a=i.filter(l=>l instanceof Mc).length;if(o>1||o>0&&a>0)throw new G(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Mc extends xm{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Mc(e,n,r)}_apply(e){const n=this._parse(e);return WE(e._query,n),new dr(e.firestore,e.converter,hf(e._query,n))}_parse(e){const n=Pc(e.firestore);return function(i,o,a,l,c,h,p){let m;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new G(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){t_(p,h);const g=[];for(const v of p)g.push(e_(l,i,v));m={arrayValue:{values:g}}}else m=e_(l,i,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||t_(p,h),m=_2(a,o,p,h==="in"||h==="not-in");return Be.create(c,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Mi(t,e,n){const r=e,s=jc("where",t);return Mc._create(s,r,n)}class Em extends wm{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Em(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:En.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)WE(o,l),o=hf(o,l)}(e._query,n),new dr(e.firestore,e.converter,hf(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Sm extends xm{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Sm(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new G(F.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new G(F.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new wa(i,o)}(e._query,this._field,this._direction);return new dr(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new qi(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Ba(t,e="asc"){const n=e,r=jc("orderBy",t);return Sm._create(r,n)}class Cm extends xm{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Cm(e,n,r)}_apply(e){return new dr(e.firestore,e.converter,Lu(e._query,this._limit,this._limitType))}}function E2(t){return Cm._create("limit",t,"F")}function e_(t,e,n){if(typeof(n=De(n))=="string"){if(n==="")throw new G(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Qx(e)&&n.indexOf("/")!==-1)throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Te.fromString(n));if(!Y.isDocumentKey(r))throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return xv(t,new Y(r))}if(n instanceof Ct)return xv(t,n._key);throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Rc(n)}.`)}function t_(t,e){if(!Array.isArray(t)||t.length===0)throw new G(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function WE(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new G(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new G(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class S2{convertValue(e,n="none"){switch(As(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Le(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Rs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw te()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ds(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Le(o.doubleValue));return new mm(i)}convertGeoPoint(e){return new pm(Le(e.latitude),Le(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=qp(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ya(e));default:return null}}convertTimestamp(e){const n=Qr(e);return new Ke(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Te.fromString(e);ve(yE(r));const s=new va(r.get(1),r.get(3)),i=new Y(r.popFirst(5));return s.isEqual(n)||sr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KE(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class QE extends HE{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new tu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(jc("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class tu extends QE{data(e={}){return super.data(e)}}class YE{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Po(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new tu(this._firestore,this._userDataWriter,r.key,r,new Po(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new G(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new tu(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Po(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new tu(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Po(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,h=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:C2(a.type),doc:l,oldIndex:c,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function C2(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return te()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vc(t){t=Ft(t,Ct);const e=Ft(t.firestore,or);return l2(Nc(e),t._key).then(n=>ZE(e,t,n))}class Im extends S2{constructor(e){super(),this.firestore=e}convertBytes(e){return new ji(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ct(this.firestore,null,n)}}function gi(t){t=Ft(t,dr);const e=Ft(t.firestore,or),n=Nc(e),r=new Im(e);return GE(t._query),u2(n,t._query).then(s=>new YE(e,r,t,s))}function I2(t,e,n){t=Ft(t,Ct);const r=Ft(t.firestore,or),s=KE(t.converter,e);return Oc(r,[$E(Pc(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,on.none())])}function Ef(t,e,n,...r){t=Ft(t,Ct);const s=Ft(t.firestore,or),i=Pc(s);let o;return o=typeof(e=De(e))=="string"||e instanceof bc?v2(i,"updateDoc",t._key,e,n,r):y2(i,"updateDoc",t._key,e),Oc(s,[o.toMutation(t._key,on.exists(!0))])}function XE(t){return Oc(Ft(t.firestore,or),[new Qp(t._key,on.none())])}function JE(t,e){const n=Ft(t.firestore,or),r=nt(t),s=KE(t.converter,e);return Oc(n,[$E(Pc(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,on.exists(!1))]).then(()=>r)}function ct(t,...e){var n,r,s;t=De(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Zv(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Zv(e[o])){const p=e[o];e[o]=(n=p.next)===null||n===void 0?void 0:n.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(s=p.complete)===null||s===void 0?void 0:s.bind(p)}let l,c,h;if(t instanceof Ct)c=Ft(t.firestore,or),h=vc(t._key.path),l={next:p=>{e[o]&&e[o](ZE(c,t,p))},error:e[o+1],complete:e[o+2]};else{const p=Ft(t,dr);c=Ft(p.firestore,or),h=p._query;const m=new Im(c);l={next:g=>{e[o]&&e[o](new YE(c,m,p,g))},error:e[o+1],complete:e[o+2]},GE(t._query)}return function(m,g,v,E){const N=new fm(E),S=new dm(g,N,v);return m.asyncQueue.enqueueAndForget(async()=>lm(await Bu(m),S)),()=>{N.Za(),m.asyncQueue.enqueueAndForget(async()=>um(await Bu(m),S))}}(Nc(c),h,a,l)}function Oc(t,e){return function(r,s){const i=new Xn;return r.asyncQueue.enqueueAndForget(async()=>XP(await a2(r),s,i)),i.promise}(Nc(t),e)}function ZE(t,e,n){const r=n.docs.get(e._key),s=new Im(t);return new QE(t,s,e._key,r,new Po(n.hasPendingWrites,n.fromCache),e.converter)}function T2(){return new ym("serverTimestamp")}(function(e,n=!0){(function(s){Bi=s})($i),Ss(new Wr("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new or(new Nb(r.getProvider("auth-internal")),new Db(r.getProvider("app-check-internal")),function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new G(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new va(c.options.projectId,h)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),bn(gv,"4.7.3",e),bn(gv,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R2="type.googleapis.com/google.protobuf.Int64Value",A2="type.googleapis.com/google.protobuf.UInt64Value";function eS(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function Sf(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Sf(e));if(typeof t=="function"||typeof t=="object")return eS(t,e=>Sf(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Hu(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case R2:case A2:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Hu(e)):typeof t=="function"||typeof t=="object"?eS(t,e=>Hu(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tm="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n_={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class yi extends Ln{constructor(e,n,r){super(`${Tm}/${e}`,n||""),this.details=r}}function N2(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function b2(t,e){let n=N2(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!n_[o])return new yi("internal","internal");n=n_[o],r=o}const a=i.message;typeof a=="string"&&(r=a),s=i.details,s!==void 0&&(s=Hu(s))}}catch{}return n==="ok"?null:new yi(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k2{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||n.get().then(s=>this.messaging=s,()=>{}),this.appCheck||r.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cf="us-central1";function P2(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new yi("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class D2{constructor(e,n,r,s,i=Cf,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new k2(n,r,s),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=Cf}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function j2(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}function M2(t,e,n){return r=>O2(t,e,r,{})}async function V2(t,e,n,r){n["Content-Type"]="application/json";let s;try{s=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}function O2(t,e,n,r){const s=t._url(e);return L2(t,s,n,r)}async function L2(t,e,n,r){n=Sf(n);const s={data:n},i={},o=await t.contextProvider.getContext(r.limitedUseAppCheckTokens);o.authToken&&(i.Authorization="Bearer "+o.authToken),o.messagingToken&&(i["Firebase-Instance-ID-Token"]=o.messagingToken),o.appCheckToken!==null&&(i["X-Firebase-AppCheck"]=o.appCheckToken);const a=r.timeout||7e4,l=P2(a),c=await Promise.race([V2(e,s,i,t.fetchImpl),l.promise,t.cancelAllRequests]);if(l.cancel(),!c)throw new yi("cancelled","Firebase Functions instance was deleted.");const h=b2(c.status,c.json);if(h)throw h;if(!c.json)throw new yi("internal","Response is not valid JSON object.");let p=c.json.data;if(typeof p>"u"&&(p=c.json.result),typeof p>"u")throw new yi("internal","Response is missing data field.");return{data:Hu(p)}}const r_="@firebase/functions",s_="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F2="auth-internal",U2="app-check-internal",$2="messaging-internal";function z2(t,e){const n=(r,{instanceIdentifier:s})=>{const i=r.getProvider("app").getImmediate(),o=r.getProvider(F2),a=r.getProvider($2),l=r.getProvider(U2);return new D2(i,o,a,l,s,t)};Ss(new Wr(Tm,n,"PUBLIC").setMultipleInstances(!0)),bn(r_,s_,e),bn(r_,s_,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B2(t=kp(),e=Cf){const r=fc(De(t),Tm).getImmediate({identifier:e}),s=q0("functions");return s&&q2(r,...s),r}function q2(t,e,n){j2(De(t),e,n)}function tn(t,e,n){return M2(De(t),e)}z2(fetch.bind(self));const H2={apiKey:"AIzaSyBF984SFAB0hqzjxioRe5pylFt1JSwhnIg",authDomain:"roll-call-14e2f.firebaseapp.com",projectId:"roll-call-14e2f",appId:"1:750350080064:web:654ea16d643bf3c46827a5"},Rm=Q0(H2),Ut=Sb(Rm),ue=h2(Rm),G2="us-central1",nn=B2(Rm,G2);function W2(){const t=$t(),[e,n]=k.useState(""),[r,s]=k.useState(""),[i,o]=k.useState(null),[a,l]=k.useState(!1),c=async h=>{h.preventDefault(),l(!0),o(null);try{await oN(Ut,e,r),t("/")}catch(p){o(p.message||"Login failed")}finally{l(!1)}};return d.jsx(Er,{children:d.jsx("div",{className:"flex min-h-[480px] items-center justify-center px-4",children:d.jsxs("div",{className:"w-full max-w-md rounded-lg bg-white p-8 shadow",children:[d.jsx("h1",{className:"mb-6 text-2xl font-bold text-slate-900",children:"Lecturer Login"}),d.jsxs("form",{className:"space-y-4",onSubmit:c,children:[d.jsxs("div",{children:[d.jsx("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"Email"}),d.jsx("input",{type:"email",className:"w-full rounded border border-slate-300 px-3 py-2",value:e,onChange:h=>n(h.target.value),required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"Password"}),d.jsx("input",{type:"password",className:"w-full rounded border border-slate-300 px-3 py-2",value:r,onChange:h=>s(h.target.value),required:!0})]}),i&&d.jsx("p",{className:"text-sm text-red-600",children:i}),d.jsx("button",{type:"submit",className:"w-full rounded bg-primary-500 px-4 py-2 text-white transition hover:bg-primary-600 disabled:cursor-not-allowed disabled:bg-slate-400",disabled:a,children:a?"Signing in...":"Sign in"})]}),d.jsxs("p",{className:"mt-4 text-sm text-slate-600",children:["No account? ",d.jsx(br,{to:"/register",className:"font-semibold text-primary-600",children:"Register"})]})]})})})}function K2(){const t=$t(),[e,n]=k.useState(""),[r,s]=k.useState(""),[i,o]=k.useState(""),[a,l]=k.useState(""),[c,h]=k.useState(""),[p,m]=k.useState(""),[g,v]=k.useState(null),[E,N]=k.useState(!1),S=async _=>{if(_.preventDefault(),v(null),c!==p){v("Passwords do not match");return}N(!0);try{const x=await iN(Ut,i,c),D=`${e} ${r}`.trim();Ut.currentUser&&await lN(Ut.currentUser,{displayName:D}),await I2(nt(ue,"lecturers",x.user.uid),{firstName:e,lastName:r,displayName:D,email:i,department:a,createdAt:T2()}),t("/")}catch(x){const D=(x==null?void 0:x.code)||"unknown",O=(x==null?void 0:x.message)||"Registration failed";console.error("Registration error",{errorCode:D,errorMessage:O,raw:x}),v(`${D}: ${O}`)}finally{N(!1)}};return d.jsx(Er,{children:d.jsx("div",{className:"flex min-h-[480px] items-center justify-center px-4",children:d.jsxs("div",{className:"w-full max-w-xl rounded-lg bg-white p-8 shadow",children:[d.jsx("h1",{className:"mb-6 text-2xl font-bold text-slate-900",children:"Lecturer Registration"}),d.jsxs("form",{className:"grid grid-cols-1 gap-4",onSubmit:S,children:[d.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[d.jsxs("div",{children:[d.jsx("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"First name"}),d.jsx("input",{className:"w-full rounded border border-slate-300 px-3 py-2",value:e,onChange:_=>n(_.target.value),required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"Last name"}),d.jsx("input",{className:"w-full rounded border border-slate-300 px-3 py-2",value:r,onChange:_=>s(_.target.value),required:!0})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"Email"}),d.jsx("input",{type:"email",className:"w-full rounded border border-slate-300 px-3 py-2",value:i,onChange:_=>o(_.target.value),required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"Department (optional)"}),d.jsx("input",{className:"w-full rounded border border-slate-300 px-3 py-2",value:a,onChange:_=>l(_.target.value)})]}),d.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[d.jsxs("div",{children:[d.jsx("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"Password"}),d.jsx("input",{type:"password",className:"w-full rounded border border-slate-300 px-3 py-2",value:c,onChange:_=>h(_.target.value),required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"Confirm password"}),d.jsx("input",{type:"password",className:"w-full rounded border border-slate-300 px-3 py-2",value:p,onChange:_=>m(_.target.value),required:!0})]})]}),g&&d.jsx("p",{className:"text-sm text-red-600",children:g}),d.jsx("button",{type:"submit",className:"rounded bg-primary-500 px-4 py-2 text-white transition hover:bg-primary-600 disabled:cursor-not-allowed disabled:bg-slate-400",disabled:E,children:E?"Creating account...":"Create account"})]}),d.jsxs("p",{className:"mt-4 text-sm text-slate-600",children:["Already registered? ",d.jsx(br,{to:"/login",className:"font-semibold text-primary-600",children:"Sign in"})]})]})})})}const tS=k.createContext(null);function Wi(){const t=k.useContext(tS);if(!t)throw new Error("useToast must be used within ToastProvider");return t}function Q2({children:t}){const[e,n]=k.useState([]),r=k.useCallback(s=>{const i=`${Date.now()}-${Math.random().toString(36).slice(2,9)}`;n(o=>[...o,{id:i,...s}])},[]);return k.useEffect(()=>{if(!e.length)return;const s=[];return e.forEach(i=>{const o=window.setTimeout(()=>{n(a=>a.filter(l=>l.id!==i.id))},i.duration||4e3);s.push(o)}),()=>s.forEach(i=>clearTimeout(i))},[e]),d.jsxs(tS.Provider,{value:{showToast:r},children:[t,d.jsx("div",{"aria-live":"polite","aria-atomic":"true",className:"fixed inset-x-0 bottom-6 flex items-end justify-center pointer-events-none z-50",children:d.jsx("div",{className:"w-full max-w-md px-4",children:d.jsx("div",{className:"space-y-3",children:e.map(s=>d.jsx("div",{role:"status",className:`pointer-events-auto rounded-md p-3 shadow-md transform transition-all duration-150 ${s.variant==="error"?"bg-red-50 border border-red-200 text-red-800":s.variant==="success"?"bg-green-50 border border-green-200 text-green-800":"bg-white border"}`,style:{animation:"fade-in 160ms ease-out"},children:d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx("div",{className:"flex-1 text-sm",children:s.message}),d.jsx("button",{onClick:()=>n(i=>i.filter(o=>o.id!==s.id)),className:"text-xs text-text-muted",children:"Close"})]})},s.id))})})})]})}function vi({children:t,tone:e="neutral",...n}){const r=e==="success"?"bg-green-50 text-green-800 border border-green-100":e==="warning"?"bg-amber-50 text-amber-800 border border-amber-100":e==="danger"?"bg-red-50 text-red-800 border border-red-100":"bg-gray-100 text-gray-700 border border-gray-200";return d.jsx("span",{...n,className:`inline-flex items-center gap-2 rounded-full px-2.5 py-1 text-sm font-medium ${r}`,children:t})}function nS({children:t,onClick:e,disabled:n,className:r}){return d.jsx("button",{onClick:e,disabled:n,className:`inline-flex items-center justify-center rounded-md bg-brand-primary px-4 py-2 text-sm font-semibold text-text-onBrand transition hover:opacity-95 disabled:cursor-not-allowed disabled:opacity-60 ${r||""}`,children:t})}function Y2({children:t,onClick:e,disabled:n,className:r}){return d.jsx("button",{onClick:e,disabled:n,className:`inline-flex items-center justify-center rounded-md border border-stroke-subtle bg-white px-3 py-1.5 text-sm font-medium text-text-primary transition hover:bg-surfaceAlt disabled:cursor-not-allowed disabled:opacity-60 ${r||""}`,children:t})}function X2({children:t,className:e}){return d.jsx("div",{className:`rounded-2xl border border-stroke-subtle bg-surface p-4 shadow-subtle ${e||""}`,children:t})}function J2(){const t=Ut.currentUser,{showToast:e}=Wi(),n=$t(),[r,s]=k.useState([]);k.useEffect(()=>{if(!t)return;const a=tt(ue,"schedules"),l=ar(a,Mi("lecturerId","==",t.uid),Ba("scheduledAt","asc")),c=ct(l,h=>{const p=h.docs.map(m=>({id:m.id,...m.data()}));s(p.filter(m=>(m.status||"queued")==="queued"))});return()=>c()},[t]);const i=async a=>{var l,c,h,p,m,g;if(t)try{let v=null;try{v=window.open("","_blank")}catch{v=null}const E=tn(nn,"createSession");let N=a.moduleCode||"";if(!N&&a.moduleId)try{const D=await Vc(nt(ue,"modules",a.moduleId));D.exists()&&(N=((l=D.data())==null?void 0:l.moduleCode)||"")}catch{}const S={moduleId:a.moduleId,moduleCode:N,title:a.title||"",windowSeconds:a.windowSeconds||60,requiredFields:a.requiredFields||{},requireClassCode:a.requireClassCode||!1},_=await E(S),x=(c=_==null?void 0:_.data)==null?void 0:c.sessionId;if(x){await Ef(nt(ue,"schedules",a.id),{status:"started",startedAt:new Date,sessionId:x});const D=`${window.location.origin}/sessions/${x}/display`;if(v)try{v.location.href=D}catch{window.open(D,"_blank","noopener,noreferrer")}else window.open(D,"_blank","noopener,noreferrer");e({message:"Started scheduled session",variant:"success"}),n(`/sessions/${x}/live`,{state:{initialExpiresAt:((h=_==null?void 0:_.data)==null?void 0:h.qrExpiresAt)||((p=_==null?void 0:_.data)==null?void 0:p.expiresAt),initialClassCode:((m=_==null?void 0:_.data)==null?void 0:m.classCode)||null,initialToken:((g=_==null?void 0:_.data)==null?void 0:g.qrToken)||null,openedDisplay:!0}})}}catch(v){e({message:(v==null?void 0:v.message)||"Failed to start schedule",variant:"error"})}},o=[{label:"Status",value:"No session in progress",hint:"Start a session to begin capturing attendance.",tone:"neutral"},{label:"Today",value:"0 classes scheduled",hint:"Build a timetable from your assigned modules.",tone:"info"},{label:"Recent",value:"0 submissions",hint:"Live submissions appear while a session is active.",tone:"success"}];return d.jsxs("div",{className:"mx-auto w-full max-w-6xl space-y-6",children:[d.jsxs("div",{className:"mb-2 lg:hidden",children:[d.jsx("h1",{className:"text-2xl font-semibold tracking-tight text-text-primary",children:"Dashboard"}),d.jsx("p",{className:"mt-1 text-sm text-text-muted",children:"Key session controls and quick links."})]}),d.jsx("div",{className:"grid gap-4 sm:grid-cols-3",children:o.map(a=>d.jsx(X2,{className:"p-4",children:d.jsxs("div",{className:"flex items-start justify-between gap-3",children:[d.jsxs("div",{children:[d.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-text-muted",children:a.label}),d.jsx("div",{className:"mt-1 text-lg font-semibold text-text-primary",children:a.value}),d.jsx("div",{className:"mt-1 text-xs text-text-muted",children:a.hint})]}),d.jsx("div",{className:"shrink-0",children:d.jsx(vi,{tone:a.tone==="success"?"success":(a.tone==="info","neutral"),children:a.tone.toUpperCase()})})]})},a.label))}),d.jsxs("section",{className:"grid gap-6 lg:grid-cols-[2fr,1fr]",children:[d.jsxs("div",{className:"rounded-2xl border border-stroke-subtle bg-surface shadow-subtle",children:[d.jsx("div",{className:"flex flex-col gap-3 border-b border-stroke-subtle p-5 sm:flex-row sm:items-center sm:justify-between",children:d.jsxs("div",{children:[d.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Todays classes"}),d.jsx("p",{className:"mt-1 text-sm text-text-muted",children:"Generated from your modules and timetable rules."})]})}),d.jsx("div",{className:"p-4",children:d.jsx("div",{className:"grid gap-3",children:d.jsx("div",{className:"rounded-lg border border-stroke-subtle bg-surfaceAlt p-3 text-sm text-text-muted",children:"No classes scheduled"})})}),d.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 border-t border-stroke-subtle p-5",children:[d.jsx("p",{className:"text-xs text-text-muted",children:"Tip: once modules are loaded, RollCall can auto-build your weekly timetable."}),d.jsx("div",{className:"flex items-center gap-2",children:d.jsx(br,{to:"/history",className:"rounded-full px-3 py-2 text-sm font-semibold text-brand-secondary transition hover:bg-brand-soft",children:"Attendance history"})})]})]}),d.jsxs("div",{className:"rounded-2xl border border-stroke-subtle bg-surface shadow-subtle mt-4",children:[d.jsxs("div",{className:"border-b border-stroke-subtle p-5",children:[d.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Scheduled sessions"}),d.jsx("p",{className:"mt-1 text-sm text-text-muted",children:"Queued schedules you can start immediately."})]}),d.jsx("div",{className:"p-4 space-y-3",children:r.length===0?d.jsx("div",{className:"text-sm text-text-muted",children:"No queued schedules"}):r.slice(0,5).map(a=>{var l;return d.jsxs("div",{className:"flex items-center justify-between gap-3",children:[d.jsxs("div",{className:"min-w-0",children:[d.jsx("div",{className:"text-sm font-semibold text-text-primary",children:a.title||a.moduleCode||"Untitled"}),d.jsx("div",{className:"text-xs text-text-muted",children:(l=a.scheduledAt)!=null&&l.toDate?new Date(a.scheduledAt.toDate()).toLocaleString():a.scheduledAt?new Date(a.scheduledAt).toLocaleString():""}),d.jsxs("div",{className:"mt-1 text-xs text-text-muted",children:[(a.instructors||[]).join(", ")||"","  ",a.recurrence||"No recurrence"]})]}),d.jsx("div",{className:"shrink-0",children:d.jsx(nS,{onClick:()=>i(a),children:"Start"})})]},a.id)})})]}),d.jsxs("aside",{className:"space-y-6",children:[d.jsxs("div",{className:"rounded-2xl border border-stroke-subtle bg-surface shadow-subtle",children:[d.jsxs("div",{className:"border-b border-stroke-subtle p-5",children:[d.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Quick actions"}),d.jsx("p",{className:"mt-1 text-sm text-text-muted",children:"Jump straight to what you need."})]}),d.jsxs("div",{className:"p-2",children:[d.jsxs(br,{to:"/analytics",className:"flex items-start justify-between gap-3 rounded-xl p-4 transition hover:bg-surfaceAlt",children:[d.jsxs("div",{className:"space-y-1",children:[d.jsx("p",{className:"text-sm font-semibold text-text-primary",children:"Analytics"}),d.jsx("p",{className:"text-sm text-text-muted",children:"Trends, heatmaps, integrity insights, exports."})]}),d.jsx("span",{className:"mt-1 text-xs font-semibold text-text-muted",children:""})]}),d.jsxs(br,{to:"/modules",className:"flex items-start justify-between gap-3 rounded-xl p-4 transition hover:bg-surfaceAlt",children:[d.jsxs("div",{className:"space-y-1",children:[d.jsx("p",{className:"text-sm font-semibold text-text-primary",children:"Modules"}),d.jsx("p",{className:"text-sm text-text-muted",children:"Upload class lists, manage venues, session defaults."})]}),d.jsx("span",{className:"mt-1 text-xs font-semibold text-text-muted",children:""})]}),d.jsxs(br,{to:"/history",className:"flex items-start justify-between gap-3 rounded-xl p-4 transition hover:bg-surfaceAlt",children:[d.jsxs("div",{className:"space-y-1",children:[d.jsx("p",{className:"text-sm font-semibold text-text-primary",children:"Archive"}),d.jsx("p",{className:"text-sm text-text-muted",children:"Search past sessions and export CSV/PDF."})]}),d.jsx("span",{className:"mt-1 text-xs font-semibold text-text-muted",children:""})]})]})]}),d.jsxs("div",{className:"rounded-2xl border border-stroke-subtle bg-surface shadow-subtle",children:[d.jsxs("div",{className:"border-b border-stroke-subtle p-5",children:[d.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Recent activity"}),d.jsx("p",{className:"mt-1 text-sm text-text-muted",children:"Latest sessions and submissions across modules."})]}),d.jsx("div",{className:"p-5",children:d.jsxs("div",{className:"rounded-xl border border-dashed border-stroke-subtle bg-surfaceAlt p-4",children:[d.jsx("p",{className:"text-sm font-semibold text-text-primary",children:"Nothing yet"}),d.jsx("p",{className:"mt-1 text-sm text-text-muted",children:"Start a session and live submissions will show up here."})]})})]})]})]})]})}function Ki({title:t,description:e,action:n,showBack:r=!0}){const s=$t();return d.jsxs("div",{className:"space-y-3",children:[r&&d.jsx("button",{type:"button",onClick:()=>s(-1),className:"text-sm font-medium text-text-muted transition hover:text-text-primary",children:" Back"}),d.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",children:[d.jsxs("div",{className:"flex items-center gap-4 lg:hidden",children:[d.jsx("div",{className:"w-1.5 h-8 rounded bg-brand-primary/90"}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-semibold text-text-primary",children:t}),e&&d.jsx("p",{className:"text-sm text-text-muted",children:e})]})]}),n]})]})}function Z2(){const t=Ut.currentUser,[e,n]=k.useState([]),[r,s]=k.useState(""),[i,o]=k.useState(""),[a,l]=k.useState(null),[c,h]=k.useState(!1);k.useEffect(()=>{if(!t)return;const g=tt(ue,"modules"),v=ct(ar(g),E=>{const N=E.docs.filter(S=>S.data().lecturerId===t.uid).map(S=>({id:S.id,moduleCode:S.data().moduleCode,moduleName:S.data().moduleName||""}));n(N)});return()=>v()},[t]);const p=async g=>{if(g.preventDefault(),!!t){h(!0),l(null);try{await JE(tt(ue,"modules"),{lecturerId:t.uid,moduleCode:r,moduleName:i,createdAt:new Date().toISOString()}),s(""),o("")}catch(v){l(v.message||"Failed to add module")}finally{h(!1)}}},m=async g=>{await XE(nt(ue,"modules",g))};return d.jsxs("div",{className:"space-y-8",children:[d.jsx(Ki,{title:"Modules",description:"Organise the classes you deliver this term.",showBack:!1}),d.jsxs("section",{className:"rounded-md border border-stroke-subtle bg-surface p-6 shadow-subtle",children:[d.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide text-text-muted",children:"Add module"}),d.jsxs("form",{className:"mt-4 grid gap-4 md:grid-cols-2",onSubmit:p,children:[d.jsxs("div",{children:[d.jsx("label",{className:"mb-1 block text-sm font-medium text-text-muted",children:"Module code"}),d.jsx("input",{className:"w-full rounded-md border border-stroke-subtle px-3 py-2 text-sm focus:border-brand-primary focus:outline-none",value:r,onChange:g=>s(g.target.value),required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"mb-1 block text-sm font-medium text-text-muted",children:"Module name"}),d.jsx("input",{className:"w-full rounded-md border border-stroke-subtle px-3 py-2 text-sm focus:border-brand-primary focus:outline-none",value:i,onChange:g=>o(g.target.value),placeholder:"Optional"})]}),d.jsxs("div",{className:"md:col-span-2 flex items-center justify-between",children:[a&&d.jsx("p",{className:"text-sm text-accent-error",children:a}),d.jsx("div",{className:"ml-auto flex gap-3",children:d.jsx("button",{type:"submit",className:"rounded-md bg-brand-primary px-4 py-2 text-sm font-semibold text-white transition hover:opacity-95 disabled:cursor-not-allowed disabled:bg-stroke-strong",disabled:c,children:c?"Saving...":"Save module"})})]})]})]}),d.jsxs("section",{className:"rounded-md border border-stroke-subtle bg-surface p-6 shadow-subtle",children:[d.jsx("div",{className:"flex items-center justify-between",children:d.jsxs("div",{children:[d.jsx("h2",{className:"text-base font-semibold text-text-primary",children:"Module catalogue"}),d.jsx("p",{className:"text-sm text-text-muted",children:"Manage the modules available for attendance tracking."})]})}),d.jsx("div",{className:"mt-4 overflow-hidden rounded-md border border-stroke-subtle",children:d.jsxs("table",{className:"min-w-full divide-y divide-stroke-subtle text-sm",children:[d.jsx("thead",{className:"bg-surfaceAlt text-xs uppercase text-text-muted",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-4 py-2 text-left",children:"Module code"}),d.jsx("th",{className:"px-4 py-2 text-left",children:"Module name"}),d.jsx("th",{className:"px-4 py-2 text-left",children:"Sessions"}),d.jsx("th",{className:"px-4 py-2 text-right",children:"Actions"})]})}),d.jsxs("tbody",{className:"divide-y divide-stroke-subtle",children:[e.map(g=>d.jsxs("tr",{className:"hover:bg-surfaceAlt/60",children:[d.jsx("td",{className:"px-4 py-2 font-medium text-text-primary",children:g.moduleCode}),d.jsx("td",{className:"px-4 py-2 text-text-muted",children:g.moduleName||""}),d.jsx("td",{className:"px-4 py-2 text-text-muted",children:"--"}),d.jsx("td",{className:"px-4 py-2 text-right",children:d.jsx("div",{className:"inline-flex items-center gap-2",children:d.jsx("button",{type:"button",className:"rounded-md border border-stroke-subtle px-3 py-1 text-xs font-medium text-text-muted transition hover:bg-surfaceAlt",onClick:()=>m(g.id),children:"Remove"})})})]},g.id)),e.length===0&&d.jsx("tr",{children:d.jsx("td",{colSpan:4,className:"px-4 py-6 text-center text-sm text-text-muted",children:"No modules recorded yet. Add your first module above."})})]})]})})]})]})}const eD=[{label:"30 seconds",value:30},{label:"60 seconds",value:60},{label:"2 minutes",value:120},{label:"5 minutes",value:300}];function tD(){const t=Ut.currentUser,e=$t(),{showToast:n}=Wi(),[r,s]=k.useState([]),[i,o]=k.useState(""),[a,l]=k.useState(""),[c,h]=k.useState(60),[p,m]=k.useState({name:!1,surname:!1,initials:!1,email:!1,group:!1}),[g,v]=k.useState(!1),[E,N]=k.useState(30),[S,_]=k.useState(!1),[x,D]=k.useState(null),[O,j]=k.useState(null);k.useEffect(()=>{if(!t)return;const T=tt(ue,"modules"),b=ct(ar(T),P=>{const A=P.docs.filter(X=>X.data().lecturerId===t.uid).map(X=>({id:X.id,moduleCode:X.data().moduleCode,moduleName:X.data().moduleName||""}));s(A),A.length>0&&!i&&o(A[0].id)});return()=>b()},[t,i]),k.useEffect(()=>{if(!t)return;const T=tt(ue,"sessions"),b=ar(T,Mi("lecturerId","==",t.uid),Ba("createdAt","desc"),E2(5)),P=ct(b,A=>{var Se;const X=A.docs;let ge=null;for(const fe of X){const z=fe.data(),V=(Se=z.expiresAt)!=null&&Se.toDate?z.expiresAt.toDate():z.expiresAt?new Date(z.expiresAt):null;if(z.isActive&&(!V||V.getTime()>Date.now())){ge=fe.id;break}}j(ge)});return()=>P()},[t]);const R=k.useMemo(()=>{const T={};return r.forEach(b=>{T[b.id]=b}),T},[r]),w=T=>{m(b=>({...b,[T]:!b[T]}))},C=async T=>{var A,X,ge,Se,fe,z;if(T.preventDefault(),!i){D("Select a module");return}const b=R[i];if(!b)return;_(!0),D(null);let P=null;try{P=window.open("","_blank")}catch{P=null}try{const $=await tn(nn,"createSession")({moduleId:i,moduleCode:b.moduleCode,title:a,windowSeconds:c,requiredFields:p,requireClassCode:g,classCodeRotationSeconds:g?E:void 0}),Q=(A=$==null?void 0:$.data)==null?void 0:A.sessionId;if(Q){const se=`${window.location.origin}/sessions/${Q}/display`;if(P)try{P.location.href=se}catch{window.open(se,"_blank","noopener,noreferrer")}else window.open(se,"_blank","noopener,noreferrer");n({message:"Session started",variant:"success"}),e(`/sessions/${Q}/live`,{state:{initialExpiresAt:((X=$==null?void 0:$.data)==null?void 0:X.qrExpiresAt)||((ge=$==null?void 0:$.data)==null?void 0:ge.expiresAt),initialClassCode:((Se=$==null?void 0:$.data)==null?void 0:Se.classCode)||null,initialToken:((fe=$==null?void 0:$.data)==null?void 0:fe.qrToken)||null,openedDisplay:!0}})}}catch(V){const $=((z=V==null?void 0:V.details)==null?void 0:z.message)||(V==null?void 0:V.message)||"Failed to create session";D($),n({message:$,variant:"error"})}finally{_(!1)}};return d.jsxs("div",{className:"space-y-8",children:[d.jsx(Ki,{title:"Start attendance session",description:"Define session details, required student information, and anti-sharing measures."}),d.jsxs("form",{className:"space-y-8",onSubmit:C,children:[O&&d.jsx("div",{className:"rounded-md border border-amber-300 bg-amber-50 p-4 text-sm",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("div",{children:"There is an active session in progress."}),d.jsx("div",{className:"flex gap-2",children:d.jsx("button",{type:"button",className:"rounded-md border border-stroke-subtle px-3 py-1 text-sm text-text-muted hover:bg-surfaceAlt",onClick:()=>e(`/sessions/${O}/live`),children:"Return to live session"})})]})}),d.jsxs("section",{className:"rounded-md border border-stroke-subtle bg-surface p-6 shadow-subtle",children:[d.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide text-text-muted",children:"Session information"}),d.jsxs("div",{className:"mt-4 grid gap-4 md:grid-cols-2",children:[d.jsxs("div",{className:"md:col-span-1",children:[d.jsx("label",{className:"mb-1 block text-sm font-medium text-text-muted",children:"Module"}),d.jsxs("select",{className:"w-full rounded-md border border-stroke-subtle px-3 py-2 text-sm focus:border-brand-primary focus:outline-none",value:i,onChange:T=>o(T.target.value),required:!0,children:[d.jsx("option",{value:"",disabled:!0,children:"Select module"}),r.map(T=>d.jsxs("option",{value:T.id,children:[T.moduleCode,T.moduleName?`  ${T.moduleName}`:""]},T.id))]})]}),d.jsxs("div",{className:"md:col-span-1",children:[d.jsx("label",{className:"mb-1 block text-sm font-medium text-text-muted",children:"Session title"}),d.jsx("input",{className:"w-full rounded-md border border-stroke-subtle px-3 py-2 text-sm focus:border-brand-primary focus:outline-none",value:a,onChange:T=>l(T.target.value),placeholder:"Week 2 lecture"})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("p",{className:"mb-2 text-sm font-medium text-text-muted",children:"QR expiry window"}),d.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:eD.map(T=>d.jsxs("label",{className:`flex items-center gap-2 rounded-md border px-3 py-2 text-sm transition ${c===T.value?"border-brand-primary bg-surfaceAlt":"border-stroke-subtle hover:border-brand-primary/60"}`,children:[d.jsx("input",{type:"radio",name:"window",value:T.value,checked:c===T.value,onChange:()=>h(T.value)}),T.label]},T.value))})]})]})]}),d.jsxs("section",{className:"rounded-md border border-stroke-subtle bg-surface p-6 shadow-subtle",children:[d.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide text-text-muted",children:"Student fields"}),d.jsx("p",{className:"mt-2 text-sm text-text-muted",children:"Select the data students must provide when submitting attendance."}),d.jsx("div",{className:"mt-4 grid gap-3 sm:grid-cols-2",children:Object.entries(p).map(([T,b])=>d.jsxs("label",{className:"flex items-center gap-2 text-sm text-text-primary",children:[d.jsx("input",{type:"checkbox",checked:b,onChange:()=>w(T)}),d.jsx("span",{className:"capitalize",children:T})]},T))}),d.jsx("p",{className:"mt-3 text-xs text-text-muted",children:"Student number is always required and validated by the system."})]}),d.jsxs("section",{className:"rounded-md border border-stroke-subtle bg-surface p-6 shadow-subtle",children:[d.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide text-text-muted",children:"Anti-cheat settings"}),d.jsxs("div",{className:"mt-4 flex flex-col gap-3 rounded-md border border-stroke-subtle bg-surfaceAlt px-4 py-3",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-text-primary",children:"In-class code"}),d.jsx("p",{className:"text-xs text-text-muted",children:"Require a 4-digit code announced in the lecture room."})]}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("label",{className:"flex items-center gap-2 text-sm text-text-primary",children:[d.jsx("input",{type:"checkbox",checked:g,onChange:()=>v(T=>!T)}),"Enable"]}),g&&d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("label",{className:"text-sm text-text-muted",children:"Rotation"}),d.jsxs("select",{className:"rounded-md border px-2 py-1 text-sm",value:E,onChange:T=>N(Number(T.target.value)),children:[d.jsx("option",{value:30,children:"30s"}),d.jsx("option",{value:60,children:"60s"})]})]})]})]})]}),x&&d.jsx("p",{className:"text-sm text-accent-error",children:x}),d.jsxs("div",{className:"flex justify-end gap-3",children:[d.jsx("button",{type:"button",onClick:()=>e(-1),className:"rounded-md border border-stroke-subtle px-4 py-2 text-sm font-medium text-text-muted transition hover:bg-surfaceAlt",children:"Cancel"}),d.jsx("button",{type:"submit",className:"rounded-md bg-brand-primary px-5 py-2 text-sm font-semibold text-white transition hover:opacity-95 disabled:cursor-not-allowed disabled:bg-stroke-strong",disabled:S,children:S?"Starting...":"Start session"})]})]})]})}function bl(t){if(!t)return"";const e=t.getTimezoneOffset()*6e4;return new Date(t.getTime()-e).toISOString().slice(0,16)}const nD=[{label:"30 seconds",value:30},{label:"60 seconds",value:60},{label:"2 minutes",value:120},{label:"5 minutes",value:300}];function rD(){const t=Ut.currentUser,{showToast:e}=Wi(),n=$t(),[r,s]=k.useState([]),[i,o]=k.useState([]),[a,l]=k.useState(""),[c,h]=k.useState(""),[p,m]=k.useState(bl(new Date)),[g,v]=k.useState(60),[E,N]=k.useState({name:!1,surname:!1,initials:!1,email:!1,group:!1}),[S,_]=k.useState(!1),[x,D]=k.useState("none"),[O,j]=k.useState(""),[R,w]=k.useState(!1),[C,T]=k.useState(null),[b,P]=k.useState(!1);k.useEffect(()=>{if(!t)return;const V=tt(ue,"modules"),$=ct(ar(V),Q=>{const se=Q.docs.filter(ce=>ce.data().lecturerId===t.uid).map(ce=>({id:ce.id,...ce.data()}));s(se),se.length>0&&!a&&l(se[0].id)});return()=>$()},[t]),k.useEffect(()=>{if(!t)return;const V=tt(ue,"schedules"),$=ar(V,Mi("lecturerId","==",t.uid),Ba("scheduledAt","desc")),Q=ct($,se=>{o(se.docs.map(ce=>({id:ce.id,...ce.data()})))});return()=>Q()},[t]);const A=k.useMemo(()=>{const V={};return r.forEach($=>V[$.id]=$),V},[r]),X=V=>N($=>({...$,[V]:!$[V]})),ge=async V=>{if(V==null||V.preventDefault(),!t)return e({message:"Not signed in",variant:"error"});if(!a)return e({message:"Select module",variant:"error"});P(!0);try{const $={lecturerId:t.uid,moduleId:a,title:c,scheduledAt:new Date(p),windowSeconds:g,requiredFields:E,requireClassCode:S,recurrence:x==="none"?null:x,instructors:O?O.split(",").map(Q=>Q.trim()).filter(Boolean):[],concurrent:R||!1,status:"queued",createdAt:new Date};C?(await Ef(nt(ue,"schedules",C),$),T(null)):await JE(tt(ue,"schedules"),$),h(""),D("none"),j(""),w(!1),e({message:"Schedule saved",variant:"success"})}catch($){e({message:($==null?void 0:$.message)||"Failed to create schedule",variant:"error"})}finally{P(!1)}},Se=async V=>{var $,Q,se,ce,ft,Rt;if(t){P(!0);try{const Ue=A[V.moduleId];let Ye=(Ue==null?void 0:Ue.moduleCode)||"";if(!Ye&&V.moduleId)try{const zt=await Vc(nt(ue,"modules",V.moduleId));zt.exists()&&(Ye=(($=zt.data())==null?void 0:$.moduleCode)||"")}catch{}let un=null;try{un=window.open("","_blank")}catch{un=null}const Ms=tn(nn,"createSession"),hr={moduleId:V.moduleId,moduleCode:Ye,title:V.title||"",windowSeconds:V.windowSeconds||60,requiredFields:V.requiredFields||{},requireClassCode:V.requireClassCode||!1},_e=await Ms(hr),Jt=(Q=_e==null?void 0:_e.data)==null?void 0:Q.sessionId;if(Jt){await Ef(nt(ue,"schedules",V.id),{status:"started",startedAt:new Date,sessionId:Jt});const zt=`${window.location.origin}/sessions/${Jt}/display`;if(un)try{un.location.href=zt}catch{window.open(zt,"_blank","noopener,noreferrer")}else window.open(zt,"_blank","noopener,noreferrer");e({message:"Session started from schedule",variant:"success"}),n(`/sessions/${Jt}/live`,{state:{initialExpiresAt:((se=_e==null?void 0:_e.data)==null?void 0:se.qrExpiresAt)||((ce=_e==null?void 0:_e.data)==null?void 0:ce.expiresAt),initialClassCode:((ft=_e==null?void 0:_e.data)==null?void 0:ft.classCode)||null,initialToken:((Rt=_e==null?void 0:_e.data)==null?void 0:Rt.qrToken)||null,openedDisplay:!0}})}}catch(Ue){e({message:(Ue==null?void 0:Ue.message)||"Failed to start session",variant:"error"})}finally{P(!1)}}},fe=async V=>{try{await XE(nt(ue,"schedules",V)),e({message:"Schedule removed",variant:"success"})}catch($){e({message:($==null?void 0:$.message)||"Failed to delete schedule",variant:"error"})}},z=V=>{var $;T(V.id),l(V.moduleId||""),h(V.title||""),m(($=V.scheduledAt)!=null&&$.toDate?bl(new Date(V.scheduledAt.toDate())):V.scheduledAt?bl(new Date(V.scheduledAt)):bl(new Date)),v(V.windowSeconds||60),N(V.requiredFields||{name:!1,surname:!1,initials:!1,email:!1,group:!1}),_(!!V.requireClassCode),D(V.recurrence||"none"),j((V.instructors||[]).join(", ")),w(!!V.concurrent)};return d.jsxs("div",{className:"space-y-6",children:[d.jsx(Ki,{title:"Schedules",description:"Create and manage scheduled attendance sessions."}),d.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[d.jsxs("form",{className:"rounded-md border border-stroke-subtle bg-white p-6 shadow-sm",onSubmit:ge,children:[d.jsx("h3",{className:"text-sm font-semibold text-text-muted",children:"New schedule"}),d.jsxs("div",{className:"mt-4 grid gap-3",children:[d.jsxs("select",{value:a,onChange:V=>l(V.target.value),className:"rounded-md border px-3 py-2",children:[d.jsx("option",{value:"",children:"Select module"}),r.map(V=>d.jsxs("option",{value:V.id,children:[V.moduleCode,V.moduleName?`  ${V.moduleName}`:""]},V.id))]}),d.jsx("input",{className:"rounded-md border px-3 py-2",placeholder:"Title (optional)",value:c,onChange:V=>h(V.target.value)}),d.jsx("input",{type:"datetime-local",className:"rounded-md border px-3 py-2",value:p,onChange:V=>m(V.target.value)}),d.jsxs("select",{value:x,onChange:V=>D(V.target.value),className:"rounded-md border px-3 py-2",children:[d.jsx("option",{value:"none",children:"No recurrence"}),d.jsx("option",{value:"daily",children:"Daily"}),d.jsx("option",{value:"weekly",children:"Weekly"})]}),d.jsx("input",{className:"rounded-md border px-3 py-2",placeholder:"Instructors (comma separated)",value:O,onChange:V=>j(V.target.value)}),d.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:nD.map(V=>d.jsxs("label",{className:`flex items-center gap-2 rounded-md border px-3 py-2 ${g===V.value?"border-brand-primary bg-surfaceAlt":"border-stroke-subtle"}`,children:[d.jsx("input",{type:"radio",name:"window",checked:g===V.value,onChange:()=>v(V.value)})," ",V.label]},V.value))}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("label",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"checkbox",checked:S,onChange:()=>_(V=>!V)})," Require class code"]}),d.jsxs("label",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"checkbox",checked:R,onChange:()=>w(V=>!V)})," Allow concurrent sessions"]})]}),d.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:Object.entries(E).map(([V,$])=>d.jsxs("label",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"checkbox",checked:$,onChange:()=>X(V)}),V]},V))}),d.jsxs("div",{className:"flex justify-end gap-2",children:[d.jsx("button",{type:"button",onClick:()=>{h(""),D("none"),j(""),w(!1),T(null)},className:"rounded-md border px-3 py-2",children:"Reset"}),d.jsx("button",{type:"submit",disabled:b,className:"rounded-md bg-gray-900 text-white px-4 py-2",children:C?"Update":"Save"})]})]})]}),d.jsx("div",{className:"space-y-3",children:i.map(V=>{var $,Q;return d.jsxs("div",{className:"rounded-md border bg-white p-4 shadow-sm flex items-start justify-between",children:[d.jsxs("div",{children:[d.jsx("div",{className:"text-sm font-semibold",children:V.title||(($=A[V.moduleId])==null?void 0:$.moduleCode)||"Untitled"}),d.jsx("div",{className:"text-xs text-text-muted",children:(Q=V.scheduledAt)!=null&&Q.toDate?new Date(V.scheduledAt.toDate()).toLocaleString():V.scheduledAt?new Date(V.scheduledAt).toLocaleString():""}),d.jsxs("div",{className:"text-xs text-text-muted mt-2",children:["Status: ",V.status||"queued"]}),d.jsxs("div",{className:"text-xs text-text-muted mt-1",children:["Recurrence: ",V.recurrence||"none"]}),d.jsxs("div",{className:"text-xs text-text-muted mt-1",children:["Instructors: ",(V.instructors||[]).join(", ")||""]}),d.jsxs("div",{className:"text-xs text-text-muted mt-1",children:["Concurrent sessions: ",V.concurrent?"Yes":"No"]})]}),d.jsxs("div",{className:"flex flex-col items-end gap-2",children:[d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>Se(V),disabled:V.status==="started"||b,className:"rounded-md bg-brand-primary text-white px-3 py-1 text-sm",children:"Start"}),d.jsx("button",{onClick:()=>z(V),className:"rounded-md border px-3 py-1 text-sm",children:"Edit"})]}),d.jsx("button",{onClick:()=>fe(V.id),className:"rounded-md border px-3 py-1 text-sm",children:"Delete"})]})]},V.id)})})]})]})}var sD=Object.defineProperty,Gu=Object.getOwnPropertySymbols,rS=Object.prototype.hasOwnProperty,sS=Object.prototype.propertyIsEnumerable,i_=(t,e,n)=>e in t?sD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,o_=(t,e)=>{for(var n in e||(e={}))rS.call(e,n)&&i_(t,n,e[n]);if(Gu)for(var n of Gu(e))sS.call(e,n)&&i_(t,n,e[n]);return t},iD=(t,e)=>{var n={};for(var r in t)rS.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Gu)for(var r of Gu(t))e.indexOf(r)<0&&sS.call(t,r)&&(n[r]=t[r]);return n};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Ns;(t=>{const e=class{constructor(l,c,h,p){if(this.version=l,this.errorCorrectionLevel=c,this.modules=[],this.isFunction=[],l<e.MIN_VERSION||l>e.MAX_VERSION)throw new RangeError("Version value out of range");if(p<-1||p>7)throw new RangeError("Mask value out of range");this.size=l*4+17;let m=[];for(let v=0;v<this.size;v++)m.push(!1);for(let v=0;v<this.size;v++)this.modules.push(m.slice()),this.isFunction.push(m.slice());this.drawFunctionPatterns();const g=this.addEccAndInterleave(h);if(this.drawCodewords(g),p==-1){let v=1e9;for(let E=0;E<8;E++){this.applyMask(E),this.drawFormatBits(E);const N=this.getPenaltyScore();N<v&&(p=E,v=N),this.applyMask(E)}}i(0<=p&&p<=7),this.mask=p,this.applyMask(p),this.drawFormatBits(p),this.isFunction=[]}static encodeText(l,c){const h=t.QrSegment.makeSegments(l);return e.encodeSegments(h,c)}static encodeBinary(l,c){const h=t.QrSegment.makeBytes(l);return e.encodeSegments([h],c)}static encodeSegments(l,c,h=1,p=40,m=-1,g=!0){if(!(e.MIN_VERSION<=h&&h<=p&&p<=e.MAX_VERSION)||m<-1||m>7)throw new RangeError("Invalid value");let v,E;for(v=h;;v++){const x=e.getNumDataCodewords(v,c)*8,D=a.getTotalBits(l,v);if(D<=x){E=D;break}if(v>=p)throw new RangeError("Data too long")}for(const x of[e.Ecc.MEDIUM,e.Ecc.QUARTILE,e.Ecc.HIGH])g&&E<=e.getNumDataCodewords(v,x)*8&&(c=x);let N=[];for(const x of l){r(x.mode.modeBits,4,N),r(x.numChars,x.mode.numCharCountBits(v),N);for(const D of x.getData())N.push(D)}i(N.length==E);const S=e.getNumDataCodewords(v,c)*8;i(N.length<=S),r(0,Math.min(4,S-N.length),N),r(0,(8-N.length%8)%8,N),i(N.length%8==0);for(let x=236;N.length<S;x^=253)r(x,8,N);let _=[];for(;_.length*8<N.length;)_.push(0);return N.forEach((x,D)=>_[D>>>3]|=x<<7-(D&7)),new e(v,c,_,m)}getModule(l,c){return 0<=l&&l<this.size&&0<=c&&c<this.size&&this.modules[c][l]}getModules(){return this.modules}drawFunctionPatterns(){for(let h=0;h<this.size;h++)this.setFunctionModule(6,h,h%2==0),this.setFunctionModule(h,6,h%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const l=this.getAlignmentPatternPositions(),c=l.length;for(let h=0;h<c;h++)for(let p=0;p<c;p++)h==0&&p==0||h==0&&p==c-1||h==c-1&&p==0||this.drawAlignmentPattern(l[h],l[p]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(l){const c=this.errorCorrectionLevel.formatBits<<3|l;let h=c;for(let m=0;m<10;m++)h=h<<1^(h>>>9)*1335;const p=(c<<10|h)^21522;i(p>>>15==0);for(let m=0;m<=5;m++)this.setFunctionModule(8,m,s(p,m));this.setFunctionModule(8,7,s(p,6)),this.setFunctionModule(8,8,s(p,7)),this.setFunctionModule(7,8,s(p,8));for(let m=9;m<15;m++)this.setFunctionModule(14-m,8,s(p,m));for(let m=0;m<8;m++)this.setFunctionModule(this.size-1-m,8,s(p,m));for(let m=8;m<15;m++)this.setFunctionModule(8,this.size-15+m,s(p,m));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let l=this.version;for(let h=0;h<12;h++)l=l<<1^(l>>>11)*7973;const c=this.version<<12|l;i(c>>>18==0);for(let h=0;h<18;h++){const p=s(c,h),m=this.size-11+h%3,g=Math.floor(h/3);this.setFunctionModule(m,g,p),this.setFunctionModule(g,m,p)}}drawFinderPattern(l,c){for(let h=-4;h<=4;h++)for(let p=-4;p<=4;p++){const m=Math.max(Math.abs(p),Math.abs(h)),g=l+p,v=c+h;0<=g&&g<this.size&&0<=v&&v<this.size&&this.setFunctionModule(g,v,m!=2&&m!=4)}}drawAlignmentPattern(l,c){for(let h=-2;h<=2;h++)for(let p=-2;p<=2;p++)this.setFunctionModule(l+p,c+h,Math.max(Math.abs(p),Math.abs(h))!=1)}setFunctionModule(l,c,h){this.modules[c][l]=h,this.isFunction[c][l]=!0}addEccAndInterleave(l){const c=this.version,h=this.errorCorrectionLevel;if(l.length!=e.getNumDataCodewords(c,h))throw new RangeError("Invalid argument");const p=e.NUM_ERROR_CORRECTION_BLOCKS[h.ordinal][c],m=e.ECC_CODEWORDS_PER_BLOCK[h.ordinal][c],g=Math.floor(e.getNumRawDataModules(c)/8),v=p-g%p,E=Math.floor(g/p);let N=[];const S=e.reedSolomonComputeDivisor(m);for(let x=0,D=0;x<p;x++){let O=l.slice(D,D+E-m+(x<v?0:1));D+=O.length;const j=e.reedSolomonComputeRemainder(O,S);x<v&&O.push(0),N.push(O.concat(j))}let _=[];for(let x=0;x<N[0].length;x++)N.forEach((D,O)=>{(x!=E-m||O>=v)&&_.push(D[x])});return i(_.length==g),_}drawCodewords(l){if(l.length!=Math.floor(e.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let c=0;for(let h=this.size-1;h>=1;h-=2){h==6&&(h=5);for(let p=0;p<this.size;p++)for(let m=0;m<2;m++){const g=h-m,E=(h+1&2)==0?this.size-1-p:p;!this.isFunction[E][g]&&c<l.length*8&&(this.modules[E][g]=s(l[c>>>3],7-(c&7)),c++)}}i(c==l.length*8)}applyMask(l){if(l<0||l>7)throw new RangeError("Mask value out of range");for(let c=0;c<this.size;c++)for(let h=0;h<this.size;h++){let p;switch(l){case 0:p=(h+c)%2==0;break;case 1:p=c%2==0;break;case 2:p=h%3==0;break;case 3:p=(h+c)%3==0;break;case 4:p=(Math.floor(h/3)+Math.floor(c/2))%2==0;break;case 5:p=h*c%2+h*c%3==0;break;case 6:p=(h*c%2+h*c%3)%2==0;break;case 7:p=((h+c)%2+h*c%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[c][h]&&p&&(this.modules[c][h]=!this.modules[c][h])}}getPenaltyScore(){let l=0;for(let m=0;m<this.size;m++){let g=!1,v=0,E=[0,0,0,0,0,0,0];for(let N=0;N<this.size;N++)this.modules[m][N]==g?(v++,v==5?l+=e.PENALTY_N1:v>5&&l++):(this.finderPenaltyAddHistory(v,E),g||(l+=this.finderPenaltyCountPatterns(E)*e.PENALTY_N3),g=this.modules[m][N],v=1);l+=this.finderPenaltyTerminateAndCount(g,v,E)*e.PENALTY_N3}for(let m=0;m<this.size;m++){let g=!1,v=0,E=[0,0,0,0,0,0,0];for(let N=0;N<this.size;N++)this.modules[N][m]==g?(v++,v==5?l+=e.PENALTY_N1:v>5&&l++):(this.finderPenaltyAddHistory(v,E),g||(l+=this.finderPenaltyCountPatterns(E)*e.PENALTY_N3),g=this.modules[N][m],v=1);l+=this.finderPenaltyTerminateAndCount(g,v,E)*e.PENALTY_N3}for(let m=0;m<this.size-1;m++)for(let g=0;g<this.size-1;g++){const v=this.modules[m][g];v==this.modules[m][g+1]&&v==this.modules[m+1][g]&&v==this.modules[m+1][g+1]&&(l+=e.PENALTY_N2)}let c=0;for(const m of this.modules)c=m.reduce((g,v)=>g+(v?1:0),c);const h=this.size*this.size,p=Math.ceil(Math.abs(c*20-h*10)/h)-1;return i(0<=p&&p<=9),l+=p*e.PENALTY_N4,i(0<=l&&l<=2568888),l}getAlignmentPatternPositions(){if(this.version==1)return[];{const l=Math.floor(this.version/7)+2,c=this.version==32?26:Math.ceil((this.version*4+4)/(l*2-2))*2;let h=[6];for(let p=this.size-7;h.length<l;p-=c)h.splice(1,0,p);return h}}static getNumRawDataModules(l){if(l<e.MIN_VERSION||l>e.MAX_VERSION)throw new RangeError("Version number out of range");let c=(16*l+128)*l+64;if(l>=2){const h=Math.floor(l/7)+2;c-=(25*h-10)*h-55,l>=7&&(c-=36)}return i(208<=c&&c<=29648),c}static getNumDataCodewords(l,c){return Math.floor(e.getNumRawDataModules(l)/8)-e.ECC_CODEWORDS_PER_BLOCK[c.ordinal][l]*e.NUM_ERROR_CORRECTION_BLOCKS[c.ordinal][l]}static reedSolomonComputeDivisor(l){if(l<1||l>255)throw new RangeError("Degree out of range");let c=[];for(let p=0;p<l-1;p++)c.push(0);c.push(1);let h=1;for(let p=0;p<l;p++){for(let m=0;m<c.length;m++)c[m]=e.reedSolomonMultiply(c[m],h),m+1<c.length&&(c[m]^=c[m+1]);h=e.reedSolomonMultiply(h,2)}return c}static reedSolomonComputeRemainder(l,c){let h=c.map(p=>0);for(const p of l){const m=p^h.shift();h.push(0),c.forEach((g,v)=>h[v]^=e.reedSolomonMultiply(g,m))}return h}static reedSolomonMultiply(l,c){if(l>>>8||c>>>8)throw new RangeError("Byte out of range");let h=0;for(let p=7;p>=0;p--)h=h<<1^(h>>>7)*285,h^=(c>>>p&1)*l;return i(h>>>8==0),h}finderPenaltyCountPatterns(l){const c=l[1];i(c<=this.size*3);const h=c>0&&l[2]==c&&l[3]==c*3&&l[4]==c&&l[5]==c;return(h&&l[0]>=c*4&&l[6]>=c?1:0)+(h&&l[6]>=c*4&&l[0]>=c?1:0)}finderPenaltyTerminateAndCount(l,c,h){return l&&(this.finderPenaltyAddHistory(c,h),c=0),c+=this.size,this.finderPenaltyAddHistory(c,h),this.finderPenaltyCountPatterns(h)}finderPenaltyAddHistory(l,c){c[0]==0&&(l+=this.size),c.pop(),c.unshift(l)}};let n=e;n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],t.QrCode=n;function r(l,c,h){if(c<0||c>31||l>>>c)throw new RangeError("Value out of range");for(let p=c-1;p>=0;p--)h.push(l>>>p&1)}function s(l,c){return(l>>>c&1)!=0}function i(l){if(!l)throw new Error("Assertion error")}const o=class{constructor(l,c,h){if(this.mode=l,this.numChars=c,this.bitData=h,c<0)throw new RangeError("Invalid argument");this.bitData=h.slice()}static makeBytes(l){let c=[];for(const h of l)r(h,8,c);return new o(o.Mode.BYTE,l.length,c)}static makeNumeric(l){if(!o.isNumeric(l))throw new RangeError("String contains non-numeric characters");let c=[];for(let h=0;h<l.length;){const p=Math.min(l.length-h,3);r(parseInt(l.substr(h,p),10),p*3+1,c),h+=p}return new o(o.Mode.NUMERIC,l.length,c)}static makeAlphanumeric(l){if(!o.isAlphanumeric(l))throw new RangeError("String contains unencodable characters in alphanumeric mode");let c=[],h;for(h=0;h+2<=l.length;h+=2){let p=o.ALPHANUMERIC_CHARSET.indexOf(l.charAt(h))*45;p+=o.ALPHANUMERIC_CHARSET.indexOf(l.charAt(h+1)),r(p,11,c)}return h<l.length&&r(o.ALPHANUMERIC_CHARSET.indexOf(l.charAt(h)),6,c),new o(o.Mode.ALPHANUMERIC,l.length,c)}static makeSegments(l){return l==""?[]:o.isNumeric(l)?[o.makeNumeric(l)]:o.isAlphanumeric(l)?[o.makeAlphanumeric(l)]:[o.makeBytes(o.toUtf8ByteArray(l))]}static makeEci(l){let c=[];if(l<0)throw new RangeError("ECI assignment value out of range");if(l<128)r(l,8,c);else if(l<16384)r(2,2,c),r(l,14,c);else if(l<1e6)r(6,3,c),r(l,21,c);else throw new RangeError("ECI assignment value out of range");return new o(o.Mode.ECI,0,c)}static isNumeric(l){return o.NUMERIC_REGEX.test(l)}static isAlphanumeric(l){return o.ALPHANUMERIC_REGEX.test(l)}getData(){return this.bitData.slice()}static getTotalBits(l,c){let h=0;for(const p of l){const m=p.mode.numCharCountBits(c);if(p.numChars>=1<<m)return 1/0;h+=4+m+p.bitData.length}return h}static toUtf8ByteArray(l){l=encodeURI(l);let c=[];for(let h=0;h<l.length;h++)l.charAt(h)!="%"?c.push(l.charCodeAt(h)):(c.push(parseInt(l.substr(h+1,2),16)),h+=2);return c}};let a=o;a.NUMERIC_REGEX=/^[0-9]*$/,a.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,a.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",t.QrSegment=a})(Ns||(Ns={}));(t=>{(e=>{const n=class{constructor(s,i){this.ordinal=s,this.formatBits=i}};let r=n;r.LOW=new n(0,1),r.MEDIUM=new n(1,0),r.QUARTILE=new n(2,3),r.HIGH=new n(3,2),e.Ecc=r})(t.QrCode||(t.QrCode={}))})(Ns||(Ns={}));(t=>{(e=>{const n=class{constructor(s,i){this.modeBits=s,this.numBitsCharCount=i}numCharCountBits(s){return this.numBitsCharCount[Math.floor((s+7)/17)]}};let r=n;r.NUMERIC=new n(1,[10,12,14]),r.ALPHANUMERIC=new n(2,[9,11,13]),r.BYTE=new n(4,[8,16,16]),r.KANJI=new n(8,[8,10,12]),r.ECI=new n(7,[0,0,0]),e.Mode=r})(t.QrSegment||(t.QrSegment={}))})(Ns||(Ns={}));var Do=Ns;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var oD={L:Do.QrCode.Ecc.LOW,M:Do.QrCode.Ecc.MEDIUM,Q:Do.QrCode.Ecc.QUARTILE,H:Do.QrCode.Ecc.HIGH},aD=128,lD="L",uD="#FFFFFF",cD="#000000",dD=!1,iS=4,hD=.1;function fD(t,e=0){const n=[];return t.forEach(function(r,s){let i=null;r.forEach(function(o,a){if(!o&&i!==null){n.push(`M${i+e} ${s+e}h${a-i}v1H${i+e}z`),i=null;return}if(a===r.length-1){if(!o)return;i===null?n.push(`M${a+e},${s+e} h1v1H${a+e}z`):n.push(`M${i+e},${s+e} h${a+1-i}v1H${i+e}z`);return}o&&i===null&&(i=a)})}),n.join("")}function pD(t,e){return t.slice().map((n,r)=>r<e.y||r>=e.y+e.h?n:n.map((s,i)=>i<e.x||i>=e.x+e.w?s:!1))}function mD(t,e,n,r){if(r==null)return null;const s=n?iS:0,i=t.length+s*2,o=Math.floor(e*hD),a=i/e,l=(r.width||o)*a,c=(r.height||o)*a,h=r.x==null?t.length/2-l/2:r.x*a,p=r.y==null?t.length/2-c/2:r.y*a;let m=null;if(r.excavate){let g=Math.floor(h),v=Math.floor(p),E=Math.ceil(l+h-g),N=Math.ceil(c+p-v);m={x:g,y:v,w:E,h:N}}return{x:h,y:p,h:c,w:l,excavation:m}}var gD=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}();function oS(t){const e=t,{value:n,size:r=aD,level:s=lD,bgColor:i=uD,fgColor:o=cD,includeMargin:a=dD,style:l,imageSettings:c}=e,h=iD(e,["value","size","level","bgColor","fgColor","includeMargin","style","imageSettings"]),p=c==null?void 0:c.src,m=fn.useRef(null),g=fn.useRef(null),[v,E]=fn.useState(!1);fn.useEffect(()=>{if(m.current!=null){const _=m.current,x=_.getContext("2d");if(!x)return;let D=Do.QrCode.encodeText(n,oD[s]).getModules();const O=a?iS:0,j=D.length+O*2,R=mD(D,r,a,c),w=g.current,C=R!=null&&w!==null&&w.complete&&w.naturalHeight!==0&&w.naturalWidth!==0;C&&R.excavation!=null&&(D=pD(D,R.excavation));const T=window.devicePixelRatio||1;_.height=_.width=r*T;const b=r/j*T;x.scale(b,b),x.fillStyle=i,x.fillRect(0,0,j,j),x.fillStyle=o,gD?x.fill(new Path2D(fD(D,O))):D.forEach(function(P,A){P.forEach(function(X,ge){X&&x.fillRect(ge+O,A+O,1,1)})}),C&&x.drawImage(w,R.x+O,R.y+O,R.w,R.h)}}),fn.useEffect(()=>{E(!1)},[p]);const N=o_({height:r,width:r},l);let S=null;return p!=null&&(S=fn.createElement("img",{src:p,key:p,style:{display:"none"},onLoad:()=>{E(!0)},ref:g})),fn.createElement(fn.Fragment,null,fn.createElement("canvas",o_({style:N,height:r,width:r,ref:m},h)),S)}/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aS=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yD=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vD=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase());/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a_=t=>{const e=vD(t);return e.charAt(0).toUpperCase()+e.slice(1)};/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var _D={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wD=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xD=k.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...a},l)=>k.createElement("svg",{ref:l,..._D,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:aS("lucide",s),...!i&&!wD(a)&&{"aria-hidden":"true"},...a},[...o.map(([c,h])=>k.createElement(c,h)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=(t,e)=>{const n=k.forwardRef(({className:r,...s},i)=>k.createElement(xD,{ref:i,iconNode:e,className:aS(`lucide-${yD(a_(t))}`,`lucide-${t}`,r),...s}));return n.displayName=a_(t),n};/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ED=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],SD=Qe("book-open",ED);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CD=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ID=Qe("calendar",CD);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TD=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],RD=Qe("chart-column",TD);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],l_=Qe("circle-alert",AD);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ND=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],lS=Qe("circle-check-big",ND);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bD=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],uS=Qe("circle-play",bD);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],PD=Qe("circle-x",kD);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 6v6l4 2",key:"mmk7yg"}]],jD=Qe("clock",DD);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MD=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],VD=Qe("copy",MD);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OD=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],LD=Qe("history",OD);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FD=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],UD=Qe("key",FD);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $D=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],zD=Qe("layout-dashboard",$D);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BD=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],qD=Qe("menu",BD);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HD=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],GD=Qe("qr-code",HD);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WD=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],KD=Qe("search",WD);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QD=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],YD=Qe("settings",QD);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XD=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],JD=Qe("timer",XD);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZD=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],cS=Qe("users",ZD);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ej=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],tj=Qe("x",ej);function nj(t){if(t<=0)return"00:00";const e=Math.floor(t/60),n=t%60;return`${e.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}function rj(t,e,n){return n?{label:"Ended",color:"bg-gray-500/15 text-gray-200 border-gray-500/25",icon:PD}:t?e?{label:"Expired",color:"bg-red-500/15 text-red-200 border-red-500/25",icon:l_}:{label:"Live",color:"bg-emerald-500/15 text-emerald-200 border-emerald-500/25",icon:lS}:{label:"Inactive",color:"bg-amber-500/15 text-amber-200 border-amber-500/25",icon:l_}}function sj(){var R,w,C;const{sessionId:t}=Na(),[e,n]=k.useState(null),[r,s]=k.useState({}),[i,o]=k.useState(null),[a,l]=k.useState(30),[c,h]=k.useState(0);k.useEffect(()=>{const T=setInterval(()=>h(b=>b+1),1e3);return()=>clearInterval(T)},[]),k.useEffect(()=>{if(!t)return;const T=nt(ue,"sessions",t),b=ct(T,P=>{var ge,Se,fe;const A=P.data();if(!A)return;const X=(Se=(ge=A.qr)==null?void 0:ge.expiresAt)!=null&&Se.toDate?A.qr.expiresAt.toDate():(fe=A.expiresAt)!=null&&fe.toDate?A.expiresAt.toDate():null;n({moduleCode:A.moduleCode,title:A.title,isActive:A.isActive,qrExpiresAt:X,stats:A.stats,settings:A.settings||{}})});return()=>b()},[t]),k.useEffect(()=>{if(!t)return;const T=nt(ue,"sessionsPrivate",t),b=ct(T,P=>{var X;const A=P.data();A&&s({classCode:A.classCodePlain||null,token:A.qrTokenPlain||null,expiresAt:(X=A.qrExpiresAt)!=null&&X.toDate?A.qrExpiresAt.toDate():null})});return()=>b()},[t]),k.useEffect(()=>{var A;let T=null,b=!0;async function P(){var X,ge,Se;if(!(!t||!(e!=null&&e.isActive)||!((X=e==null?void 0:e.settings)!=null&&X.requireClassCode)))try{const z=await tn(nn,"getSessionPin")({sessionId:t});if(!b)return;o(((ge=z.data)==null?void 0:ge.pin)||null),l(Number(((Se=z.data)==null?void 0:Se.rotationSeconds)||30))}catch(fe){console.error("getSessionPin error (display):",fe)}}return e!=null&&e.isActive&&((A=e==null?void 0:e.settings)!=null&&A.requireClassCode)&&(P(),T=window.setInterval(P,Math.max(1e3,a*1e3))),()=>{b=!1,T&&clearInterval(T)}},[t,e==null?void 0:e.isActive,(R=e==null?void 0:e.settings)==null?void 0:R.requireClassCode,a]);const p=r.expiresAt||(e==null?void 0:e.qrExpiresAt)||null,m=k.useMemo(()=>p?Math.max(0,Math.floor((p.getTime()-Date.now())/1e3)):0,[p,c]),g=k.useMemo(()=>!t||!r.token?"":`${window.location.origin}/s/${t}?t=${r.token}`,[t,r.token]),v=(e==null?void 0:e.isActive)===!1,E=p?p.getTime()<=Date.now():!1,N=!!(e!=null&&e.isActive)&&!E&&!v,S=N&&!!((w=e==null?void 0:e.settings)!=null&&w.requireClassCode)&&!!(i||r.classCode),_=N&&!!r.token,x=rj(!!(e!=null&&e.isActive),E,v),D=x.icon,O=((C=e==null?void 0:e.stats)==null?void 0:C.submissionsCount)??0,j=k.useMemo(()=>{if(!p||!(e!=null&&e.qrExpiresAt))return 0;const T=Math.max(1,e.qrExpiresAt.getTime()-Date.now()),b=Math.max(0,p.getTime()-Date.now());return Math.max(0,Math.min(100,b/T*100))},[p,e==null?void 0:e.qrExpiresAt,c]);return e?d.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-900 to-gray-800 text-white",children:[d.jsx("div",{className:"pointer-events-none absolute inset-0 bg-grid-white/[0.02] bg-[size:60px_60px]"}),d.jsx("div",{className:"relative min-h-screen flex items-center justify-center p-6",children:d.jsx("div",{className:"max-w-6xl w-full",children:d.jsxs("div",{className:"grid lg:grid-cols-2 gap-10 items-center",children:[d.jsxs("div",{className:"flex flex-col items-center",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute -inset-5 bg-gradient-to-r from-blue-500/20 to-emerald-500/20 rounded-3xl blur-2xl"}),d.jsx("div",{className:"relative bg-white rounded-2xl p-4 shadow-2xl",children:_&&g?d.jsx(oS,{value:g,size:380,includeMargin:!0,level:"H",className:"rounded-lg"}):d.jsxs("div",{className:"w-[380px] h-[380px] flex flex-col items-center justify-center bg-gray-100 rounded-lg",children:[d.jsx(GD,{className:"h-16 w-16 text-gray-400 mb-3"}),d.jsx("span",{className:"text-gray-500 font-medium",children:v?"Session ended":E?"QR expired":"Waiting for QR..."})]})}),N?d.jsxs("div",{className:"absolute -top-2 -right-2 flex items-center gap-2 bg-emerald-500 text-white px-3 py-1.5 rounded-full text-sm font-semibold shadow-lg",children:[d.jsxs("span",{className:"relative flex h-2 w-2",children:[d.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-white opacity-75"}),d.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-white"})]}),"LIVE"]}):null]}),d.jsx("div",{className:"mt-5 w-full max-w-[380px] text-center",children:d.jsx("p",{className:"text-sm text-gray-300",children:"Scan the QR code to submit attendance"})})]}),d.jsx("div",{className:"text-center lg:text-left",children:d.jsxs("div",{className:"space-y-7",children:[d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border px-4 py-2 text-sm font-semibold w-fit mx-auto lg:mx-0 border-white/10 bg-white/5",children:[d.jsxs("span",{className:`inline-flex items-center gap-2 rounded-full border px-3 py-1 ${x.color}`,children:[d.jsx(D,{className:"h-4 w-4"}),x.label]}),d.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-1 text-white/85",children:[d.jsx(cS,{className:"h-4 w-4 opacity-80"}),d.jsx("span",{className:"tabular-nums",children:O}),d.jsx("span",{className:"text-white/60",children:"submissions"})]})]}),d.jsx("h1",{className:"text-4xl lg:text-5xl font-bold text-white",children:(e==null?void 0:e.moduleCode)||"Session"}),e!=null&&e.title?d.jsx("p",{className:"text-lg text-gray-300",children:e.title}):null]}),N?d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center justify-center lg:justify-start gap-3",children:[d.jsx(jD,{className:"h-6 w-6 text-gray-300"}),d.jsx("span",{className:"text-6xl lg:text-7xl font-bold text-white tabular-nums",children:nj(m)})]}),d.jsx("div",{className:"w-full h-2 bg-white/10 rounded-full overflow-hidden",children:d.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-emerald-500 transition-all duration-1000",style:{width:`${j}%`}})}),d.jsx("p",{className:"text-sm text-gray-400",children:"Submit before the timer reaches zero."})]}):null,S?d.jsxs("div",{className:"space-y-2",children:[d.jsx("p",{className:"text-sm font-medium text-gray-400 uppercase tracking-wider",children:"Class entry code"}),d.jsxs("div",{className:"inline-flex items-center gap-3 bg-white/10 border border-white/20 rounded-2xl px-8 py-4",children:[d.jsx(UD,{className:"h-6 w-6 text-gray-300"}),d.jsx("span",{className:"text-4xl lg:text-5xl font-mono font-bold text-white tracking-[0.25em]",children:i||r.classCode})]}),d.jsxs("p",{className:"text-xs text-gray-500",children:["Code refreshes every ",a," seconds"]})]}):null,v?d.jsxs("div",{className:"mt-2 p-6 bg-white/5 border border-white/10 rounded-2xl",children:[d.jsx("p",{className:"text-lg text-gray-200 font-semibold",children:"Session ended"}),d.jsxs("p",{className:"mt-2 text-sm text-gray-400",children:["Final submissions: ",d.jsx("span",{className:"text-white font-semibold",children:O})]})]}):!v&&E?d.jsxs("div",{className:"mt-2 p-6 bg-amber-500/10 border border-amber-500/20 rounded-2xl",children:[d.jsx("p",{className:"text-lg text-amber-200 font-semibold",children:"QR expired"}),d.jsx("p",{className:"mt-2 text-sm text-amber-200/70",children:"Please wait for the instructor to renew it."})]}):null]})})]})})})]}):d.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-900 to-gray-800 flex items-center justify-center",children:d.jsx("div",{className:"text-gray-300",children:"Loading display"})})}/**
   * table-core
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function Pr(t,e){return typeof t=="function"?t(e):t}function Qt(t,e){return n=>{e.setState(r=>({...r,[t]:Pr(n,r[t])}))}}function Lc(t){return t instanceof Function}function ij(t){return Array.isArray(t)&&t.every(e=>typeof e=="number")}function oj(t,e){const n=[],r=s=>{s.forEach(i=>{n.push(i);const o=e(i);o!=null&&o.length&&r(o)})};return r(t),n}function J(t,e,n){let r=[],s;return i=>{let o;n.key&&n.debug&&(o=Date.now());const a=t(i);if(!(a.length!==r.length||a.some((h,p)=>r[p]!==h)))return s;r=a;let c;if(n.key&&n.debug&&(c=Date.now()),s=e(...a),n==null||n.onChange==null||n.onChange(s),n.key&&n.debug&&n!=null&&n.debug()){const h=Math.round((Date.now()-o)*100)/100,p=Math.round((Date.now()-c)*100)/100,m=p/16,g=(v,E)=>{for(v=String(v);v.length<E;)v=" "+v;return v};console.info(`%c ${g(p,5)} /${g(h,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*m,120))}deg 100% 31%);`,n==null?void 0:n.key)}return s}}function Z(t,e,n,r){return{debug:()=>{var s;return(s=t==null?void 0:t.debugAll)!=null?s:t[e]},key:!1,onChange:r}}function aj(t,e,n,r){const s=()=>{var o;return(o=i.getValue())!=null?o:t.options.renderFallbackValue},i={id:`${e.id}_${n.id}`,row:e,column:n,getValue:()=>e.getValue(r),renderValue:s,getContext:J(()=>[t,n,e,i],(o,a,l,c)=>({table:o,column:a,row:l,cell:c,getValue:c.getValue,renderValue:c.renderValue}),Z(t.options,"debugCells"))};return t._features.forEach(o=>{o.createCell==null||o.createCell(i,n,e,t)},{}),i}function lj(t,e,n,r){var s,i;const a={...t._getDefaultColumnDef(),...e},l=a.accessorKey;let c=(s=(i=a.id)!=null?i:l?typeof String.prototype.replaceAll=="function"?l.replaceAll(".","_"):l.replace(/\./g,"_"):void 0)!=null?s:typeof a.header=="string"?a.header:void 0,h;if(a.accessorFn?h=a.accessorFn:l&&(l.includes(".")?h=m=>{let g=m;for(const E of l.split(".")){var v;g=(v=g)==null?void 0:v[E]}return g}:h=m=>m[a.accessorKey]),!c)throw new Error;let p={id:`${String(c)}`,accessorFn:h,parent:r,depth:n,columnDef:a,columns:[],getFlatColumns:J(()=>[!0],()=>{var m;return[p,...(m=p.columns)==null?void 0:m.flatMap(g=>g.getFlatColumns())]},Z(t.options,"debugColumns")),getLeafColumns:J(()=>[t._getOrderColumnsFn()],m=>{var g;if((g=p.columns)!=null&&g.length){let v=p.columns.flatMap(E=>E.getLeafColumns());return m(v)}return[p]},Z(t.options,"debugColumns"))};for(const m of t._features)m.createColumn==null||m.createColumn(p,t);return p}const wt="debugHeaders";function u_(t,e,n){var r;let i={id:(r=n.id)!=null?r:e.id,column:e,index:n.index,isPlaceholder:!!n.isPlaceholder,placeholderId:n.placeholderId,depth:n.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const o=[],a=l=>{l.subHeaders&&l.subHeaders.length&&l.subHeaders.map(a),o.push(l)};return a(i),o},getContext:()=>({table:t,header:i,column:e})};return t._features.forEach(o=>{o.createHeader==null||o.createHeader(i,t)}),i}const uj={createTable:t=>{t.getHeaderGroups=J(()=>[t.getAllColumns(),t.getVisibleLeafColumns(),t.getState().columnPinning.left,t.getState().columnPinning.right],(e,n,r,s)=>{var i,o;const a=(i=r==null?void 0:r.map(p=>n.find(m=>m.id===p)).filter(Boolean))!=null?i:[],l=(o=s==null?void 0:s.map(p=>n.find(m=>m.id===p)).filter(Boolean))!=null?o:[],c=n.filter(p=>!(r!=null&&r.includes(p.id))&&!(s!=null&&s.includes(p.id)));return kl(e,[...a,...c,...l],t)},Z(t.options,wt)),t.getCenterHeaderGroups=J(()=>[t.getAllColumns(),t.getVisibleLeafColumns(),t.getState().columnPinning.left,t.getState().columnPinning.right],(e,n,r,s)=>(n=n.filter(i=>!(r!=null&&r.includes(i.id))&&!(s!=null&&s.includes(i.id))),kl(e,n,t,"center")),Z(t.options,wt)),t.getLeftHeaderGroups=J(()=>[t.getAllColumns(),t.getVisibleLeafColumns(),t.getState().columnPinning.left],(e,n,r)=>{var s;const i=(s=r==null?void 0:r.map(o=>n.find(a=>a.id===o)).filter(Boolean))!=null?s:[];return kl(e,i,t,"left")},Z(t.options,wt)),t.getRightHeaderGroups=J(()=>[t.getAllColumns(),t.getVisibleLeafColumns(),t.getState().columnPinning.right],(e,n,r)=>{var s;const i=(s=r==null?void 0:r.map(o=>n.find(a=>a.id===o)).filter(Boolean))!=null?s:[];return kl(e,i,t,"right")},Z(t.options,wt)),t.getFooterGroups=J(()=>[t.getHeaderGroups()],e=>[...e].reverse(),Z(t.options,wt)),t.getLeftFooterGroups=J(()=>[t.getLeftHeaderGroups()],e=>[...e].reverse(),Z(t.options,wt)),t.getCenterFooterGroups=J(()=>[t.getCenterHeaderGroups()],e=>[...e].reverse(),Z(t.options,wt)),t.getRightFooterGroups=J(()=>[t.getRightHeaderGroups()],e=>[...e].reverse(),Z(t.options,wt)),t.getFlatHeaders=J(()=>[t.getHeaderGroups()],e=>e.map(n=>n.headers).flat(),Z(t.options,wt)),t.getLeftFlatHeaders=J(()=>[t.getLeftHeaderGroups()],e=>e.map(n=>n.headers).flat(),Z(t.options,wt)),t.getCenterFlatHeaders=J(()=>[t.getCenterHeaderGroups()],e=>e.map(n=>n.headers).flat(),Z(t.options,wt)),t.getRightFlatHeaders=J(()=>[t.getRightHeaderGroups()],e=>e.map(n=>n.headers).flat(),Z(t.options,wt)),t.getCenterLeafHeaders=J(()=>[t.getCenterFlatHeaders()],e=>e.filter(n=>{var r;return!((r=n.subHeaders)!=null&&r.length)}),Z(t.options,wt)),t.getLeftLeafHeaders=J(()=>[t.getLeftFlatHeaders()],e=>e.filter(n=>{var r;return!((r=n.subHeaders)!=null&&r.length)}),Z(t.options,wt)),t.getRightLeafHeaders=J(()=>[t.getRightFlatHeaders()],e=>e.filter(n=>{var r;return!((r=n.subHeaders)!=null&&r.length)}),Z(t.options,wt)),t.getLeafHeaders=J(()=>[t.getLeftHeaderGroups(),t.getCenterHeaderGroups(),t.getRightHeaderGroups()],(e,n,r)=>{var s,i,o,a,l,c;return[...(s=(i=e[0])==null?void 0:i.headers)!=null?s:[],...(o=(a=n[0])==null?void 0:a.headers)!=null?o:[],...(l=(c=r[0])==null?void 0:c.headers)!=null?l:[]].map(h=>h.getLeafHeaders()).flat()},Z(t.options,wt))}};function kl(t,e,n,r){var s,i;let o=0;const a=function(m,g){g===void 0&&(g=1),o=Math.max(o,g),m.filter(v=>v.getIsVisible()).forEach(v=>{var E;(E=v.columns)!=null&&E.length&&a(v.columns,g+1)},0)};a(t);let l=[];const c=(m,g)=>{const v={depth:g,id:[r,`${g}`].filter(Boolean).join("_"),headers:[]},E=[];m.forEach(N=>{const S=[...E].reverse()[0],_=N.column.depth===v.depth;let x,D=!1;if(_&&N.column.parent?x=N.column.parent:(x=N.column,D=!0),S&&(S==null?void 0:S.column)===x)S.subHeaders.push(N);else{const O=u_(n,x,{id:[r,g,x.id,N==null?void 0:N.id].filter(Boolean).join("_"),isPlaceholder:D,placeholderId:D?`${E.filter(j=>j.column===x).length}`:void 0,depth:g,index:E.length});O.subHeaders.push(N),E.push(O)}v.headers.push(N),N.headerGroup=v}),l.push(v),g>0&&c(E,g-1)},h=e.map((m,g)=>u_(n,m,{depth:o,index:g}));c(h,o-1),l.reverse();const p=m=>m.filter(v=>v.column.getIsVisible()).map(v=>{let E=0,N=0,S=[0];v.subHeaders&&v.subHeaders.length?(S=[],p(v.subHeaders).forEach(x=>{let{colSpan:D,rowSpan:O}=x;E+=D,S.push(O)})):E=1;const _=Math.min(...S);return N=N+_,v.colSpan=E,v.rowSpan=N,{colSpan:E,rowSpan:N}});return p((s=(i=l[0])==null?void 0:i.headers)!=null?s:[]),l}const Am=(t,e,n,r,s,i,o)=>{let a={id:e,index:r,original:n,depth:s,parentId:o,_valuesCache:{},_uniqueValuesCache:{},getValue:l=>{if(a._valuesCache.hasOwnProperty(l))return a._valuesCache[l];const c=t.getColumn(l);if(c!=null&&c.accessorFn)return a._valuesCache[l]=c.accessorFn(a.original,r),a._valuesCache[l]},getUniqueValues:l=>{if(a._uniqueValuesCache.hasOwnProperty(l))return a._uniqueValuesCache[l];const c=t.getColumn(l);if(c!=null&&c.accessorFn)return c.columnDef.getUniqueValues?(a._uniqueValuesCache[l]=c.columnDef.getUniqueValues(a.original,r),a._uniqueValuesCache[l]):(a._uniqueValuesCache[l]=[a.getValue(l)],a._uniqueValuesCache[l])},renderValue:l=>{var c;return(c=a.getValue(l))!=null?c:t.options.renderFallbackValue},subRows:[],getLeafRows:()=>oj(a.subRows,l=>l.subRows),getParentRow:()=>a.parentId?t.getRow(a.parentId,!0):void 0,getParentRows:()=>{let l=[],c=a;for(;;){const h=c.getParentRow();if(!h)break;l.push(h),c=h}return l.reverse()},getAllCells:J(()=>[t.getAllLeafColumns()],l=>l.map(c=>aj(t,a,c,c.id)),Z(t.options,"debugRows")),_getAllCellsByColumnId:J(()=>[a.getAllCells()],l=>l.reduce((c,h)=>(c[h.column.id]=h,c),{}),Z(t.options,"debugRows"))};for(let l=0;l<t._features.length;l++){const c=t._features[l];c==null||c.createRow==null||c.createRow(a,t)}return a},cj={createColumn:(t,e)=>{t._getFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,t.id),t.getFacetedRowModel=()=>t._getFacetedRowModel?t._getFacetedRowModel():e.getPreFilteredRowModel(),t._getFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,t.id),t.getFacetedUniqueValues=()=>t._getFacetedUniqueValues?t._getFacetedUniqueValues():new Map,t._getFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,t.id),t.getFacetedMinMaxValues=()=>{if(t._getFacetedMinMaxValues)return t._getFacetedMinMaxValues()}}},dS=(t,e,n)=>{var r,s;const i=n==null||(r=n.toString())==null?void 0:r.toLowerCase();return!!(!((s=t.getValue(e))==null||(s=s.toString())==null||(s=s.toLowerCase())==null)&&s.includes(i))};dS.autoRemove=t=>_n(t);const hS=(t,e,n)=>{var r;return!!(!((r=t.getValue(e))==null||(r=r.toString())==null)&&r.includes(n))};hS.autoRemove=t=>_n(t);const fS=(t,e,n)=>{var r;return((r=t.getValue(e))==null||(r=r.toString())==null?void 0:r.toLowerCase())===(n==null?void 0:n.toLowerCase())};fS.autoRemove=t=>_n(t);const pS=(t,e,n)=>{var r;return(r=t.getValue(e))==null?void 0:r.includes(n)};pS.autoRemove=t=>_n(t);const mS=(t,e,n)=>!n.some(r=>{var s;return!((s=t.getValue(e))!=null&&s.includes(r))});mS.autoRemove=t=>_n(t)||!(t!=null&&t.length);const gS=(t,e,n)=>n.some(r=>{var s;return(s=t.getValue(e))==null?void 0:s.includes(r)});gS.autoRemove=t=>_n(t)||!(t!=null&&t.length);const yS=(t,e,n)=>t.getValue(e)===n;yS.autoRemove=t=>_n(t);const vS=(t,e,n)=>t.getValue(e)==n;vS.autoRemove=t=>_n(t);const Nm=(t,e,n)=>{let[r,s]=n;const i=t.getValue(e);return i>=r&&i<=s};Nm.resolveFilterValue=t=>{let[e,n]=t,r=typeof e!="number"?parseFloat(e):e,s=typeof n!="number"?parseFloat(n):n,i=e===null||Number.isNaN(r)?-1/0:r,o=n===null||Number.isNaN(s)?1/0:s;if(i>o){const a=i;i=o,o=a}return[i,o]};Nm.autoRemove=t=>_n(t)||_n(t[0])&&_n(t[1]);const zn={includesString:dS,includesStringSensitive:hS,equalsString:fS,arrIncludes:pS,arrIncludesAll:mS,arrIncludesSome:gS,equals:yS,weakEquals:vS,inNumberRange:Nm};function _n(t){return t==null||t===""}const dj={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:t=>({columnFilters:[],...t}),getDefaultOptions:t=>({onColumnFiltersChange:Qt("columnFilters",t),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(t,e)=>{t.getAutoFilterFn=()=>{const n=e.getCoreRowModel().flatRows[0],r=n==null?void 0:n.getValue(t.id);return typeof r=="string"?zn.includesString:typeof r=="number"?zn.inNumberRange:typeof r=="boolean"||r!==null&&typeof r=="object"?zn.equals:Array.isArray(r)?zn.arrIncludes:zn.weakEquals},t.getFilterFn=()=>{var n,r;return Lc(t.columnDef.filterFn)?t.columnDef.filterFn:t.columnDef.filterFn==="auto"?t.getAutoFilterFn():(n=(r=e.options.filterFns)==null?void 0:r[t.columnDef.filterFn])!=null?n:zn[t.columnDef.filterFn]},t.getCanFilter=()=>{var n,r,s;return((n=t.columnDef.enableColumnFilter)!=null?n:!0)&&((r=e.options.enableColumnFilters)!=null?r:!0)&&((s=e.options.enableFilters)!=null?s:!0)&&!!t.accessorFn},t.getIsFiltered=()=>t.getFilterIndex()>-1,t.getFilterValue=()=>{var n;return(n=e.getState().columnFilters)==null||(n=n.find(r=>r.id===t.id))==null?void 0:n.value},t.getFilterIndex=()=>{var n,r;return(n=(r=e.getState().columnFilters)==null?void 0:r.findIndex(s=>s.id===t.id))!=null?n:-1},t.setFilterValue=n=>{e.setColumnFilters(r=>{const s=t.getFilterFn(),i=r==null?void 0:r.find(h=>h.id===t.id),o=Pr(n,i?i.value:void 0);if(c_(s,o,t)){var a;return(a=r==null?void 0:r.filter(h=>h.id!==t.id))!=null?a:[]}const l={id:t.id,value:o};if(i){var c;return(c=r==null?void 0:r.map(h=>h.id===t.id?l:h))!=null?c:[]}return r!=null&&r.length?[...r,l]:[l]})}},createRow:(t,e)=>{t.columnFilters={},t.columnFiltersMeta={}},createTable:t=>{t.setColumnFilters=e=>{const n=t.getAllLeafColumns(),r=s=>{var i;return(i=Pr(e,s))==null?void 0:i.filter(o=>{const a=n.find(l=>l.id===o.id);if(a){const l=a.getFilterFn();if(c_(l,o.value,a))return!1}return!0})};t.options.onColumnFiltersChange==null||t.options.onColumnFiltersChange(r)},t.resetColumnFilters=e=>{var n,r;t.setColumnFilters(e?[]:(n=(r=t.initialState)==null?void 0:r.columnFilters)!=null?n:[])},t.getPreFilteredRowModel=()=>t.getCoreRowModel(),t.getFilteredRowModel=()=>(!t._getFilteredRowModel&&t.options.getFilteredRowModel&&(t._getFilteredRowModel=t.options.getFilteredRowModel(t)),t.options.manualFiltering||!t._getFilteredRowModel?t.getPreFilteredRowModel():t._getFilteredRowModel())}};function c_(t,e,n){return(t&&t.autoRemove?t.autoRemove(e,n):!1)||typeof e>"u"||typeof e=="string"&&!e}const hj=(t,e,n)=>n.reduce((r,s)=>{const i=s.getValue(t);return r+(typeof i=="number"?i:0)},0),fj=(t,e,n)=>{let r;return n.forEach(s=>{const i=s.getValue(t);i!=null&&(r>i||r===void 0&&i>=i)&&(r=i)}),r},pj=(t,e,n)=>{let r;return n.forEach(s=>{const i=s.getValue(t);i!=null&&(r<i||r===void 0&&i>=i)&&(r=i)}),r},mj=(t,e,n)=>{let r,s;return n.forEach(i=>{const o=i.getValue(t);o!=null&&(r===void 0?o>=o&&(r=s=o):(r>o&&(r=o),s<o&&(s=o)))}),[r,s]},gj=(t,e)=>{let n=0,r=0;if(e.forEach(s=>{let i=s.getValue(t);i!=null&&(i=+i)>=i&&(++n,r+=i)}),n)return r/n},yj=(t,e)=>{if(!e.length)return;const n=e.map(i=>i.getValue(t));if(!ij(n))return;if(n.length===1)return n[0];const r=Math.floor(n.length/2),s=n.sort((i,o)=>i-o);return n.length%2!==0?s[r]:(s[r-1]+s[r])/2},vj=(t,e)=>Array.from(new Set(e.map(n=>n.getValue(t))).values()),_j=(t,e)=>new Set(e.map(n=>n.getValue(t))).size,wj=(t,e)=>e.length,zd={sum:hj,min:fj,max:pj,extent:mj,mean:gj,median:yj,unique:vj,uniqueCount:_j,count:wj},xj={getDefaultColumnDef:()=>({aggregatedCell:t=>{var e,n;return(e=(n=t.getValue())==null||n.toString==null?void 0:n.toString())!=null?e:null},aggregationFn:"auto"}),getInitialState:t=>({grouping:[],...t}),getDefaultOptions:t=>({onGroupingChange:Qt("grouping",t),groupedColumnMode:"reorder"}),createColumn:(t,e)=>{t.toggleGrouping=()=>{e.setGrouping(n=>n!=null&&n.includes(t.id)?n.filter(r=>r!==t.id):[...n??[],t.id])},t.getCanGroup=()=>{var n,r;return((n=t.columnDef.enableGrouping)!=null?n:!0)&&((r=e.options.enableGrouping)!=null?r:!0)&&(!!t.accessorFn||!!t.columnDef.getGroupingValue)},t.getIsGrouped=()=>{var n;return(n=e.getState().grouping)==null?void 0:n.includes(t.id)},t.getGroupedIndex=()=>{var n;return(n=e.getState().grouping)==null?void 0:n.indexOf(t.id)},t.getToggleGroupingHandler=()=>{const n=t.getCanGroup();return()=>{n&&t.toggleGrouping()}},t.getAutoAggregationFn=()=>{const n=e.getCoreRowModel().flatRows[0],r=n==null?void 0:n.getValue(t.id);if(typeof r=="number")return zd.sum;if(Object.prototype.toString.call(r)==="[object Date]")return zd.extent},t.getAggregationFn=()=>{var n,r;if(!t)throw new Error;return Lc(t.columnDef.aggregationFn)?t.columnDef.aggregationFn:t.columnDef.aggregationFn==="auto"?t.getAutoAggregationFn():(n=(r=e.options.aggregationFns)==null?void 0:r[t.columnDef.aggregationFn])!=null?n:zd[t.columnDef.aggregationFn]}},createTable:t=>{t.setGrouping=e=>t.options.onGroupingChange==null?void 0:t.options.onGroupingChange(e),t.resetGrouping=e=>{var n,r;t.setGrouping(e?[]:(n=(r=t.initialState)==null?void 0:r.grouping)!=null?n:[])},t.getPreGroupedRowModel=()=>t.getFilteredRowModel(),t.getGroupedRowModel=()=>(!t._getGroupedRowModel&&t.options.getGroupedRowModel&&(t._getGroupedRowModel=t.options.getGroupedRowModel(t)),t.options.manualGrouping||!t._getGroupedRowModel?t.getPreGroupedRowModel():t._getGroupedRowModel())},createRow:(t,e)=>{t.getIsGrouped=()=>!!t.groupingColumnId,t.getGroupingValue=n=>{if(t._groupingValuesCache.hasOwnProperty(n))return t._groupingValuesCache[n];const r=e.getColumn(n);return r!=null&&r.columnDef.getGroupingValue?(t._groupingValuesCache[n]=r.columnDef.getGroupingValue(t.original),t._groupingValuesCache[n]):t.getValue(n)},t._groupingValuesCache={}},createCell:(t,e,n,r)=>{t.getIsGrouped=()=>e.getIsGrouped()&&e.id===n.groupingColumnId,t.getIsPlaceholder=()=>!t.getIsGrouped()&&e.getIsGrouped(),t.getIsAggregated=()=>{var s;return!t.getIsGrouped()&&!t.getIsPlaceholder()&&!!((s=n.subRows)!=null&&s.length)}}};function Ej(t,e,n){if(!(e!=null&&e.length)||!n)return t;const r=t.filter(i=>!e.includes(i.id));return n==="remove"?r:[...e.map(i=>t.find(o=>o.id===i)).filter(Boolean),...r]}const Sj={getInitialState:t=>({columnOrder:[],...t}),getDefaultOptions:t=>({onColumnOrderChange:Qt("columnOrder",t)}),createColumn:(t,e)=>{t.getIndex=J(n=>[Ko(e,n)],n=>n.findIndex(r=>r.id===t.id),Z(e.options,"debugColumns")),t.getIsFirstColumn=n=>{var r;return((r=Ko(e,n)[0])==null?void 0:r.id)===t.id},t.getIsLastColumn=n=>{var r;const s=Ko(e,n);return((r=s[s.length-1])==null?void 0:r.id)===t.id}},createTable:t=>{t.setColumnOrder=e=>t.options.onColumnOrderChange==null?void 0:t.options.onColumnOrderChange(e),t.resetColumnOrder=e=>{var n;t.setColumnOrder(e?[]:(n=t.initialState.columnOrder)!=null?n:[])},t._getOrderColumnsFn=J(()=>[t.getState().columnOrder,t.getState().grouping,t.options.groupedColumnMode],(e,n,r)=>s=>{let i=[];if(!(e!=null&&e.length))i=s;else{const o=[...e],a=[...s];for(;a.length&&o.length;){const l=o.shift(),c=a.findIndex(h=>h.id===l);c>-1&&i.push(a.splice(c,1)[0])}i=[...i,...a]}return Ej(i,n,r)},Z(t.options,"debugTable"))}},Bd=()=>({left:[],right:[]}),Cj={getInitialState:t=>({columnPinning:Bd(),...t}),getDefaultOptions:t=>({onColumnPinningChange:Qt("columnPinning",t)}),createColumn:(t,e)=>{t.pin=n=>{const r=t.getLeafColumns().map(s=>s.id).filter(Boolean);e.setColumnPinning(s=>{var i,o;if(n==="right"){var a,l;return{left:((a=s==null?void 0:s.left)!=null?a:[]).filter(p=>!(r!=null&&r.includes(p))),right:[...((l=s==null?void 0:s.right)!=null?l:[]).filter(p=>!(r!=null&&r.includes(p))),...r]}}if(n==="left"){var c,h;return{left:[...((c=s==null?void 0:s.left)!=null?c:[]).filter(p=>!(r!=null&&r.includes(p))),...r],right:((h=s==null?void 0:s.right)!=null?h:[]).filter(p=>!(r!=null&&r.includes(p)))}}return{left:((i=s==null?void 0:s.left)!=null?i:[]).filter(p=>!(r!=null&&r.includes(p))),right:((o=s==null?void 0:s.right)!=null?o:[]).filter(p=>!(r!=null&&r.includes(p)))}})},t.getCanPin=()=>t.getLeafColumns().some(r=>{var s,i,o;return((s=r.columnDef.enablePinning)!=null?s:!0)&&((i=(o=e.options.enableColumnPinning)!=null?o:e.options.enablePinning)!=null?i:!0)}),t.getIsPinned=()=>{const n=t.getLeafColumns().map(a=>a.id),{left:r,right:s}=e.getState().columnPinning,i=n.some(a=>r==null?void 0:r.includes(a)),o=n.some(a=>s==null?void 0:s.includes(a));return i?"left":o?"right":!1},t.getPinnedIndex=()=>{var n,r;const s=t.getIsPinned();return s?(n=(r=e.getState().columnPinning)==null||(r=r[s])==null?void 0:r.indexOf(t.id))!=null?n:-1:0}},createRow:(t,e)=>{t.getCenterVisibleCells=J(()=>[t._getAllVisibleCells(),e.getState().columnPinning.left,e.getState().columnPinning.right],(n,r,s)=>{const i=[...r??[],...s??[]];return n.filter(o=>!i.includes(o.column.id))},Z(e.options,"debugRows")),t.getLeftVisibleCells=J(()=>[t._getAllVisibleCells(),e.getState().columnPinning.left],(n,r)=>(r??[]).map(i=>n.find(o=>o.column.id===i)).filter(Boolean).map(i=>({...i,position:"left"})),Z(e.options,"debugRows")),t.getRightVisibleCells=J(()=>[t._getAllVisibleCells(),e.getState().columnPinning.right],(n,r)=>(r??[]).map(i=>n.find(o=>o.column.id===i)).filter(Boolean).map(i=>({...i,position:"right"})),Z(e.options,"debugRows"))},createTable:t=>{t.setColumnPinning=e=>t.options.onColumnPinningChange==null?void 0:t.options.onColumnPinningChange(e),t.resetColumnPinning=e=>{var n,r;return t.setColumnPinning(e?Bd():(n=(r=t.initialState)==null?void 0:r.columnPinning)!=null?n:Bd())},t.getIsSomeColumnsPinned=e=>{var n;const r=t.getState().columnPinning;if(!e){var s,i;return!!((s=r.left)!=null&&s.length||(i=r.right)!=null&&i.length)}return!!((n=r[e])!=null&&n.length)},t.getLeftLeafColumns=J(()=>[t.getAllLeafColumns(),t.getState().columnPinning.left],(e,n)=>(n??[]).map(r=>e.find(s=>s.id===r)).filter(Boolean),Z(t.options,"debugColumns")),t.getRightLeafColumns=J(()=>[t.getAllLeafColumns(),t.getState().columnPinning.right],(e,n)=>(n??[]).map(r=>e.find(s=>s.id===r)).filter(Boolean),Z(t.options,"debugColumns")),t.getCenterLeafColumns=J(()=>[t.getAllLeafColumns(),t.getState().columnPinning.left,t.getState().columnPinning.right],(e,n,r)=>{const s=[...n??[],...r??[]];return e.filter(i=>!s.includes(i.id))},Z(t.options,"debugColumns"))}};function Ij(t){return t||(typeof document<"u"?document:null)}const Pl={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},qd=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),Tj={getDefaultColumnDef:()=>Pl,getInitialState:t=>({columnSizing:{},columnSizingInfo:qd(),...t}),getDefaultOptions:t=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:Qt("columnSizing",t),onColumnSizingInfoChange:Qt("columnSizingInfo",t)}),createColumn:(t,e)=>{t.getSize=()=>{var n,r,s;const i=e.getState().columnSizing[t.id];return Math.min(Math.max((n=t.columnDef.minSize)!=null?n:Pl.minSize,(r=i??t.columnDef.size)!=null?r:Pl.size),(s=t.columnDef.maxSize)!=null?s:Pl.maxSize)},t.getStart=J(n=>[n,Ko(e,n),e.getState().columnSizing],(n,r)=>r.slice(0,t.getIndex(n)).reduce((s,i)=>s+i.getSize(),0),Z(e.options,"debugColumns")),t.getAfter=J(n=>[n,Ko(e,n),e.getState().columnSizing],(n,r)=>r.slice(t.getIndex(n)+1).reduce((s,i)=>s+i.getSize(),0),Z(e.options,"debugColumns")),t.resetSize=()=>{e.setColumnSizing(n=>{let{[t.id]:r,...s}=n;return s})},t.getCanResize=()=>{var n,r;return((n=t.columnDef.enableResizing)!=null?n:!0)&&((r=e.options.enableColumnResizing)!=null?r:!0)},t.getIsResizing=()=>e.getState().columnSizingInfo.isResizingColumn===t.id},createHeader:(t,e)=>{t.getSize=()=>{let n=0;const r=s=>{if(s.subHeaders.length)s.subHeaders.forEach(r);else{var i;n+=(i=s.column.getSize())!=null?i:0}};return r(t),n},t.getStart=()=>{if(t.index>0){const n=t.headerGroup.headers[t.index-1];return n.getStart()+n.getSize()}return 0},t.getResizeHandler=n=>{const r=e.getColumn(t.column.id),s=r==null?void 0:r.getCanResize();return i=>{if(!r||!s||(i.persist==null||i.persist(),Hd(i)&&i.touches&&i.touches.length>1))return;const o=t.getSize(),a=t?t.getLeafHeaders().map(S=>[S.column.id,S.column.getSize()]):[[r.id,r.getSize()]],l=Hd(i)?Math.round(i.touches[0].clientX):i.clientX,c={},h=(S,_)=>{typeof _=="number"&&(e.setColumnSizingInfo(x=>{var D,O;const j=e.options.columnResizeDirection==="rtl"?-1:1,R=(_-((D=x==null?void 0:x.startOffset)!=null?D:0))*j,w=Math.max(R/((O=x==null?void 0:x.startSize)!=null?O:0),-.999999);return x.columnSizingStart.forEach(C=>{let[T,b]=C;c[T]=Math.round(Math.max(b+b*w,0)*100)/100}),{...x,deltaOffset:R,deltaPercentage:w}}),(e.options.columnResizeMode==="onChange"||S==="end")&&e.setColumnSizing(x=>({...x,...c})))},p=S=>h("move",S),m=S=>{h("end",S),e.setColumnSizingInfo(_=>({..._,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},g=Ij(n),v={moveHandler:S=>p(S.clientX),upHandler:S=>{g==null||g.removeEventListener("mousemove",v.moveHandler),g==null||g.removeEventListener("mouseup",v.upHandler),m(S.clientX)}},E={moveHandler:S=>(S.cancelable&&(S.preventDefault(),S.stopPropagation()),p(S.touches[0].clientX),!1),upHandler:S=>{var _;g==null||g.removeEventListener("touchmove",E.moveHandler),g==null||g.removeEventListener("touchend",E.upHandler),S.cancelable&&(S.preventDefault(),S.stopPropagation()),m((_=S.touches[0])==null?void 0:_.clientX)}},N=Rj()?{passive:!1}:!1;Hd(i)?(g==null||g.addEventListener("touchmove",E.moveHandler,N),g==null||g.addEventListener("touchend",E.upHandler,N)):(g==null||g.addEventListener("mousemove",v.moveHandler,N),g==null||g.addEventListener("mouseup",v.upHandler,N)),e.setColumnSizingInfo(S=>({...S,startOffset:l,startSize:o,deltaOffset:0,deltaPercentage:0,columnSizingStart:a,isResizingColumn:r.id}))}}},createTable:t=>{t.setColumnSizing=e=>t.options.onColumnSizingChange==null?void 0:t.options.onColumnSizingChange(e),t.setColumnSizingInfo=e=>t.options.onColumnSizingInfoChange==null?void 0:t.options.onColumnSizingInfoChange(e),t.resetColumnSizing=e=>{var n;t.setColumnSizing(e?{}:(n=t.initialState.columnSizing)!=null?n:{})},t.resetHeaderSizeInfo=e=>{var n;t.setColumnSizingInfo(e?qd():(n=t.initialState.columnSizingInfo)!=null?n:qd())},t.getTotalSize=()=>{var e,n;return(e=(n=t.getHeaderGroups()[0])==null?void 0:n.headers.reduce((r,s)=>r+s.getSize(),0))!=null?e:0},t.getLeftTotalSize=()=>{var e,n;return(e=(n=t.getLeftHeaderGroups()[0])==null?void 0:n.headers.reduce((r,s)=>r+s.getSize(),0))!=null?e:0},t.getCenterTotalSize=()=>{var e,n;return(e=(n=t.getCenterHeaderGroups()[0])==null?void 0:n.headers.reduce((r,s)=>r+s.getSize(),0))!=null?e:0},t.getRightTotalSize=()=>{var e,n;return(e=(n=t.getRightHeaderGroups()[0])==null?void 0:n.headers.reduce((r,s)=>r+s.getSize(),0))!=null?e:0}}};let Dl=null;function Rj(){if(typeof Dl=="boolean")return Dl;let t=!1;try{const e={get passive(){return t=!0,!1}},n=()=>{};window.addEventListener("test",n,e),window.removeEventListener("test",n)}catch{t=!1}return Dl=t,Dl}function Hd(t){return t.type==="touchstart"}const Aj={getInitialState:t=>({columnVisibility:{},...t}),getDefaultOptions:t=>({onColumnVisibilityChange:Qt("columnVisibility",t)}),createColumn:(t,e)=>{t.toggleVisibility=n=>{t.getCanHide()&&e.setColumnVisibility(r=>({...r,[t.id]:n??!t.getIsVisible()}))},t.getIsVisible=()=>{var n,r;const s=t.columns;return(n=s.length?s.some(i=>i.getIsVisible()):(r=e.getState().columnVisibility)==null?void 0:r[t.id])!=null?n:!0},t.getCanHide=()=>{var n,r;return((n=t.columnDef.enableHiding)!=null?n:!0)&&((r=e.options.enableHiding)!=null?r:!0)},t.getToggleVisibilityHandler=()=>n=>{t.toggleVisibility==null||t.toggleVisibility(n.target.checked)}},createRow:(t,e)=>{t._getAllVisibleCells=J(()=>[t.getAllCells(),e.getState().columnVisibility],n=>n.filter(r=>r.column.getIsVisible()),Z(e.options,"debugRows")),t.getVisibleCells=J(()=>[t.getLeftVisibleCells(),t.getCenterVisibleCells(),t.getRightVisibleCells()],(n,r,s)=>[...n,...r,...s],Z(e.options,"debugRows"))},createTable:t=>{const e=(n,r)=>J(()=>[r(),r().filter(s=>s.getIsVisible()).map(s=>s.id).join("_")],s=>s.filter(i=>i.getIsVisible==null?void 0:i.getIsVisible()),Z(t.options,"debugColumns"));t.getVisibleFlatColumns=e("getVisibleFlatColumns",()=>t.getAllFlatColumns()),t.getVisibleLeafColumns=e("getVisibleLeafColumns",()=>t.getAllLeafColumns()),t.getLeftVisibleLeafColumns=e("getLeftVisibleLeafColumns",()=>t.getLeftLeafColumns()),t.getRightVisibleLeafColumns=e("getRightVisibleLeafColumns",()=>t.getRightLeafColumns()),t.getCenterVisibleLeafColumns=e("getCenterVisibleLeafColumns",()=>t.getCenterLeafColumns()),t.setColumnVisibility=n=>t.options.onColumnVisibilityChange==null?void 0:t.options.onColumnVisibilityChange(n),t.resetColumnVisibility=n=>{var r;t.setColumnVisibility(n?{}:(r=t.initialState.columnVisibility)!=null?r:{})},t.toggleAllColumnsVisible=n=>{var r;n=(r=n)!=null?r:!t.getIsAllColumnsVisible(),t.setColumnVisibility(t.getAllLeafColumns().reduce((s,i)=>({...s,[i.id]:n||!(i.getCanHide!=null&&i.getCanHide())}),{}))},t.getIsAllColumnsVisible=()=>!t.getAllLeafColumns().some(n=>!(n.getIsVisible!=null&&n.getIsVisible())),t.getIsSomeColumnsVisible=()=>t.getAllLeafColumns().some(n=>n.getIsVisible==null?void 0:n.getIsVisible()),t.getToggleAllColumnsVisibilityHandler=()=>n=>{var r;t.toggleAllColumnsVisible((r=n.target)==null?void 0:r.checked)}}};function Ko(t,e){return e?e==="center"?t.getCenterVisibleLeafColumns():e==="left"?t.getLeftVisibleLeafColumns():t.getRightVisibleLeafColumns():t.getVisibleLeafColumns()}const Nj={createTable:t=>{t._getGlobalFacetedRowModel=t.options.getFacetedRowModel&&t.options.getFacetedRowModel(t,"__global__"),t.getGlobalFacetedRowModel=()=>t.options.manualFiltering||!t._getGlobalFacetedRowModel?t.getPreFilteredRowModel():t._getGlobalFacetedRowModel(),t._getGlobalFacetedUniqueValues=t.options.getFacetedUniqueValues&&t.options.getFacetedUniqueValues(t,"__global__"),t.getGlobalFacetedUniqueValues=()=>t._getGlobalFacetedUniqueValues?t._getGlobalFacetedUniqueValues():new Map,t._getGlobalFacetedMinMaxValues=t.options.getFacetedMinMaxValues&&t.options.getFacetedMinMaxValues(t,"__global__"),t.getGlobalFacetedMinMaxValues=()=>{if(t._getGlobalFacetedMinMaxValues)return t._getGlobalFacetedMinMaxValues()}}},bj={getInitialState:t=>({globalFilter:void 0,...t}),getDefaultOptions:t=>({onGlobalFilterChange:Qt("globalFilter",t),globalFilterFn:"auto",getColumnCanGlobalFilter:e=>{var n;const r=(n=t.getCoreRowModel().flatRows[0])==null||(n=n._getAllCellsByColumnId()[e.id])==null?void 0:n.getValue();return typeof r=="string"||typeof r=="number"}}),createColumn:(t,e)=>{t.getCanGlobalFilter=()=>{var n,r,s,i;return((n=t.columnDef.enableGlobalFilter)!=null?n:!0)&&((r=e.options.enableGlobalFilter)!=null?r:!0)&&((s=e.options.enableFilters)!=null?s:!0)&&((i=e.options.getColumnCanGlobalFilter==null?void 0:e.options.getColumnCanGlobalFilter(t))!=null?i:!0)&&!!t.accessorFn}},createTable:t=>{t.getGlobalAutoFilterFn=()=>zn.includesString,t.getGlobalFilterFn=()=>{var e,n;const{globalFilterFn:r}=t.options;return Lc(r)?r:r==="auto"?t.getGlobalAutoFilterFn():(e=(n=t.options.filterFns)==null?void 0:n[r])!=null?e:zn[r]},t.setGlobalFilter=e=>{t.options.onGlobalFilterChange==null||t.options.onGlobalFilterChange(e)},t.resetGlobalFilter=e=>{t.setGlobalFilter(e?void 0:t.initialState.globalFilter)}}},kj={getInitialState:t=>({expanded:{},...t}),getDefaultOptions:t=>({onExpandedChange:Qt("expanded",t),paginateExpandedRows:!0}),createTable:t=>{let e=!1,n=!1;t._autoResetExpanded=()=>{var r,s;if(!e){t._queue(()=>{e=!0});return}if((r=(s=t.options.autoResetAll)!=null?s:t.options.autoResetExpanded)!=null?r:!t.options.manualExpanding){if(n)return;n=!0,t._queue(()=>{t.resetExpanded(),n=!1})}},t.setExpanded=r=>t.options.onExpandedChange==null?void 0:t.options.onExpandedChange(r),t.toggleAllRowsExpanded=r=>{r??!t.getIsAllRowsExpanded()?t.setExpanded(!0):t.setExpanded({})},t.resetExpanded=r=>{var s,i;t.setExpanded(r?{}:(s=(i=t.initialState)==null?void 0:i.expanded)!=null?s:{})},t.getCanSomeRowsExpand=()=>t.getPrePaginationRowModel().flatRows.some(r=>r.getCanExpand()),t.getToggleAllRowsExpandedHandler=()=>r=>{r.persist==null||r.persist(),t.toggleAllRowsExpanded()},t.getIsSomeRowsExpanded=()=>{const r=t.getState().expanded;return r===!0||Object.values(r).some(Boolean)},t.getIsAllRowsExpanded=()=>{const r=t.getState().expanded;return typeof r=="boolean"?r===!0:!(!Object.keys(r).length||t.getRowModel().flatRows.some(s=>!s.getIsExpanded()))},t.getExpandedDepth=()=>{let r=0;return(t.getState().expanded===!0?Object.keys(t.getRowModel().rowsById):Object.keys(t.getState().expanded)).forEach(i=>{const o=i.split(".");r=Math.max(r,o.length)}),r},t.getPreExpandedRowModel=()=>t.getSortedRowModel(),t.getExpandedRowModel=()=>(!t._getExpandedRowModel&&t.options.getExpandedRowModel&&(t._getExpandedRowModel=t.options.getExpandedRowModel(t)),t.options.manualExpanding||!t._getExpandedRowModel?t.getPreExpandedRowModel():t._getExpandedRowModel())},createRow:(t,e)=>{t.toggleExpanded=n=>{e.setExpanded(r=>{var s;const i=r===!0?!0:!!(r!=null&&r[t.id]);let o={};if(r===!0?Object.keys(e.getRowModel().rowsById).forEach(a=>{o[a]=!0}):o=r,n=(s=n)!=null?s:!i,!i&&n)return{...o,[t.id]:!0};if(i&&!n){const{[t.id]:a,...l}=o;return l}return r})},t.getIsExpanded=()=>{var n;const r=e.getState().expanded;return!!((n=e.options.getIsRowExpanded==null?void 0:e.options.getIsRowExpanded(t))!=null?n:r===!0||r!=null&&r[t.id])},t.getCanExpand=()=>{var n,r,s;return(n=e.options.getRowCanExpand==null?void 0:e.options.getRowCanExpand(t))!=null?n:((r=e.options.enableExpanding)!=null?r:!0)&&!!((s=t.subRows)!=null&&s.length)},t.getIsAllParentsExpanded=()=>{let n=!0,r=t;for(;n&&r.parentId;)r=e.getRow(r.parentId,!0),n=r.getIsExpanded();return n},t.getToggleExpandedHandler=()=>{const n=t.getCanExpand();return()=>{n&&t.toggleExpanded()}}}},If=0,Tf=10,Gd=()=>({pageIndex:If,pageSize:Tf}),Pj={getInitialState:t=>({...t,pagination:{...Gd(),...t==null?void 0:t.pagination}}),getDefaultOptions:t=>({onPaginationChange:Qt("pagination",t)}),createTable:t=>{let e=!1,n=!1;t._autoResetPageIndex=()=>{var r,s;if(!e){t._queue(()=>{e=!0});return}if((r=(s=t.options.autoResetAll)!=null?s:t.options.autoResetPageIndex)!=null?r:!t.options.manualPagination){if(n)return;n=!0,t._queue(()=>{t.resetPageIndex(),n=!1})}},t.setPagination=r=>{const s=i=>Pr(r,i);return t.options.onPaginationChange==null?void 0:t.options.onPaginationChange(s)},t.resetPagination=r=>{var s;t.setPagination(r?Gd():(s=t.initialState.pagination)!=null?s:Gd())},t.setPageIndex=r=>{t.setPagination(s=>{let i=Pr(r,s.pageIndex);const o=typeof t.options.pageCount>"u"||t.options.pageCount===-1?Number.MAX_SAFE_INTEGER:t.options.pageCount-1;return i=Math.max(0,Math.min(i,o)),{...s,pageIndex:i}})},t.resetPageIndex=r=>{var s,i;t.setPageIndex(r?If:(s=(i=t.initialState)==null||(i=i.pagination)==null?void 0:i.pageIndex)!=null?s:If)},t.resetPageSize=r=>{var s,i;t.setPageSize(r?Tf:(s=(i=t.initialState)==null||(i=i.pagination)==null?void 0:i.pageSize)!=null?s:Tf)},t.setPageSize=r=>{t.setPagination(s=>{const i=Math.max(1,Pr(r,s.pageSize)),o=s.pageSize*s.pageIndex,a=Math.floor(o/i);return{...s,pageIndex:a,pageSize:i}})},t.setPageCount=r=>t.setPagination(s=>{var i;let o=Pr(r,(i=t.options.pageCount)!=null?i:-1);return typeof o=="number"&&(o=Math.max(-1,o)),{...s,pageCount:o}}),t.getPageOptions=J(()=>[t.getPageCount()],r=>{let s=[];return r&&r>0&&(s=[...new Array(r)].fill(null).map((i,o)=>o)),s},Z(t.options,"debugTable")),t.getCanPreviousPage=()=>t.getState().pagination.pageIndex>0,t.getCanNextPage=()=>{const{pageIndex:r}=t.getState().pagination,s=t.getPageCount();return s===-1?!0:s===0?!1:r<s-1},t.previousPage=()=>t.setPageIndex(r=>r-1),t.nextPage=()=>t.setPageIndex(r=>r+1),t.firstPage=()=>t.setPageIndex(0),t.lastPage=()=>t.setPageIndex(t.getPageCount()-1),t.getPrePaginationRowModel=()=>t.getExpandedRowModel(),t.getPaginationRowModel=()=>(!t._getPaginationRowModel&&t.options.getPaginationRowModel&&(t._getPaginationRowModel=t.options.getPaginationRowModel(t)),t.options.manualPagination||!t._getPaginationRowModel?t.getPrePaginationRowModel():t._getPaginationRowModel()),t.getPageCount=()=>{var r;return(r=t.options.pageCount)!=null?r:Math.ceil(t.getRowCount()/t.getState().pagination.pageSize)},t.getRowCount=()=>{var r;return(r=t.options.rowCount)!=null?r:t.getPrePaginationRowModel().rows.length}}},Wd=()=>({top:[],bottom:[]}),Dj={getInitialState:t=>({rowPinning:Wd(),...t}),getDefaultOptions:t=>({onRowPinningChange:Qt("rowPinning",t)}),createRow:(t,e)=>{t.pin=(n,r,s)=>{const i=r?t.getLeafRows().map(l=>{let{id:c}=l;return c}):[],o=s?t.getParentRows().map(l=>{let{id:c}=l;return c}):[],a=new Set([...o,t.id,...i]);e.setRowPinning(l=>{var c,h;if(n==="bottom"){var p,m;return{top:((p=l==null?void 0:l.top)!=null?p:[]).filter(E=>!(a!=null&&a.has(E))),bottom:[...((m=l==null?void 0:l.bottom)!=null?m:[]).filter(E=>!(a!=null&&a.has(E))),...Array.from(a)]}}if(n==="top"){var g,v;return{top:[...((g=l==null?void 0:l.top)!=null?g:[]).filter(E=>!(a!=null&&a.has(E))),...Array.from(a)],bottom:((v=l==null?void 0:l.bottom)!=null?v:[]).filter(E=>!(a!=null&&a.has(E)))}}return{top:((c=l==null?void 0:l.top)!=null?c:[]).filter(E=>!(a!=null&&a.has(E))),bottom:((h=l==null?void 0:l.bottom)!=null?h:[]).filter(E=>!(a!=null&&a.has(E)))}})},t.getCanPin=()=>{var n;const{enableRowPinning:r,enablePinning:s}=e.options;return typeof r=="function"?r(t):(n=r??s)!=null?n:!0},t.getIsPinned=()=>{const n=[t.id],{top:r,bottom:s}=e.getState().rowPinning,i=n.some(a=>r==null?void 0:r.includes(a)),o=n.some(a=>s==null?void 0:s.includes(a));return i?"top":o?"bottom":!1},t.getPinnedIndex=()=>{var n,r;const s=t.getIsPinned();if(!s)return-1;const i=(n=s==="top"?e.getTopRows():e.getBottomRows())==null?void 0:n.map(o=>{let{id:a}=o;return a});return(r=i==null?void 0:i.indexOf(t.id))!=null?r:-1}},createTable:t=>{t.setRowPinning=e=>t.options.onRowPinningChange==null?void 0:t.options.onRowPinningChange(e),t.resetRowPinning=e=>{var n,r;return t.setRowPinning(e?Wd():(n=(r=t.initialState)==null?void 0:r.rowPinning)!=null?n:Wd())},t.getIsSomeRowsPinned=e=>{var n;const r=t.getState().rowPinning;if(!e){var s,i;return!!((s=r.top)!=null&&s.length||(i=r.bottom)!=null&&i.length)}return!!((n=r[e])!=null&&n.length)},t._getPinnedRows=(e,n,r)=>{var s;return((s=t.options.keepPinnedRows)==null||s?(n??[]).map(o=>{const a=t.getRow(o,!0);return a.getIsAllParentsExpanded()?a:null}):(n??[]).map(o=>e.find(a=>a.id===o))).filter(Boolean).map(o=>({...o,position:r}))},t.getTopRows=J(()=>[t.getRowModel().rows,t.getState().rowPinning.top],(e,n)=>t._getPinnedRows(e,n,"top"),Z(t.options,"debugRows")),t.getBottomRows=J(()=>[t.getRowModel().rows,t.getState().rowPinning.bottom],(e,n)=>t._getPinnedRows(e,n,"bottom"),Z(t.options,"debugRows")),t.getCenterRows=J(()=>[t.getRowModel().rows,t.getState().rowPinning.top,t.getState().rowPinning.bottom],(e,n,r)=>{const s=new Set([...n??[],...r??[]]);return e.filter(i=>!s.has(i.id))},Z(t.options,"debugRows"))}},jj={getInitialState:t=>({rowSelection:{},...t}),getDefaultOptions:t=>({onRowSelectionChange:Qt("rowSelection",t),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:t=>{t.setRowSelection=e=>t.options.onRowSelectionChange==null?void 0:t.options.onRowSelectionChange(e),t.resetRowSelection=e=>{var n;return t.setRowSelection(e?{}:(n=t.initialState.rowSelection)!=null?n:{})},t.toggleAllRowsSelected=e=>{t.setRowSelection(n=>{e=typeof e<"u"?e:!t.getIsAllRowsSelected();const r={...n},s=t.getPreGroupedRowModel().flatRows;return e?s.forEach(i=>{i.getCanSelect()&&(r[i.id]=!0)}):s.forEach(i=>{delete r[i.id]}),r})},t.toggleAllPageRowsSelected=e=>t.setRowSelection(n=>{const r=typeof e<"u"?e:!t.getIsAllPageRowsSelected(),s={...n};return t.getRowModel().rows.forEach(i=>{Rf(s,i.id,r,!0,t)}),s}),t.getPreSelectedRowModel=()=>t.getCoreRowModel(),t.getSelectedRowModel=J(()=>[t.getState().rowSelection,t.getCoreRowModel()],(e,n)=>Object.keys(e).length?Kd(t,n):{rows:[],flatRows:[],rowsById:{}},Z(t.options,"debugTable")),t.getFilteredSelectedRowModel=J(()=>[t.getState().rowSelection,t.getFilteredRowModel()],(e,n)=>Object.keys(e).length?Kd(t,n):{rows:[],flatRows:[],rowsById:{}},Z(t.options,"debugTable")),t.getGroupedSelectedRowModel=J(()=>[t.getState().rowSelection,t.getSortedRowModel()],(e,n)=>Object.keys(e).length?Kd(t,n):{rows:[],flatRows:[],rowsById:{}},Z(t.options,"debugTable")),t.getIsAllRowsSelected=()=>{const e=t.getFilteredRowModel().flatRows,{rowSelection:n}=t.getState();let r=!!(e.length&&Object.keys(n).length);return r&&e.some(s=>s.getCanSelect()&&!n[s.id])&&(r=!1),r},t.getIsAllPageRowsSelected=()=>{const e=t.getPaginationRowModel().flatRows.filter(s=>s.getCanSelect()),{rowSelection:n}=t.getState();let r=!!e.length;return r&&e.some(s=>!n[s.id])&&(r=!1),r},t.getIsSomeRowsSelected=()=>{var e;const n=Object.keys((e=t.getState().rowSelection)!=null?e:{}).length;return n>0&&n<t.getFilteredRowModel().flatRows.length},t.getIsSomePageRowsSelected=()=>{const e=t.getPaginationRowModel().flatRows;return t.getIsAllPageRowsSelected()?!1:e.filter(n=>n.getCanSelect()).some(n=>n.getIsSelected()||n.getIsSomeSelected())},t.getToggleAllRowsSelectedHandler=()=>e=>{t.toggleAllRowsSelected(e.target.checked)},t.getToggleAllPageRowsSelectedHandler=()=>e=>{t.toggleAllPageRowsSelected(e.target.checked)}},createRow:(t,e)=>{t.toggleSelected=(n,r)=>{const s=t.getIsSelected();e.setRowSelection(i=>{var o;if(n=typeof n<"u"?n:!s,t.getCanSelect()&&s===n)return i;const a={...i};return Rf(a,t.id,n,(o=r==null?void 0:r.selectChildren)!=null?o:!0,e),a})},t.getIsSelected=()=>{const{rowSelection:n}=e.getState();return bm(t,n)},t.getIsSomeSelected=()=>{const{rowSelection:n}=e.getState();return Af(t,n)==="some"},t.getIsAllSubRowsSelected=()=>{const{rowSelection:n}=e.getState();return Af(t,n)==="all"},t.getCanSelect=()=>{var n;return typeof e.options.enableRowSelection=="function"?e.options.enableRowSelection(t):(n=e.options.enableRowSelection)!=null?n:!0},t.getCanSelectSubRows=()=>{var n;return typeof e.options.enableSubRowSelection=="function"?e.options.enableSubRowSelection(t):(n=e.options.enableSubRowSelection)!=null?n:!0},t.getCanMultiSelect=()=>{var n;return typeof e.options.enableMultiRowSelection=="function"?e.options.enableMultiRowSelection(t):(n=e.options.enableMultiRowSelection)!=null?n:!0},t.getToggleSelectedHandler=()=>{const n=t.getCanSelect();return r=>{var s;n&&t.toggleSelected((s=r.target)==null?void 0:s.checked)}}}},Rf=(t,e,n,r,s)=>{var i;const o=s.getRow(e,!0);n?(o.getCanMultiSelect()||Object.keys(t).forEach(a=>delete t[a]),o.getCanSelect()&&(t[e]=!0)):delete t[e],r&&(i=o.subRows)!=null&&i.length&&o.getCanSelectSubRows()&&o.subRows.forEach(a=>Rf(t,a.id,n,r,s))};function Kd(t,e){const n=t.getState().rowSelection,r=[],s={},i=function(o,a){return o.map(l=>{var c;const h=bm(l,n);if(h&&(r.push(l),s[l.id]=l),(c=l.subRows)!=null&&c.length&&(l={...l,subRows:i(l.subRows)}),h)return l}).filter(Boolean)};return{rows:i(e.rows),flatRows:r,rowsById:s}}function bm(t,e){var n;return(n=e[t.id])!=null?n:!1}function Af(t,e,n){var r;if(!((r=t.subRows)!=null&&r.length))return!1;let s=!0,i=!1;return t.subRows.forEach(o=>{if(!(i&&!s)&&(o.getCanSelect()&&(bm(o,e)?i=!0:s=!1),o.subRows&&o.subRows.length)){const a=Af(o,e);a==="all"?i=!0:(a==="some"&&(i=!0),s=!1)}}),s?"all":i?"some":!1}const Nf=/([0-9]+)/gm,Mj=(t,e,n)=>_S(Xr(t.getValue(n)).toLowerCase(),Xr(e.getValue(n)).toLowerCase()),Vj=(t,e,n)=>_S(Xr(t.getValue(n)),Xr(e.getValue(n))),Oj=(t,e,n)=>km(Xr(t.getValue(n)).toLowerCase(),Xr(e.getValue(n)).toLowerCase()),Lj=(t,e,n)=>km(Xr(t.getValue(n)),Xr(e.getValue(n))),Fj=(t,e,n)=>{const r=t.getValue(n),s=e.getValue(n);return r>s?1:r<s?-1:0},Uj=(t,e,n)=>km(t.getValue(n),e.getValue(n));function km(t,e){return t===e?0:t>e?1:-1}function Xr(t){return typeof t=="number"?isNaN(t)||t===1/0||t===-1/0?"":String(t):typeof t=="string"?t:""}function _S(t,e){const n=t.split(Nf).filter(Boolean),r=e.split(Nf).filter(Boolean);for(;n.length&&r.length;){const s=n.shift(),i=r.shift(),o=parseInt(s,10),a=parseInt(i,10),l=[o,a].sort();if(isNaN(l[0])){if(s>i)return 1;if(i>s)return-1;continue}if(isNaN(l[1]))return isNaN(o)?-1:1;if(o>a)return 1;if(a>o)return-1}return n.length-r.length}const xo={alphanumeric:Mj,alphanumericCaseSensitive:Vj,text:Oj,textCaseSensitive:Lj,datetime:Fj,basic:Uj},$j={getInitialState:t=>({sorting:[],...t}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:t=>({onSortingChange:Qt("sorting",t),isMultiSortEvent:e=>e.shiftKey}),createColumn:(t,e)=>{t.getAutoSortingFn=()=>{const n=e.getFilteredRowModel().flatRows.slice(10);let r=!1;for(const s of n){const i=s==null?void 0:s.getValue(t.id);if(Object.prototype.toString.call(i)==="[object Date]")return xo.datetime;if(typeof i=="string"&&(r=!0,i.split(Nf).length>1))return xo.alphanumeric}return r?xo.text:xo.basic},t.getAutoSortDir=()=>{const n=e.getFilteredRowModel().flatRows[0];return typeof(n==null?void 0:n.getValue(t.id))=="string"?"asc":"desc"},t.getSortingFn=()=>{var n,r;if(!t)throw new Error;return Lc(t.columnDef.sortingFn)?t.columnDef.sortingFn:t.columnDef.sortingFn==="auto"?t.getAutoSortingFn():(n=(r=e.options.sortingFns)==null?void 0:r[t.columnDef.sortingFn])!=null?n:xo[t.columnDef.sortingFn]},t.toggleSorting=(n,r)=>{const s=t.getNextSortingOrder(),i=typeof n<"u"&&n!==null;e.setSorting(o=>{const a=o==null?void 0:o.find(g=>g.id===t.id),l=o==null?void 0:o.findIndex(g=>g.id===t.id);let c=[],h,p=i?n:s==="desc";if(o!=null&&o.length&&t.getCanMultiSort()&&r?a?h="toggle":h="add":o!=null&&o.length&&l!==o.length-1?h="replace":a?h="toggle":h="replace",h==="toggle"&&(i||s||(h="remove")),h==="add"){var m;c=[...o,{id:t.id,desc:p}],c.splice(0,c.length-((m=e.options.maxMultiSortColCount)!=null?m:Number.MAX_SAFE_INTEGER))}else h==="toggle"?c=o.map(g=>g.id===t.id?{...g,desc:p}:g):h==="remove"?c=o.filter(g=>g.id!==t.id):c=[{id:t.id,desc:p}];return c})},t.getFirstSortDir=()=>{var n,r;return((n=(r=t.columnDef.sortDescFirst)!=null?r:e.options.sortDescFirst)!=null?n:t.getAutoSortDir()==="desc")?"desc":"asc"},t.getNextSortingOrder=n=>{var r,s;const i=t.getFirstSortDir(),o=t.getIsSorted();return o?o!==i&&((r=e.options.enableSortingRemoval)==null||r)&&(!(n&&(s=e.options.enableMultiRemove)!=null)||s)?!1:o==="desc"?"asc":"desc":i},t.getCanSort=()=>{var n,r;return((n=t.columnDef.enableSorting)!=null?n:!0)&&((r=e.options.enableSorting)!=null?r:!0)&&!!t.accessorFn},t.getCanMultiSort=()=>{var n,r;return(n=(r=t.columnDef.enableMultiSort)!=null?r:e.options.enableMultiSort)!=null?n:!!t.accessorFn},t.getIsSorted=()=>{var n;const r=(n=e.getState().sorting)==null?void 0:n.find(s=>s.id===t.id);return r?r.desc?"desc":"asc":!1},t.getSortIndex=()=>{var n,r;return(n=(r=e.getState().sorting)==null?void 0:r.findIndex(s=>s.id===t.id))!=null?n:-1},t.clearSorting=()=>{e.setSorting(n=>n!=null&&n.length?n.filter(r=>r.id!==t.id):[])},t.getToggleSortingHandler=()=>{const n=t.getCanSort();return r=>{n&&(r.persist==null||r.persist(),t.toggleSorting==null||t.toggleSorting(void 0,t.getCanMultiSort()?e.options.isMultiSortEvent==null?void 0:e.options.isMultiSortEvent(r):!1))}}},createTable:t=>{t.setSorting=e=>t.options.onSortingChange==null?void 0:t.options.onSortingChange(e),t.resetSorting=e=>{var n,r;t.setSorting(e?[]:(n=(r=t.initialState)==null?void 0:r.sorting)!=null?n:[])},t.getPreSortedRowModel=()=>t.getGroupedRowModel(),t.getSortedRowModel=()=>(!t._getSortedRowModel&&t.options.getSortedRowModel&&(t._getSortedRowModel=t.options.getSortedRowModel(t)),t.options.manualSorting||!t._getSortedRowModel?t.getPreSortedRowModel():t._getSortedRowModel())}},zj=[uj,Aj,Sj,Cj,cj,dj,Nj,bj,$j,xj,kj,Pj,Dj,jj,Tj];function Bj(t){var e,n;const r=[...zj,...(e=t._features)!=null?e:[]];let s={_features:r};const i=s._features.reduce((m,g)=>Object.assign(m,g.getDefaultOptions==null?void 0:g.getDefaultOptions(s)),{}),o=m=>s.options.mergeOptions?s.options.mergeOptions(i,m):{...i,...m};let l={...{},...(n=t.initialState)!=null?n:{}};s._features.forEach(m=>{var g;l=(g=m.getInitialState==null?void 0:m.getInitialState(l))!=null?g:l});const c=[];let h=!1;const p={_features:r,options:{...i,...t},initialState:l,_queue:m=>{c.push(m),h||(h=!0,Promise.resolve().then(()=>{for(;c.length;)c.shift()();h=!1}).catch(g=>setTimeout(()=>{throw g})))},reset:()=>{s.setState(s.initialState)},setOptions:m=>{const g=Pr(m,s.options);s.options=o(g)},getState:()=>s.options.state,setState:m=>{s.options.onStateChange==null||s.options.onStateChange(m)},_getRowId:(m,g,v)=>{var E;return(E=s.options.getRowId==null?void 0:s.options.getRowId(m,g,v))!=null?E:`${v?[v.id,g].join("."):g}`},getCoreRowModel:()=>(s._getCoreRowModel||(s._getCoreRowModel=s.options.getCoreRowModel(s)),s._getCoreRowModel()),getRowModel:()=>s.getPaginationRowModel(),getRow:(m,g)=>{let v=(g?s.getPrePaginationRowModel():s.getRowModel()).rowsById[m];if(!v&&(v=s.getCoreRowModel().rowsById[m],!v))throw new Error;return v},_getDefaultColumnDef:J(()=>[s.options.defaultColumn],m=>{var g;return m=(g=m)!=null?g:{},{header:v=>{const E=v.header.column.columnDef;return E.accessorKey?E.accessorKey:E.accessorFn?E.id:null},cell:v=>{var E,N;return(E=(N=v.renderValue())==null||N.toString==null?void 0:N.toString())!=null?E:null},...s._features.reduce((v,E)=>Object.assign(v,E.getDefaultColumnDef==null?void 0:E.getDefaultColumnDef()),{}),...m}},Z(t,"debugColumns")),_getColumnDefs:()=>s.options.columns,getAllColumns:J(()=>[s._getColumnDefs()],m=>{const g=function(v,E,N){return N===void 0&&(N=0),v.map(S=>{const _=lj(s,S,N,E),x=S;return _.columns=x.columns?g(x.columns,_,N+1):[],_})};return g(m)},Z(t,"debugColumns")),getAllFlatColumns:J(()=>[s.getAllColumns()],m=>m.flatMap(g=>g.getFlatColumns()),Z(t,"debugColumns")),_getAllFlatColumnsById:J(()=>[s.getAllFlatColumns()],m=>m.reduce((g,v)=>(g[v.id]=v,g),{}),Z(t,"debugColumns")),getAllLeafColumns:J(()=>[s.getAllColumns(),s._getOrderColumnsFn()],(m,g)=>{let v=m.flatMap(E=>E.getLeafColumns());return g(v)},Z(t,"debugColumns")),getColumn:m=>s._getAllFlatColumnsById()[m]};Object.assign(s,p);for(let m=0;m<s._features.length;m++){const g=s._features[m];g==null||g.createTable==null||g.createTable(s)}return s}function qj(){return t=>J(()=>[t.options.data],e=>{const n={rows:[],flatRows:[],rowsById:{}},r=function(s,i,o){i===void 0&&(i=0);const a=[];for(let c=0;c<s.length;c++){const h=Am(t,t._getRowId(s[c],c,o),s[c],c,i,void 0,o==null?void 0:o.id);if(n.flatRows.push(h),n.rowsById[h.id]=h,a.push(h),t.options.getSubRows){var l;h.originalSubRows=t.options.getSubRows(s[c],c),(l=h.originalSubRows)!=null&&l.length&&(h.subRows=r(h.originalSubRows,i+1,h))}}return a};return n.rows=r(e),n},Z(t.options,"debugTable","getRowModel",()=>t._autoResetPageIndex()))}function Hj(t,e,n){return n.options.filterFromLeafRows?Gj(t,e,n):Wj(t,e,n)}function Gj(t,e,n){var r;const s=[],i={},o=(r=n.options.maxLeafRowFilterDepth)!=null?r:100,a=function(l,c){c===void 0&&(c=0);const h=[];for(let m=0;m<l.length;m++){var p;let g=l[m];const v=Am(n,g.id,g.original,g.index,g.depth,void 0,g.parentId);if(v.columnFilters=g.columnFilters,(p=g.subRows)!=null&&p.length&&c<o){if(v.subRows=a(g.subRows,c+1),g=v,e(g)&&!v.subRows.length){h.push(g),i[g.id]=g,s.push(g);continue}if(e(g)||v.subRows.length){h.push(g),i[g.id]=g,s.push(g);continue}}else g=v,e(g)&&(h.push(g),i[g.id]=g,s.push(g))}return h};return{rows:a(t),flatRows:s,rowsById:i}}function Wj(t,e,n){var r;const s=[],i={},o=(r=n.options.maxLeafRowFilterDepth)!=null?r:100,a=function(l,c){c===void 0&&(c=0);const h=[];for(let m=0;m<l.length;m++){let g=l[m];if(e(g)){var p;if((p=g.subRows)!=null&&p.length&&c<o){const E=Am(n,g.id,g.original,g.index,g.depth,void 0,g.parentId);E.subRows=a(g.subRows,c+1),g=E}h.push(g),s.push(g),i[g.id]=g}}return h};return{rows:a(t),flatRows:s,rowsById:i}}function Kj(){return t=>J(()=>[t.getPreFilteredRowModel(),t.getState().columnFilters,t.getState().globalFilter],(e,n,r)=>{if(!e.rows.length||!(n!=null&&n.length)&&!r){for(let m=0;m<e.flatRows.length;m++)e.flatRows[m].columnFilters={},e.flatRows[m].columnFiltersMeta={};return e}const s=[],i=[];(n??[]).forEach(m=>{var g;const v=t.getColumn(m.id);if(!v)return;const E=v.getFilterFn();E&&s.push({id:m.id,filterFn:E,resolvedValue:(g=E.resolveFilterValue==null?void 0:E.resolveFilterValue(m.value))!=null?g:m.value})});const o=(n??[]).map(m=>m.id),a=t.getGlobalFilterFn(),l=t.getAllLeafColumns().filter(m=>m.getCanGlobalFilter());r&&a&&l.length&&(o.push("__global__"),l.forEach(m=>{var g;i.push({id:m.id,filterFn:a,resolvedValue:(g=a.resolveFilterValue==null?void 0:a.resolveFilterValue(r))!=null?g:r})}));let c,h;for(let m=0;m<e.flatRows.length;m++){const g=e.flatRows[m];if(g.columnFilters={},s.length)for(let v=0;v<s.length;v++){c=s[v];const E=c.id;g.columnFilters[E]=c.filterFn(g,E,c.resolvedValue,N=>{g.columnFiltersMeta[E]=N})}if(i.length){for(let v=0;v<i.length;v++){h=i[v];const E=h.id;if(h.filterFn(g,E,h.resolvedValue,N=>{g.columnFiltersMeta[E]=N})){g.columnFilters.__global__=!0;break}}g.columnFilters.__global__!==!0&&(g.columnFilters.__global__=!1)}}const p=m=>{for(let g=0;g<o.length;g++)if(m.columnFilters[o[g]]===!1)return!1;return!0};return Hj(e.rows,p,t)},Z(t.options,"debugTable","getFilteredRowModel",()=>t._autoResetPageIndex()))}/**
   * react-table
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function d_(t,e){return t?Qj(t)?k.createElement(t,e):t:null}function Qj(t){return Yj(t)||typeof t=="function"||Xj(t)}function Yj(t){return typeof t=="function"&&(()=>{const e=Object.getPrototypeOf(t);return e.prototype&&e.prototype.isReactComponent})()}function Xj(t){return typeof t=="object"&&typeof t.$$typeof=="symbol"&&["react.memo","react.forward_ref"].includes(t.$$typeof.description)}function Jj(t){const e={state:{},onStateChange:()=>{},renderFallbackValue:null,...t},[n]=k.useState(()=>({current:Bj(e)})),[r,s]=k.useState(()=>n.current.initialState);return n.current.setOptions(i=>({...i,...t,state:{...r,...t.state},onStateChange:o=>{s(o),t.onStateChange==null||t.onStateChange(o)}})),n.current}function wS({data:t,globalFilter:e,onGlobalFilterChange:n,onEdit:r}){const s=k.useMemo(()=>[{accessorKey:"studentNumber",header:"Student #"},{accessorKey:"surname",header:"Surname"},{accessorKey:"name",header:"Name"},{accessorKey:"group",header:"Group"},{accessorKey:"status",header:"Status"},{accessorKey:"submittedAt",header:"Submitted"},{id:"actions",header:"",cell:({row:o})=>d.jsx("div",{children:d.jsx("button",{onClick:()=>r&&r(o.original),className:"text-xs text-brand-primary",children:"Edit"})})}],[r]),i=Jj({data:t,columns:s,state:{globalFilter:e},onGlobalFilterChange:n,getCoreRowModel:qj(),getFilteredRowModel:Kj()});return d.jsxs("div",{children:[d.jsx("div",{className:"hidden sm:block overflow-hidden rounded-md border border-stroke-subtle",children:d.jsxs("table",{className:"min-w-full divide-y divide-stroke-subtle text-sm",children:[d.jsx("thead",{className:"sticky top-0 bg-surfaceAlt text-xs uppercase tracking-wide text-text-muted",children:i.getHeaderGroups().map(o=>d.jsx("tr",{children:o.headers.map(a=>d.jsx("th",{className:"px-4 py-3 text-left",children:a.isPlaceholder?null:d_(a.column.columnDef.header,a.getContext())},a.id))},o.id))}),d.jsxs("tbody",{className:"divide-y divide-stroke-subtle bg-surface",children:[i.getRowModel().rows.map(o=>d.jsx("tr",{className:"transition hover:bg-surfaceAlt/70",children:o.getVisibleCells().map(a=>d.jsx("td",{className:"px-4 py-3 text-sm text-text-primary",children:d_(a.column.columnDef.cell,a.getContext())},a.id))},o.id)),i.getRowModel().rows.length===0&&d.jsx("tr",{children:d.jsx("td",{colSpan:s.length,className:"px-4 py-8 text-center text-sm text-text-muted",children:"No attendance yet."})})]})]})}),d.jsxs("div",{className:"sm:hidden space-y-3",children:[i.getRowModel().rows.length===0&&d.jsx("div",{className:"rounded-md border border-stroke-subtle bg-surface p-4 text-sm text-text-muted",children:"No attendance yet."}),i.getRowModel().rows.map(o=>{const a=o.original;return d.jsxs("div",{className:"rounded-md border border-stroke-subtle bg-surface p-3",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("div",{className:"font-semibold",children:a.studentNumber}),d.jsx("div",{className:"text-sm text-text-muted",children:a.status})]}),d.jsx("div",{className:"mt-1 text-sm text-text-muted",children:[a.surname,a.name].filter(Boolean).join(" ")}),d.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[d.jsx("div",{className:"text-xs text-text-muted",children:a.group}),d.jsx("div",{children:d.jsx("button",{onClick:()=>r&&r(a),className:"text-xs text-brand-primary",children:"Edit"})})]})]},o.id)})]})]})}function xS({sessionId:t}){const[e,n]=k.useState(null),[r,s]=k.useState(null),{showToast:i}=Wi(),o=async a=>{n(a),s(null);try{const c=await tn(nn,"exportSessionCsv")({sessionId:t,template:a}),h=c==null?void 0:c.data;if(h!=null&&h.url){window.open(h.url,"_blank"),i({message:"Export started",variant:"success"});return}if(h!=null&&h.fileContents){const p=atob(h.fileContents),m=new Uint8Array(p.length);for(let N=0;N<p.length;N+=1)m[N]=p.charCodeAt(N);const g=new Blob([m],{type:h.contentType||"text/csv"}),v=URL.createObjectURL(g),E=document.createElement("a");E.href=v,E.download=h.filename||`attendance-${Date.now()}.csv`,document.body.appendChild(E),E.click(),E.remove(),URL.revokeObjectURL(v),i({message:"Export downloaded",variant:"success"});return}throw new Error("No export data returned")}catch(l){s(l.message||"Export failed"),i({message:l.message||"Export failed",variant:"error"})}finally{n(null)}};return d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex flex-wrap gap-2",children:[d.jsx("button",{type:"button",className:"rounded-lg bg-black px-4 py-2 text-sm font-semibold text-white transition hover:brightness-95 disabled:opacity-60 disabled:cursor-not-allowed",disabled:e!==null,onClick:()=>o("standard"),children:e==="standard"?"Exporting...":"Export Standard CSV"}),d.jsx("button",{type:"button",className:"rounded-lg border border-gray-300 px-4 py-2 text-sm font-semibold text-gray-900 bg-white transition hover:bg-gray-50 disabled:opacity-60 disabled:cursor-not-allowed",disabled:e!==null,onClick:()=>o("pdf"),children:e==="pdf"?"Exporting...":"Export PDF"})]}),r&&d.jsx("p",{className:"text-sm text-accent-error",children:r})]})}const h_=[30,60,120,300],Zj=[30,60,120];function Fc(...t){return t.filter(Boolean).join(" ")}function eM(t){if(t<=0)return"Expired";const e=Math.floor(t/60),n=t%60;return e===0?`${n}s remaining`:`${e}m ${n.toString().padStart(2,"0")}s remaining`}function tM(t){switch(t){case"ACTIVE":return"bg-emerald-500";case"EXPIRED":return"bg-amber-500";case"ENDED":return"bg-gray-500";default:return"bg-gray-500"}}function f_({title:t,description:e,children:n,onClose:r}){return d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:d.jsxs("div",{className:"w-full max-w-md rounded-2xl border border-stroke-subtle bg-surface shadow-subtle",children:[d.jsx("div",{className:"border-b border-stroke-subtle px-5 py-4",children:d.jsxs("div",{className:"flex items-start justify-between gap-4",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-base font-semibold text-text-primary",children:t}),e?d.jsx("p",{className:"mt-1 text-sm text-text-muted",children:e}):null]}),d.jsx("button",{className:"rounded-lg px-2 py-1 text-sm font-semibold text-text-muted hover:bg-surfaceAlt",onClick:r,"aria-label":"Close",children:""})]})}),d.jsx("div",{className:"px-5 py-4",children:n})]})})}function p_({children:t,onClick:e,disabled:n,className:r,type:s="button"}){return d.jsx("button",{type:s,onClick:e,disabled:n,className:Fc("inline-flex items-center justify-center gap-2 rounded-lg bg-gray-900 px-4 py-2.5 text-sm font-medium text-white hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",r),children:t})}function jl({children:t,onClick:e,disabled:n,className:r}){return d.jsx("button",{type:"button",onClick:e,disabled:n,className:Fc("inline-flex items-center justify-center rounded-lg border border-stroke-subtle bg-surface px-4 py-2 text-sm font-semibold text-text-primary transition hover:bg-surfaceAlt disabled:cursor-not-allowed disabled:text-stroke-strong",r),children:t})}function Qd({children:t,onClick:e,disabled:n,className:r}){return d.jsx("button",{type:"button",onClick:e,disabled:n,className:Fc("inline-flex items-center justify-center rounded-lg bg-accent-error/10 px-4 py-2 text-sm font-semibold text-accent-error transition hover:bg-accent-error/20 disabled:cursor-not-allowed disabled:opacity-60",r),children:t})}function Yd({label:t,value:e,onChange:n,disabled:r,children:s}){return d.jsxs("div",{className:"space-y-1.5",children:[d.jsx("label",{className:"block text-[11px] font-semibold uppercase tracking-wide text-text-muted",children:t}),d.jsx("select",{className:"w-full rounded-xl border border-stroke-subtle bg-surface px-3 py-2 text-sm text-text-primary outline-none transition focus:border-brand-primary disabled:cursor-not-allowed",value:e,onChange:n,disabled:r,children:s})]})}function nM({label:t,value:e,onChange:n,placeholder:r}){return d.jsxs("div",{className:"space-y-1.5",children:[d.jsx("label",{className:"block text-[11px] font-semibold uppercase tracking-wide text-text-muted",children:t}),d.jsx("input",{className:"w-full rounded-xl border border-stroke-subtle bg-surface px-3 py-2 text-sm text-text-primary outline-none transition focus:border-brand-primary",value:e,onChange:n,placeholder:r})]})}function rM(){var Vs,Ji,qe,Xe;const{sessionId:t}=Na(),n=On().state||{},[r,s]=k.useState(null),[i,o]=k.useState({classCode:n.initialClassCode||null,token:n.initialToken||null,expiresAt:n.initialExpiresAt?new Date(n.initialExpiresAt):null,lastRotatedAt:n.initialExpiresAt?new Date(n.initialExpiresAt):null}),[a,l]=k.useState(null),[c,h]=k.useState(30),[p,m]=k.useState([]),[g,v]=k.useState(""),[E,N]=k.useState(0),[S,_]=k.useState(null),[x,D]=k.useState(null),[O,j]=k.useState(""),[R,w]=k.useState(!1),[C,T]=k.useState(!1),[b,P]=k.useState(!1),[A,X]=k.useState(!1),[ge,Se]=k.useState(null),[fe,z]=k.useState(null),[V,$]=k.useState(!1),{showToast:Q}=Wi();k.useEffect(()=>{const H=setInterval(()=>N(ae=>ae+1),1e3);return()=>clearInterval(H)},[]),k.useEffect(()=>{if(!t)return;const H=nt(ue,"sessions",t),ae=ct(H,Je=>{var pt,Oe,cn;const xe=Je.data();xe&&s({moduleCode:xe.moduleCode,title:xe.title,settings:xe.settings,isActive:xe.isActive,expiresAt:(pt=xe.expiresAt)!=null&&pt.toDate?xe.expiresAt.toDate():null,qrExpiresAt:(cn=(Oe=xe.qr)==null?void 0:Oe.expiresAt)!=null&&cn.toDate?xe.qr.expiresAt.toDate():null,requiredFields:xe.requiredFields||{},stats:xe.stats})});return()=>ae()},[t]),k.useEffect(()=>{if(!t)return;const H=nt(ue,"sessionsPrivate",t),ae=ct(H,Je=>{var pt,Oe;const xe=Je.data();xe&&o({classCode:xe.classCodePlain||null,token:xe.qrTokenPlain||null,expiresAt:(pt=xe.qrExpiresAt)!=null&&pt.toDate?xe.qrExpiresAt.toDate():null,lastRotatedAt:(Oe=xe.lastRotatedAt)!=null&&Oe.toDate?xe.lastRotatedAt.toDate():null})});return()=>ae()},[t]),k.useEffect(()=>{var xe;let H=null,ae=!0;async function Je(){var pt,Oe,cn;if(!(!t||!((pt=r==null?void 0:r.settings)!=null&&pt.requireClassCode)))try{const Ga=await tn(nn,"getSessionPin")({sessionId:t});if(!ae)return;l(((Oe=Ga.data)==null?void 0:Oe.pin)||null),h(Number(((cn=Ga.data)==null?void 0:cn.rotationSeconds)||30))}catch(Os){console.error("getSessionPin error:",Os)}}return(xe=r==null?void 0:r.settings)!=null&&xe.requireClassCode&&(Je(),H=window.setInterval(Je,Math.max(1e3,c*1e3))),()=>{ae=!1,H&&clearInterval(H)}},[t,(Vs=r==null?void 0:r.settings)==null?void 0:Vs.requireClassCode,c]),k.useEffect(()=>{if(!t)return;const H=tt(ue,"sessions",t,"attendance"),ae=ct(H,Je=>{const xe=Je.docs.map(pt=>{var cn;const Oe=pt.data();return{studentNumber:Oe.studentNumber,name:Oe.name,surname:Oe.surname,email:Oe.email,initials:Oe.initials,group:Oe.group,status:Oe.status||"Present",submittedAt:(cn=Oe.submittedAt)!=null&&cn.toDate?Oe.submittedAt.toDate().toISOString():""}});m(xe)});return()=>ae()},[t]);const se=k.useMemo(()=>new Set(p.map(ae=>ae.studentNumber)).size,[p]),ce=((Ji=r==null?void 0:r.stats)==null?void 0:Ji.submissionsCount)??se,ft=i.expiresAt||(r==null?void 0:r.qrExpiresAt)||(r==null?void 0:r.expiresAt)||null,Rt=k.useMemo(()=>ft?Math.max(0,Math.floor((ft.getTime()-Date.now())/1e3)):0,[ft,E]),Ue=i.token,Ye=t&&Ue?`${window.location.origin}/s/${t}?t=${Ue}`:"",un=r!=null&&r.isActive?Rt>0?"Active":"Expired":"Ended",Ms=un==="Active"?"success":un==="Expired"?"warning":"neutral",hr=tM(un.toUpperCase()),_e=((qe=r==null?void 0:r.settings)==null?void 0:qe.windowSeconds)||60,Jt=fe||_e;Fc("inline-flex items-center gap-2 rounded-full border px-3 py-1.5 text-sm font-semibold",Ms==="success"?"border-accent-success/30 bg-accent-success/10 text-accent-success":Ms==="warning"?"border-accent-warning/30 bg-accent-warning/10 text-accent-warning":"border-stroke-subtle bg-surfaceAlt text-text-muted");const zt=k.useCallback(()=>_(null),[]),Qi=k.useCallback(()=>{if(!t)return;const H=`${window.location.origin}/sessions/${t}/display`;window.open(H,"_blank","noopener,noreferrer")},[t]),Yi=k.useCallback(async()=>{if(t){X(!0),_(null);try{await tn(nn,"renewSessionQr")({sessionId:t,windowSeconds:Jt}),Q({message:"QR renewed",variant:"success"})}catch(H){const ae=H.message||"Failed to renew QR code";_(ae),Q({message:ae,variant:"error"})}finally{X(!1)}}},[t,Jt,Q]),qa=k.useCallback(async H=>{if(t){Se(H),_(null);try{await tn(nn,"extendSessionWindow")({sessionId:t,extensionSeconds:H}),Q({message:`Extended session by ${H}s`,variant:"success"})}catch(ae){const Je=ae.message||"Failed to extend session";_(Je),Q({message:Je,variant:"error"})}finally{Se(null)}}},[t,Q]),Uc=k.useCallback(()=>P(!0),[]),$c=k.useCallback(async()=>{if(t){T(!0),_(null);try{await tn(nn,"endSession")({sessionId:t}),P(!1),Q({message:"Session ended",variant:"success"})}catch(H){const ae=H.message||"Failed to end session";_(ae),Q({message:ae,variant:"error"})}finally{T(!1)}}},[t,Q]),Ha=k.useCallback(H=>{D(H),j(""),_(null)},[]),Sn=k.useCallback(()=>{D(null),j("")},[]),rs=(r==null?void 0:r.requiredFields)||{},zc=k.useCallback(async()=>{if(!(!t||!x)){if(!O){_("Reason required"),Q({message:"Reason required",variant:"error"});return}if(window.confirm("Remove this attendance entry? This action is audited.")){w(!0),_(null);try{await tn(nn,"editAttendance")({sessionId:t,studentNumber:x.studentNumber,action:"remove",reason:O}),Sn(),Q({message:"Attendance entry removed",variant:"success"})}catch(H){const ae=H.message||"Failed to remove entry";_(ae),Q({message:ae,variant:"error"})}finally{w(!1)}}}},[t,x,O,Sn,Q]),Xi=k.useCallback(async()=>{if(!(!t||!x)){if(!O){_("Reason required"),Q({message:"Reason required",variant:"error"});return}w(!0),_(null);try{const H=tn(nn,"editAttendance"),ae={status:x.status};["name","surname","initials","email","group"].forEach(Je=>{rs[Je]&&(ae[Je]=x[Je])}),await H({sessionId:t,studentNumber:x.studentNumber,action:"edit",fields:ae,reason:O}),Sn(),Q({message:"Attendance updated",variant:"success"})}catch(H){const ae=H.message||"Failed to edit entry";_(ae),Q({message:ae,variant:"error"})}finally{w(!1)}}},[t,x,O,rs,Sn,Q]);return r?d.jsxs("div",{className:"mx-auto w-full max-w-6xl space-y-6",children:[d.jsx("div",{className:"mb-8",children:d.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between",children:[d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:r.moduleCode}),d.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium text-white ${hr}`,children:un})]}),r.title&&d.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r.title})]}),d.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-white rounded-lg border border-gray-200",children:[d.jsx(JD,{className:"h-4 w-4 text-gray-500"}),d.jsx("span",{className:"text-sm font-medium text-gray-700",children:eM(Rt)})]}),d.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-emerald-50 rounded-lg border border-emerald-200",children:[d.jsx(cS,{className:"h-4 w-4 text-emerald-600"}),d.jsxs("span",{className:"text-sm font-medium text-emerald-700",children:[ce," Present"]})]}),d.jsx(xS,{sessionId:t||""})]})]})}),S?d.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-2xl border border-accent-error/25 bg-accent-error/5 px-4 py-3",children:[d.jsx("p",{className:"text-sm text-accent-error",children:S}),d.jsx("button",{className:"rounded-lg px-2 py-1 text-sm font-semibold text-accent-error hover:bg-accent-error/10",onClick:zt,children:"Dismiss"})]}):null,d.jsxs("div",{className:"grid gap-6 lg:grid-cols-[360px,1fr]",children:[d.jsxs("aside",{className:"space-y-6 rounded-2xl border border-stroke-subtle bg-surface p-5 shadow-subtle",children:[d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h2",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-text-muted",children:"Session controls"}),(Xe=r.settings)!=null&&Xe.requireClassCode&&(a||i.classCode)?d.jsxs("span",{className:"rounded-full border border-stroke-subtle bg-surfaceAlt px-3 py-1 text-xs font-semibold text-text-primary",children:["Code ",d.jsx("span",{className:"font-mono",children:a||i.classCode})]}):null]}),d.jsx("div",{className:"rounded-2xl border border-stroke-subtle bg-surfaceAlt p-4",children:Ye?d.jsxs("div",{className:"relative w-full flex flex-col items-center",children:[d.jsx("div",{className:"absolute -inset-6 flex items-center justify-center pointer-events-none",children:d.jsx("div",{className:"h-[240px] w-[240px] rounded-3xl bg-gradient-to-tr from-blue-400/20 to-indigo-400/10 blur-3xl opacity-60"})}),d.jsx("div",{className:"relative z-10 bg-white p-4 rounded-3xl border border-gray-200 shadow-2xl",children:d.jsx(oS,{value:Ye,size:200,includeMargin:!0,level:"H"})}),d.jsx("div",{className:"mt-4 text-center",children:d.jsxs("button",{type:"button",onClick:async()=>{try{await navigator.clipboard.writeText(Ye),$(!0),Q({message:"Link copied",variant:"success"}),setTimeout(()=>$(!1),1400)}catch{Q({message:"Copy failed",variant:"error"})}},"aria-label":"Copy session link",className:"inline-flex items-center gap-2 text-xs text-gray-500 hover:underline",children:[d.jsx("span",{className:"break-all max-w-[220px]",children:Ye}),V?d.jsx(lS,{className:"h-4 w-4 text-emerald-500"}):d.jsx(VD,{className:"h-4 w-4 text-gray-400"})]})})]}):d.jsx("p",{className:"text-sm text-text-muted",children:"QR code not available yet."})})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs(Yd,{label:"Renew window",value:Jt,onChange:H=>z(Number(H.target.value)),disabled:!r.isActive,children:[h_.map(H=>d.jsx("option",{value:H,children:H<60?`${H}s`:`${H/60} min`},H)),h_.includes(_e)?null:d.jsxs("option",{value:_e,children:["Default"," ",_e<60?`(${_e}s)`:`(${_e/60} min)`]})]}),d.jsx(p_,{onClick:Yi,disabled:!r.isActive||A,className:"w-full",children:A?"Renewing":"Renew QR"}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-text-muted",children:"Extend time"}),d.jsx("div",{className:"flex flex-wrap gap-2",children:Zj.map(H=>d.jsx(jl,{onClick:()=>qa(H),disabled:!r.isActive||ge===H,className:"flex-1",children:ge===H?"Extending":`+${H<60?`${H}s`:`${H/60}m`}`},H))})]}),d.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[d.jsx(jl,{onClick:Qi,className:"w-full",children:"Display mode"}),d.jsx(Qd,{onClick:Uc,disabled:C||!r.isActive,className:"w-full",children:"End session"})]})]})]}),d.jsxs("section",{className:"space-y-4 rounded-2xl border border-stroke-subtle bg-surface p-5 shadow-subtle",children:[d.jsx("div",{className:"border-b border-gray-200 bg-gray-50 px-6 py-4",children:d.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-base font-semibold text-gray-900",children:"Live Attendance"}),d.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:[p.length," submission",p.length!==1?"s":""]})]}),d.jsxs("div",{className:"relative",children:[d.jsx(KD,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),d.jsx("input",{className:"w-full sm:w-64 rounded-lg border border-gray-200 pl-9 pr-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-gray-900",placeholder:"Search students...",value:g,onChange:H=>v(H.target.value)})]})]})}),d.jsx(wS,{data:p,globalFilter:g,onGlobalFilterChange:v,onEdit:Ha})]})]}),x?d.jsx(f_,{title:`Edit attendance  ${x.studentNumber}`,description:"Changes are audit-logged. A reason is required.",onClose:Sn,children:d.jsxs("div",{className:"space-y-4",children:[d.jsx("div",{className:"grid gap-3",children:["name","surname","initials","email","group"].filter(H=>rs&&rs[H]).map(H=>d.jsx(nM,{label:H,value:x[H]||"",onChange:ae=>D({...x,[H]:ae.target.value}),placeholder:`Enter ${H}`},H))}),d.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[d.jsxs(Yd,{label:"Status",value:x.status||"Present",onChange:H=>D({...x,status:H.target.value}),children:[d.jsx("option",{value:"Present",children:"Present"}),d.jsx("option",{value:"Absent",children:"Absent"}),d.jsx("option",{value:"Excused",children:"Excused"})]}),d.jsxs(Yd,{label:"Reason (required)",value:O,onChange:H=>j(H.target.value),children:[d.jsx("option",{value:"",children:"Select"}),d.jsx("option",{value:"Phone died",children:"Phone died"}),d.jsx("option",{value:"Typo correction",children:"Typo correction"}),d.jsx("option",{value:"Duplicate entry removed",children:"Duplicate entry removed"}),d.jsx("option",{value:"Other",children:"Other"})]})]}),d.jsxs("div",{className:"flex flex-wrap justify-end gap-2 pt-1",children:[d.jsx(jl,{onClick:Sn,disabled:R,children:"Cancel"}),d.jsx(Qd,{onClick:zc,disabled:R,children:R?"Working":"Remove"}),d.jsx(p_,{onClick:Xi,disabled:R,children:R?"Saving":"Save"})]})]})}):null,b?d.jsx(f_,{title:"End session",description:"Ending prevents new submissions. This action is audit-logged.",onClose:()=>P(!1),children:d.jsxs("div",{className:"flex justify-end gap-2",children:[d.jsx(jl,{onClick:()=>P(!1),disabled:C,children:"Cancel"}),d.jsx(Qd,{onClick:$c,disabled:C,children:C?"Ending":"End session"})]})}):null]}):d.jsx("div",{className:"mx-auto w-full max-w-6xl",children:d.jsx("div",{className:"mt-6 flex h-56 items-center justify-center rounded-2xl border border-stroke-subtle bg-surface text-sm text-text-muted",children:"Loading session"})})}function sM(){const t=Ut.currentUser,[e,n]=k.useState([]);return k.useEffect(()=>{if(!t)return;const r=tt(ue,"sessions"),s=ar(r,Mi("lecturerId","==",t.uid),Ba("createdAt","desc")),i=ct(s,o=>{const a=o.docs.map(l=>{var h;const c=l.data();return{id:l.id,moduleCode:c.moduleCode,title:c.title,createdAt:(h=c.createdAt)!=null&&h.toDate?c.createdAt.toDate().toISOString():"",stats:c.stats,isActive:c.isActive}});n(a)});return()=>i()},[t]),d.jsxs("div",{className:"space-y-8",children:[d.jsx(Ki,{title:"Attendance history",description:"Review completed sessions and export records.",showBack:!1}),d.jsx("section",{className:"rounded-md border border-stroke-subtle bg-surface shadow-subtle",children:d.jsxs("ul",{className:"divide-y divide-stroke-subtle",children:[e.map(r=>{var s;return d.jsxs("li",{className:"flex flex-col gap-3 px-6 py-4 sm:flex-row sm:items-center sm:justify-between",children:[d.jsxs("div",{children:[d.jsxs("p",{className:"text-sm font-semibold text-text-primary",children:[r.moduleCode,r.title?`  ${r.title}`:""]}),d.jsx("p",{className:"text-xs text-text-muted",children:r.createdAt||"--"})]}),d.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d.jsxs("span",{className:"rounded-md border border-stroke-subtle px-3 py-1 text-xs text-text-muted",children:[((s=r.stats)==null?void 0:s.submissionsCount)??0," submissions"]}),d.jsx("span",{className:`rounded-md px-3 py-1 text-xs font-medium ${r.isActive?"bg-accent-success/10 text-accent-success":"bg-surfaceAlt text-text-muted"}`,children:r.isActive?"Active":"Closed"}),d.jsx(br,{to:`/history/${r.id}`,className:"text-sm font-semibold text-brand-primary hover:underline",children:"View / Export"})]})]},r.id)}),e.length===0&&d.jsx("li",{className:"px-6 py-10 text-center text-sm text-text-muted",children:"No sessions recorded yet."})]})})]})}function iM(){var p;const{sessionId:t}=Na(),[e,n]=k.useState(null),[r,s]=k.useState([]),[i,o]=k.useState("");k.useEffect(()=>{if(!t)return;const m=nt(ue,"sessions",t),g=ct(m,v=>{var N;const E=v.data();E&&n({moduleCode:E.moduleCode,title:E.title,createdAt:(N=E.createdAt)!=null&&N.toDate?E.createdAt.toDate():null,stats:E.stats})});return()=>g()},[t]),k.useEffect(()=>{if(!t)return;const m=tt(ue,"sessions",t,"attendance"),g=ct(m,v=>{const E=v.docs.map(N=>{var _;const S=N.data();return{studentNumber:S.studentNumber,name:S.name,surname:S.surname,email:S.email,initials:S.initials,group:S.group,status:S.status||"Present",submittedAt:(_=S.submittedAt)!=null&&_.toDate?S.submittedAt.toDate().toISOString():""}});s(E)});return()=>g()},[t]);const a=k.useMemo(()=>new Set(r.map(m=>m.studentNumber)).size,[r]),l=((p=e==null?void 0:e.stats)==null?void 0:p.submissionsCount)??r.length,c=e?`${e.moduleCode}${e.title?`  ${e.title}`:""}`:"Loading session...",h=k.useMemo(()=>{if(!(e!=null&&e.createdAt))return"--";try{return new Intl.DateTimeFormat(void 0,{dateStyle:"medium",timeStyle:"short"}).format(e.createdAt)}catch{return e.createdAt.toISOString()}},[e==null?void 0:e.createdAt]);return d.jsxs("div",{className:"space-y-8",children:[d.jsx(Ki,{title:"Session details",description:c,action:d.jsx(xS,{sessionId:t||""})}),d.jsx("section",{className:"rounded-3xl border border-stroke-subtle bg-surface p-6 shadow-subtle",children:d.jsxs("div",{className:"grid gap-4 sm:grid-cols-3",children:[d.jsxs("div",{className:"rounded-2xl border border-stroke-subtle bg-surfaceAlt p-4",children:[d.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-text-muted",children:"Created"}),d.jsx("p",{className:"mt-2 text-sm font-semibold text-text-primary",children:h}),d.jsx("p",{className:"mt-1 text-xs text-text-muted",children:"Timestamp captured when the session opened."})]}),d.jsxs("div",{className:"rounded-2xl border border-brand-soft bg-surfaceAlt p-4",children:[d.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-brand-primary",children:"Total submissions"}),d.jsx("p",{className:"mt-2 text-2xl font-semibold text-text-primary",children:l}),d.jsx("p",{className:"mt-1 text-xs text-text-muted",children:"Includes duplicates for auditing."})]}),d.jsxs("div",{className:"rounded-2xl border border-accent-success/40 bg-accent-success/5 p-4",children:[d.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-accent-success",children:"Unique students"}),d.jsx("p",{className:"mt-2 text-2xl font-semibold text-text-primary",children:a}),d.jsx("p",{className:"mt-1 text-xs text-text-muted",children:"Deduplicated by student number."})]})]})}),d.jsxs("section",{className:"space-y-4 rounded-3xl border border-stroke-subtle bg-surface p-6 shadow-subtle",children:[d.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Attendance log"}),d.jsx("p",{className:"text-sm text-text-muted",children:"Review the records captured during this session."})]}),d.jsx("input",{className:"w-full rounded-full border border-stroke-subtle px-4 py-2 text-sm focus:border-brand-secondary focus:outline-none sm:w-72",placeholder:"Search students",value:i,onChange:m=>o(m.target.value)})]}),d.jsx(wS,{data:r,globalFilter:i,onGlobalFilterChange:o})]})]})}function Xd({label:t,value:e,hint:n,action:r}){return d.jsx("div",{className:"rounded-2xl border border-stroke-subtle bg-surface p-4 shadow-subtle",children:d.jsxs("div",{className:"flex items-start justify-between gap-3",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-text-muted",children:t}),d.jsx("p",{className:"mt-2 text-2xl font-semibold text-text-primary",children:e}),n?d.jsx("p",{className:"mt-1 text-sm text-text-muted",children:n}):null]}),r?d.jsx("div",{children:r}):null]})})}function oM({value:t,max:e=100}){const n=Math.max(0,Math.min(100,Math.round(t/e*100)));return d.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-surfaceAlt",children:d.jsx("div",{className:"h-2 bg-brand-primary",style:{width:`${n}%`}})})}function Eo({title:t,subtitle:e,right:n}){return d.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-end sm:justify-between",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:t}),e?d.jsx("p",{className:"mt-1 text-sm text-text-muted",children:e}):null]}),n?d.jsx("div",{children:n}):null]})}function ES({moduleId:t}){const[e,n]=k.useState(null),[r,s]=k.useState([]),[i,o]=k.useState([]),[a,l]=k.useState(!0);k.useEffect(()=>{let j=!0;return(async()=>{if(t){l(!0);try{const R=nt(ue,"moduleStats",t),w=await Vc(R);if(!w.exists()){j&&n(null);return}const C=w.data();j&&n(C);const T=await gi(tt(ue,`moduleRosters/${t}/students`)),b=[];T.forEach(X=>b.push({id:X.id,...X.data()})),j&&s(b);const P=await gi(tt(ue,`moduleStudents/${t}/students`)),A=[];P.forEach(X=>A.push({id:X.id,...X.data()})),j&&o(A)}finally{j&&l(!1)}}})(),()=>{j=!1}},[t]);const c=Number((e==null?void 0:e.sessionsCount)||0),h=k.useMemo(()=>{const j=new Map(r.map(C=>[String(C.studentNumber||C.id||"").trim(),C])),R=new Map(i.map(C=>[String(C.studentNumber||C.id||"").trim(),C])),w=[];return j.forEach((C,T)=>{const b=String(T||"").trim(),P=R.get(b)||{},A=Number(P.attendedCount||0),X=c?Math.max(0,c-A):null;w.push({studentNumber:b,name:C.name||P.name||"",surname:C.surname||P.surname||"",attended:A,absent:X,late:Number(P.lateCount||0)})}),i.forEach(C=>{const T=String(C.studentNumber||C.id||"").trim();if(j.has(T))return;const b=Number(C.attendedCount||0),P=c?Math.max(0,c-b):null;w.push({studentNumber:T,name:C.name||"",surname:C.surname||"",attended:b,absent:P,late:Number(C.lateCount||0)})}),w.sort((C,T)=>(C.studentNumber||"").localeCompare(T.studentNumber||"")),w},[r,i,c]),p=k.useMemo(()=>h.filter(j=>j.absent!==null).sort((j,R)=>Number(R.absent||0)-Number(j.absent||0)).slice(0,10),[h]),m=k.useMemo(()=>Object.keys((e==null?void 0:e.weekly)||{}).sort().map(R=>{const w=e.weekly[R],C=w.sessions?w.totalAttendance/w.sessions:0;return{week:R,avg:C}}),[e]),g=k.useMemo(()=>Object.keys((e==null?void 0:e.checkinCurvePercent)||{}),[e]);function v(){const R=[["Module",(e==null?void 0:e.moduleCode)||(e==null?void 0:e.moduleTitle)||(e==null?void 0:e.moduleId)||t],["AvgAttendance",String((e==null?void 0:e.avgAttendance)||"")],["SessionsCount",String(c||0)],[],["StudentNumber","Name","Attended","Absent","Late"],...h.map(P=>[P.studentNumber,`${P.name} ${P.surname}`.trim(),String(P.attended||0),String(P.absent??""),String(P.late||0)])].map(P=>P.map(A=>`"${String(A).replace(/"/g,'""')}"`).join(",")).join(`
`),w="\uFEFF",C=new Blob([w+R],{type:"text/csv;charset=utf-8;"}),T=URL.createObjectURL(C),b=document.createElement("a");b.href=T,b.download=`${t}-summary.csv`,b.click(),URL.revokeObjectURL(T)}if(!t)return d.jsx("div",{className:"rounded-2xl border border-stroke-subtle bg-surface p-6 text-sm text-text-muted shadow-subtle",children:"Select a module to view analytics."});if(a)return d.jsx("div",{className:"rounded-2xl border border-stroke-subtle bg-surface p-6 text-sm text-text-muted shadow-subtle",children:"Loading module analytics"});if(!e)return d.jsx("div",{className:"rounded-2xl border border-stroke-subtle bg-surface p-6 text-sm text-text-muted shadow-subtle",children:"No stats available for this module yet."});const E=e.moduleCode||e.moduleTitle||e.moduleId||t,N=e.moduleTitle||null,_=Number(e.avgAttendance||0).toFixed(2),x=e.medianCheckinMinutes??null,D=typeof x=="number"?x.toFixed(2):"",O=Object.entries(e.heatmap||{});return d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"rounded-2xl border border-stroke-subtle bg-surface p-5 shadow-subtle",children:[d.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.22em] text-text-muted",children:"Module"}),d.jsx("div",{className:"mt-1 text-xl font-semibold text-text-primary",children:E}),N?d.jsx("div",{className:"mt-1 text-sm text-text-muted",children:N}):null]}),d.jsxs("div",{className:"grid gap-4 sm:grid-cols-3",children:[d.jsx(Xd,{label:"Avg attendance",value:_,hint:`Sessions: ${c}`}),d.jsx(Xd,{label:"Median check-in (min)",value:D,hint:"Completion curve below."}),d.jsx(Xd,{label:"Export",value:"CSV",hint:"Download a roster summary for this module.",action:d.jsx("button",{onClick:v,className:"rounded-full bg-brand-primary px-4 py-2 text-sm font-semibold text-text-onBrand shadow-brand transition hover:bg-brand-primary/90",children:"Export CSV"})})]}),d.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[d.jsxs("div",{className:"space-y-6 lg:col-span-2",children:[d.jsxs("div",{className:"rounded-2xl border border-stroke-subtle bg-surface p-5 shadow-subtle",children:[d.jsx(Eo,{title:"Weekly trend",subtitle:"Average attendance per week (relative bars)."}),d.jsx("div",{className:"mt-4 flex items-end gap-2",style:{height:120},children:m.length===0?d.jsx("div",{className:"text-sm text-text-muted",children:"No weekly data."}):m.map(j=>{const R=Math.max(...m.map(C=>C.avg),1),w=Math.round(j.avg/R*100);return d.jsxs("div",{className:"flex-1 text-center",children:[d.jsx("div",{className:"mx-auto w-full rounded-t bg-brand-soft",style:{height:`${w}%`}}),d.jsx("div",{className:"mt-2 text-[11px] text-text-muted",children:j.week})]},j.week)})})]}),d.jsxs("div",{className:"rounded-2xl border border-stroke-subtle bg-surface p-5 shadow-subtle",children:[d.jsx(Eo,{title:"Heatmap",subtitle:"Average attendance by day + hour bucket."}),d.jsx("div",{className:"mt-4 grid grid-cols-2 gap-2 sm:grid-cols-3 lg:grid-cols-4",children:O.length===0?d.jsx("div",{className:"col-span-full text-sm text-text-muted",children:"No heatmap data."}):O.map(([j,R])=>{const C=(R.sessions?Number(R.totalAttendance/R.sessions):0).toFixed(2);Number(e.avgAttendance||1);const T=alpha<.18,b=T?void 0:{background:`rgba(59,130,246, ${alpha})`},P=`rounded-xl border border-stroke-subtle p-3 ${T?"bg-surfaceAlt":""}`;return d.jsxs("div",{className:P,style:b,children:[d.jsx("div",{className:`text-xs font-semibold ${T?"text-text-primary":"text-white"}`,children:j.replace("_"," ")}),d.jsxs("div",{className:`mt-1 text-xs ${T?"text-text-muted":"text-white/90"}`,children:["Avg ",C]})]},j)})})]})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"rounded-2xl border border-stroke-subtle bg-surface p-5 shadow-subtle",children:[d.jsx(Eo,{title:"Completion curve",subtitle:"How quickly students check in."}),d.jsx("div",{className:"mt-4 space-y-3",children:g.length===0?d.jsx("div",{className:"text-sm text-text-muted",children:"No curve data."}):g.map(j=>{var C;const R=Number(((C=e.checkinCurvePercent)==null?void 0:C[j])??0),w=R.toFixed(2);return d.jsxs("div",{children:[d.jsxs("div",{className:"mb-1 flex items-center justify-between",children:[d.jsx("div",{className:"text-xs text-text-muted",children:j}),d.jsxs("div",{className:"text-xs font-semibold text-text-primary",children:[w,"%"]})]}),d.jsx(oM,{value:R,max:100})]},j)})})]}),d.jsxs("div",{className:"rounded-2xl border border-stroke-subtle bg-surface p-5 shadow-subtle",children:[d.jsx(Eo,{title:"Top absentees",subtitle:"Highest missed sessions (if roster exists)."}),d.jsx("div",{className:"mt-4 space-y-3",children:p.length===0?d.jsx("div",{className:"text-sm text-text-muted",children:"No roster / attendance data to compute absentees."}):p.map(j=>d.jsxs("div",{className:"flex items-center justify-between gap-3",children:[d.jsxs("div",{className:"min-w-0",children:[d.jsx("div",{className:"truncate text-sm font-semibold text-text-primary",children:j.name?`${j.name} ${j.surname||""}`.trim():j.studentNumber}),d.jsx("div",{className:"truncate text-xs text-text-muted",children:j.studentNumber})]}),d.jsxs(vi,{tone:"warning",title:`Missed ${j.absent} sessions`,children:["Absent ",j.absent]})]},j.studentNumber))})]})]})]}),d.jsxs("div",{className:"rounded-2xl border border-stroke-subtle bg-surface p-5 shadow-subtle",children:[d.jsx(Eo,{title:"Students",subtitle:"Attendance banding (Green/Amber/Red) based on attended sessions.",right:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"hidden sm:block text-xs text-text-muted",children:"Green 80%  Amber 6079%  Red <60% (Red = low attendance)"}),d.jsx(vi,{children:h.length})]})}),d.jsx("div",{className:"mt-4 divide-y divide-stroke-subtle rounded-2xl border border-stroke-subtle",children:h.length===0?d.jsx("div",{className:"p-4 text-sm text-text-muted",children:"No students found. Upload roster or wait for recompute."}):h.map(j=>{const R=c?j.attended/c:null,w=R===null?"Unknown":R>=.8?"Green":R>=.6?"Amber":"Red",C=w==="Green"?"success":w==="Amber"?"warning":w==="Red"?"danger":"neutral";return d.jsxs("div",{className:"flex items-center justify-between gap-4 p-4 hover:bg-surfaceAlt",children:[d.jsxs("div",{className:"min-w-0",children:[d.jsxs("div",{className:"truncate text-sm font-semibold text-text-primary",children:[j.studentNumber,j.name?d.jsxs("span",{className:"text-text-muted",children:["  ",j.name]}):null,j.surname?d.jsxs("span",{className:"text-text-muted",children:[" ",j.surname]}):null]}),d.jsxs("div",{className:"mt-1 text-xs text-text-muted",children:["Attended: ",j.attended,"  Late: ",j.late,"  Absent: ",j.absent??""]})]}),d.jsx(vi,{tone:C,children:w})]},j.studentNumber)})})]})]})}const aM=Object.freeze(Object.defineProperty({__proto__:null,ModuleAnalyticsView:ES},Symbol.toStringTag,{value:"Module"})),lM=aM&&ES||function(){return d.jsx("div",{className:"rounded-2xl border border-stroke-subtle bg-surface p-6 text-sm text-text-muted shadow-subtle",children:"Module analytics component unavailable."})};function uM(...t){return t.filter(Boolean).join(" ")}function Jd(){return d.jsxs("div",{className:"animate-pulse rounded-xl border border-stroke-subtle bg-surface px-3 py-3",children:[d.jsx("div",{className:"h-4 w-2/3 rounded bg-surfaceAlt"}),d.jsx("div",{className:"mt-2 h-3 w-1/2 rounded bg-surfaceAlt"})]})}function cM(){const[t,e]=k.useState([]),[n,r]=k.useState(null),[s,i]=k.useState(!0),[o,a]=k.useState(!1),[l,c]=k.useState(null),h=k.useCallback(async()=>{i(!0);try{const g=await gi(tt(ue,"moduleStats")),v=[];g.forEach(E=>v.push({id:E.id,...E.data()})),v.sort((E,N)=>{const S=Number(E.sessionsCount||0),_=Number(N.sessionsCount||0);if(_!==S)return _-S;const x=String(E.moduleCode||E.moduleTitle||E.moduleId||E.id||""),D=String(N.moduleCode||N.moduleTitle||N.moduleId||N.id||"");return x.localeCompare(D)}),e(v),v.length&&!n&&r(v[0].id)}finally{i(!1)}},[n]);k.useEffect(()=>{let g=!0;return(async()=>g&&await h())(),()=>{g=!1}},[h]);const p=k.useMemo(()=>n&&t.find(g=>g.id===n)||null,[t,n]),m=k.useCallback(async()=>{var g;a(!0),c(null);try{const E=await tn(nn,"recomputeModuleStatsNow")({days:90});c((g=E==null?void 0:E.data)!=null&&g.result?`Recomputed ${E.data.result.modulesProcessed} modules`:"Recompute completed"),await h()}catch(v){c((v==null?void 0:v.message)||"Recompute failed")}finally{a(!1)}},[h]);return d.jsxs("div",{className:"mx-auto w-full max-w-6xl space-y-6",children:[d.jsx("div",{className:"rounded-2xl border border-stroke-subtle bg-surface p-6 shadow-subtle",children:d.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.22em] text-text-muted",children:"Analytics"}),d.jsx("h1",{className:"text-2xl font-semibold tracking-tight text-text-primary",children:"Attendance insights"}),d.jsx("p",{className:"max-w-2xl text-sm text-text-muted",children:"Trends, heatmaps, completion curves, and integrity signalsorganised per module."})]}),d.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[d.jsx(nS,{onClick:m,disabled:o,children:o?"Recomputing":"Recompute (90 days)"}),l?d.jsx(vi,{children:l}):null]})]})}),d.jsxs("div",{className:"grid gap-6 lg:grid-cols-[320px,1fr]",children:[d.jsxs("aside",{className:"rounded-2xl border border-stroke-subtle bg-surface p-4 shadow-subtle",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h2",{className:"text-sm font-semibold text-text-primary",children:"Modules"}),d.jsx(vi,{tone:t.length?"success":"neutral",children:t.length})]}),d.jsx("div",{className:"mt-3 space-y-2",children:s?d.jsxs(d.Fragment,{children:[d.jsx(Jd,{}),d.jsx(Jd,{}),d.jsx(Jd,{})]}):t.length===0?d.jsx("div",{className:"rounded-xl border border-dashed border-stroke-subtle bg-surfaceAlt p-4 text-sm text-text-muted",children:"No module stats yet. Run a session or trigger a recompute."}):t.map(g=>{const v=g.moduleCode||g.moduleTitle||g.moduleId||g.id||"Module",E=g.moduleTitle&&g.moduleCode?g.moduleTitle:null,N=Math.round(Number(g.avgAttendance||0)*100)/100,S=n===g.id;return d.jsxs("button",{onClick:()=>r(g.id),className:uM("w-full rounded-xl border px-3 py-3 text-left transition",S?"border-brand-primary/30 bg-brand-soft":"border-stroke-subtle bg-surface hover:bg-surfaceAlt"),children:[d.jsxs("div",{className:"flex items-start justify-between gap-3",children:[d.jsxs("div",{className:"min-w-0",children:[d.jsx("div",{className:"truncate text-sm font-semibold text-text-primary",children:v}),E?d.jsx("div",{className:"mt-0.5 truncate text-xs text-text-muted",children:E}):null]}),d.jsxs("span",{className:"shrink-0 rounded-full border border-stroke-subtle bg-surfaceAlt px-2 py-1 text-[11px] font-semibold text-text-muted",children:["Avg ",N]})]}),d.jsxs("div",{className:"mt-2 text-xs text-text-muted",children:["Sessions: ",g.sessionsCount||0,"  Total: ",g.totalAttendance||0]})]},g.id)})}),d.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[d.jsx(Y2,{onClick:h,disabled:s||o,children:"Refresh"}),p?d.jsxs("span",{className:"text-xs text-text-muted",children:["Viewing:"," ",d.jsx("span",{className:"font-semibold text-text-primary",children:p.moduleCode||p.moduleTitle||p.id})]}):d.jsx("span",{className:"text-xs text-text-muted",children:"Select a module"})]})]}),d.jsx("section",{className:"min-h-[320px]",children:n?d.jsx(lM,{moduleId:n}):d.jsx("div",{className:"rounded-2xl border border-stroke-subtle bg-surface p-6 text-sm text-text-muted shadow-subtle",children:"Select a module to begin."})})]})]})}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function dM(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(h){try{c(r.next(h))}catch(p){o(p)}}function l(h){try{c(r.throw(h))}catch(p){o(p)}}function c(h){h.done?i(h.value):s(h.value).then(a,l)}c((r=r.apply(t,[])).next())})}function hM(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(h){return l([c,h])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=c[0]&2?s.return:c[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,c[1])).done)return i;switch(s=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,s=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){n.label=c[1];break}if(c[0]===6&&n.label<i[1]){n.label=i[1],i=c;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(c);break}i[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(h){c=[6,h],s=0}finally{r=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ii=function(){return ii=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ii.apply(this,arguments)},SS=function(t){return{loading:t==null,value:t}},fM=function(){return function(t,e){switch(e.type){case"error":return ii(ii({},t),{error:e.error,loading:!1,value:void 0});case"reset":return SS(e.defaultValue);case"value":return ii(ii({},t),{error:void 0,loading:!1,value:e.value});default:return t}}},pM=function(t){var e=t?t():void 0,n=k.useReducer(fM(),SS(e)),r=n[0],s=n[1],i=k.useCallback(function(){var l=t?t():void 0;s({type:"reset",defaultValue:l})},[t]),o=k.useCallback(function(l){s({type:"error",error:l})},[]),a=k.useCallback(function(l){s({type:"value",value:l})},[]);return k.useMemo(function(){return{error:r.error,loading:r.loading,reset:i,setError:o,setValue:a,value:r.value}},[r.error,r.loading,i,o,a,r.value])},mM=function(t,e){var n=pM(function(){return t.currentUser}),r=n.error,s=n.loading,i=n.setError,o=n.setValue,a=n.value;return k.useEffect(function(){var l=dN(t,function(c){return dM(void 0,void 0,void 0,function(){var h;return hM(this,function(p){switch(p.label){case 0:return[3,4];case 1:return p.trys.push([1,3,,4]),[4,e.onUserChanged(c)];case 2:return p.sent(),[3,4];case 3:return h=p.sent(),i(h),[3,4];case 4:return o(c),[2]}})})},i);return function(){l()}},[t]),[a,s,r]};function gM(){const[t,e]=mM(Ut);return e?d.jsx("div",{className:"flex h-screen items-center justify-center bg-slate-100",children:d.jsx("span",{className:"text-slate-500",children:"Loading..."})}):t?d.jsx(L0,{}):d.jsx(pR,{to:"/login",replace:!0})}function yM(){const t=Ut.currentUser,[e,n]=k.useState(null),[r,s]=k.useState(!0),[i,o]=k.useState(null);k.useEffect(()=>{let l=!0;return(async()=>{var h,p,m,g,v;if(!t){o("No authenticated lecturer found."),s(!1);return}try{const E=nt(ue,"lecturers",t.uid),N=await Vc(E);if(!l)return;if(N.exists()){const S=N.data();n({...S,email:S.email||t.email||void 0,createdAt:(h=S.createdAt)!=null&&h.toDate?S.createdAt.toDate().toISOString():(p=t.metadata)==null?void 0:p.creationTime})}else n({firstName:((m=t.displayName)==null?void 0:m.split(" ")[0])||"",lastName:((g=t.displayName)==null?void 0:g.split(" ").slice(1).join(" "))||"",displayName:t.displayName||"",email:t.email||"",department:"",createdAt:((v=t.metadata)==null?void 0:v.creationTime)||""})}catch(E){if(!l)return;o(E.message||"Failed to load profile data")}finally{l&&s(!1)}})(),()=>{l=!1}},[t]);const a=(e==null?void 0:e.displayName)||`${(e==null?void 0:e.firstName)||""} ${(e==null?void 0:e.lastName)||""}`.trim();return d.jsxs("div",{className:"space-y-8",children:[d.jsx(Ki,{title:"My profile",description:"Review your lecturer details.",showBack:!1}),d.jsx("section",{className:"rounded-md border border-stroke-subtle bg-surface p-6 shadow-subtle",children:r?d.jsx("p",{className:"text-sm text-text-muted",children:"Loading profile..."}):i?d.jsx("p",{className:"text-sm text-accent-error",children:i}):d.jsxs("dl",{className:"grid gap-5 sm:grid-cols-2",children:[d.jsxs("div",{children:[d.jsx("dt",{className:"text-xs font-semibold uppercase text-text-muted",children:"Full name"}),d.jsx("dd",{className:"mt-1 text-sm text-text-primary",children:a||"--"})]}),d.jsxs("div",{children:[d.jsx("dt",{className:"text-xs font-semibold uppercase text-text-muted",children:"Email"}),d.jsx("dd",{className:"mt-1 text-sm text-text-primary",children:(e==null?void 0:e.email)||(t==null?void 0:t.email)||"--"})]}),d.jsxs("div",{children:[d.jsx("dt",{className:"text-xs font-semibold uppercase text-text-muted",children:"Department"}),d.jsx("dd",{className:"mt-1 text-sm text-text-primary",children:(e==null?void 0:e.department)||"--"})]}),d.jsxs("div",{children:[d.jsx("dt",{className:"text-xs font-semibold uppercase text-text-muted",children:"Account created"}),d.jsx("dd",{className:"mt-1 text-sm text-text-primary",children:(e==null?void 0:e.createdAt)||"--"})]})]})})]})}function vM(t){return t?t.split(" ").map(e=>e[0]).slice(0,2).join("").toUpperCase():"U"}function m_(){const[t,e]=k.useState(!1),n=$t(),r=Ut.currentUser;return d.jsxs("div",{className:"relative",children:[d.jsx("button",{onClick:()=>e(s=>!s),"aria-haspopup":"true","aria-label":"Profile menu",className:"flex h-9 w-9 items-center justify-center rounded-full bg-surfaceAlt text-text-primary",children:r!=null&&r.photoURL?d.jsx("img",{src:r.photoURL,alt:"avatar",className:"h-9 w-9 rounded-full object-cover block"}):d.jsx("span",{className:"font-semibold text-sm",children:vM(r==null?void 0:r.displayName)})}),t&&d.jsxs("div",{className:"absolute right-0 mt-2 w-44 rounded-md border border-stroke-subtle bg-surface shadow-md",children:[d.jsx("button",{onClick:()=>{e(!1),n("/settings")},className:"w-full text-left px-4 py-2 text-sm hover:bg-surfaceAlt",children:"Settings"}),d.jsx("button",{onClick:()=>{e(!1),n("/profile")},className:"w-full text-left px-4 py-2 text-sm hover:bg-surfaceAlt",children:"Account"}),d.jsx("div",{className:"border-t border-stroke-subtle"}),d.jsx("button",{onClick:()=>hN(Ut),className:"w-full text-left px-4 py-2 text-sm text-accent-error hover:bg-surfaceAlt",children:"Logout"})]})]})}const bf=[{label:"Dashboard",to:"/",icon:zD},{label:"Modules",to:"/modules",icon:SD},{label:"Sessions",to:"/sessions/new",icon:uS},{label:"Schedules",to:"/schedules",icon:ID},{label:"Analytics",to:"/analytics",icon:RD},{label:"History",to:"/history",icon:LD},{label:"Settings",to:"/settings",icon:YD}];function CS({item:t,onClick:e}){const n=t.icon;return d.jsx(RR,{to:t.to,end:t.to==="/",onClick:e,className:({isActive:r})=>["flex items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium transition-all",r?"bg-white/15 text-white":"text-white/70 hover:bg-white/10 hover:text-white"].join(" "),children:({isActive:r})=>d.jsxs(d.Fragment,{children:[d.jsx(n,{className:`h-4 w-4 ${r?"text-white":"text-white/70"}`}),d.jsx("span",{children:t.label}),r&&d.jsx("span",{className:"ml-auto h-1.5 w-1.5 rounded-full bg-white"})]})})}function _M({children:t}){return t?d.jsx("div",{className:"flex items-center gap-3",children:t}):null}function wM({isOpen:t,onClose:e}){const n=$t();return t?d.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[d.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:e}),d.jsxs("div",{className:"fixed left-0 top-0 bottom-0 w-64 bg-brand-primary p-6 shadow-xl",children:[d.jsxs("div",{className:"flex items-center justify-between mb-8",children:[d.jsxs("button",{onClick:()=>{n("/"),e()},className:"text-left",children:[d.jsx("div",{className:"text-xs font-semibold uppercase tracking-[0.35em] text-white/60",children:"RollCall"}),d.jsx("div",{className:"mt-1 text-lg font-semibold text-white",children:"Lecturer Console"})]}),d.jsx("button",{onClick:e,className:"rounded-lg p-1 hover:bg-white/10 transition-colors",children:d.jsx(tj,{className:"h-5 w-5 text-white"})})]}),d.jsx("nav",{className:"space-y-1",children:bf.map(r=>d.jsx(CS,{item:r,onClick:e},r.to))}),d.jsxs("div",{className:"absolute bottom-6 left-6 right-6 text-xs text-white/50",children:[" ",new Date().getFullYear()," RollCall"]})]})]}):null}function xM(){var E;const t=$t(),e=On(),n=Ut.currentUser,[r,s]=k.useState(!1),[i,o]=k.useState(null),[a,l]=k.useState(null),[c,h]=k.useState(null),[p,m]=k.useState(null),g=/^\/sessions\/[\w-]+\/live$/.test(e.pathname),v=((E=bf.find(N=>N.to==="/"?e.pathname==="/":e.pathname.startsWith(N.to)))==null?void 0:E.label)||"Dashboard";return k.useEffect(()=>{if(!n)return;const N=tt(ue,"sessions"),S=ar(N,Mi("lecturerId","==",n.uid),Ba("createdAt","desc")),_=ct(S,async x=>{const D=x.docs.map(b=>({id:b.id,...b.data()})),O=Date.now(),j=D.filter(b=>{var A;const P=(A=b.expiresAt)!=null&&A.toDate?b.expiresAt.toDate().getTime():b.expiresAt?new Date(b.expiresAt).getTime():null;return b.isActive&&(!P||P>O)}).length;o(j);const R=new Date;R.setHours(0,0,0,0);const w=new Date;w.setHours(23,59,59,999);const C=D.filter(b=>{var A,X;const P=(A=b.scheduledAt)!=null&&A.toDate?b.scheduledAt.toDate():b.scheduledAt?new Date(b.scheduledAt):(X=b.createdAt)!=null&&X.toDate?b.createdAt.toDate():b.createdAt?new Date(b.createdAt):null;return P?P.getTime()>=R.getTime()&&P.getTime()<=w.getTime():!1}).length;l(C);const T=D.reduce((b,P)=>{var A;return b+(((A=P.stats)==null?void 0:A.submissionsCount)||0)},0);try{const b=tt(ue,"modules"),A=(await gi(ar(b,Mi("lecturerId","==",n.uid)))).docs.map(fe=>fe.id),X=new Set;for(const fe of A){try{(await gi(tt(ue,`moduleRosters/${fe}/students`))).forEach(V=>X.add(String(V.data().studentNumber||V.id)))}catch{}try{(await gi(tt(ue,`moduleStudents/${fe}/students`))).forEach(V=>X.add(String(V.data().studentNumber||V.id)))}catch{}}const ge=X.size;h(ge||null);const Se=D.length||0;if(ge>0&&Se>0){const fe=ge*Se,z=Math.round(T/fe*100);m(Number.isFinite(z)?z:null)}else m(null)}catch{h(null),m(null)}});return()=>_()},[n]),d.jsxs("div",{className:"min-h-screen bg-gray-50",children:[d.jsxs("aside",{className:"hidden lg:flex fixed left-0 top-0 bottom-0 w-64 flex-col bg-gray-900",children:[d.jsx("div",{className:"p-6",children:d.jsxs("button",{onClick:()=>t("/"),className:"text-left group",children:[d.jsx("div",{className:"text-xs font-semibold uppercase tracking-[0.35em] text-gray-400 group-hover:text-gray-300 transition-colors",children:"RollCall"}),d.jsx("div",{className:"mt-2 text-xl font-semibold text-white",children:"Lecturer Console"})]})}),d.jsx("nav",{className:"flex-1 px-4 py-2",children:bf.map(N=>d.jsx(CS,{item:N},N.to))}),d.jsxs("div",{className:"p-6 text-xs text-gray-500 border-t border-gray-800",children:[d.jsxs("p",{children:[" ",new Date().getFullYear()," RollCall"]}),d.jsx("p",{className:"mt-1",children:"v1.0.0"})]})]}),d.jsxs("div",{className:"lg:ml-64 min-h-screen flex flex-col",children:[d.jsx("header",{className:"lg:hidden bg-white border-b border-gray-200 px-4 py-3",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("button",{onClick:()=>s(!0),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:d.jsx(qD,{className:"h-5 w-5 text-gray-600"})}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:v}),d.jsx("p",{className:"text-xs text-gray-500",children:(n==null?void 0:n.displayName)||(n==null?void 0:n.email)})]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(m_,{}),d.jsx("button",{onClick:()=>t("/sessions/new"),className:"bg-gray-900 text-white px-3 py-1.5 rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors",children:"Start"})]})]})}),!g&&d.jsx("header",{className:"hidden lg:block bg-white border-b border-gray-200",children:d.jsxs("div",{className:"px-8 py-6",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:v}),d.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Welcome back, ",(n==null?void 0:n.displayName)||(n==null?void 0:n.email)]})]}),d.jsx(_M,{children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-green-50 rounded-lg",children:[d.jsx("span",{className:"h-2 w-2 rounded-full bg-green-500 animate-pulse"}),d.jsx("span",{className:"text-xs font-medium text-green-700",children:"System Online"})]}),d.jsxs("button",{onClick:()=>t("/sessions/new"),className:"bg-gray-900 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors flex items-center gap-2",children:[d.jsx(uS,{className:"h-4 w-4"}),"New Session"]}),d.jsx(m_,{})]})})]}),d.jsxs("div",{className:"mt-6 grid grid-cols-4 gap-4",children:[d.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[d.jsx("p",{className:"text-xs text-gray-500",children:"Active Sessions"}),d.jsx("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:i??""})]}),d.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[d.jsx("p",{className:"text-xs text-gray-500",children:"Classes Today"}),d.jsx("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:a??""})]}),d.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[d.jsx("p",{className:"text-xs text-gray-500",children:"Total Students"}),d.jsx("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:c??""})]}),d.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[d.jsx("p",{className:"text-xs text-gray-500",children:"Attendance Rate"}),d.jsx("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:p!==null?`${p}%`:""})]})]})]})}),d.jsx("main",{className:"flex-1 bg-gray-50 p-4 lg:p-8",children:d.jsx("div",{className:"max-w-7xl mx-auto",children:d.jsx(L0,{})})})]}),d.jsx(wM,{isOpen:r,onClose:()=>s(!1)})]})}function EM(){return d.jsxs(Ap,{children:[d.jsx(He,{path:"login",element:d.jsx(W2,{})}),d.jsx(He,{path:"register",element:d.jsx(K2,{})}),d.jsxs(He,{element:d.jsx(gM,{}),children:[d.jsxs(He,{element:d.jsx(xM,{}),children:[d.jsx(He,{index:!0,element:d.jsx(J2,{})}),d.jsx(He,{path:"analytics",element:d.jsx(cM,{})}),d.jsx(He,{path:"settings",element:d.jsx(yM,{})}),d.jsx(He,{path:"modules",element:d.jsx(Z2,{})}),d.jsx(He,{path:"sessions/new",element:d.jsx(tD,{})}),d.jsx(He,{path:"schedules",element:d.jsx(rD,{})}),d.jsx(He,{path:"sessions/:sessionId/live",element:d.jsx(rM,{})}),d.jsx(He,{path:"history",element:d.jsx(sM,{})}),d.jsx(He,{path:"history/:sessionId",element:d.jsx(iM,{})})]}),d.jsx(He,{path:"sessions/:sessionId/display",element:d.jsx(sj,{})})]})]})}const g_="https://us-central1-roll-call-14e2f.cloudfunctions.net/submitAttendance";function SM(){var O;const{sessionId:t}=Na(),[e]=bR(),n=$t(),[r,s]=k.useState(null),[i,o]=k.useState(null),[a,l]=k.useState(!1),[c,h]=k.useState(null),[p,m]=k.useState({studentNumber:""}),[g,v]=k.useState(()=>e.get("t")||""),{showToast:E}=Wi();k.useEffect(()=>{if(!t)return;const j=nt(ue,"sessions",t),R=ct(j,w=>{var T;const C=w.data();if(!C){h("Session not found");return}s({moduleCode:C.moduleCode,title:C.title,requiredFields:C.requiredFields||{},settings:C.settings,expiresAt:(T=C.expiresAt)!=null&&T.toDate?C.expiresAt.toDate():C.expiresAt||null,isActive:C.isActive})});return()=>R()},[t]),k.useEffect(()=>{if(!t)return;const j=nt(ue,"sessionsPrivate",t),R=ct(j,w=>{var T;const C=w.data();if(!C){o(null);return}o({token:C.qrTokenPlain||null,qrExpiresAt:(T=C.qrExpiresAt)!=null&&T.toDate?C.qrExpiresAt.toDate():C.qrExpiresAt||null})});return()=>R()},[t]),k.useEffect(()=>{const j=e.get("t")||"";v(j)},[e]);const N=k.useMemo(()=>(r==null?void 0:r.requiredFields)||{},[r]),S=!!((O=r==null?void 0:r.settings)!=null&&O.requireClassCode),_=(j,R)=>{m(w=>({...w,[j]:R}))},x=async j=>{if(j.preventDefault(),!t||!g_){h("Submission service not configured");return}if(!g){h("QR token missing. Please rescan the code.");return}l(!0),h(null);try{const R={sessionId:t,studentNumber:p.studentNumber||"",token:g};["name","surname","initials","email","group"].forEach(C=>{N[C]&&p[C]&&(R[C]=p[C])}),S&&(R.classCode=p.classCode||"");const w=await fetch(g_,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)});if(!w.ok){const C=await w.json().catch(()=>({error:"Submission failed"}));throw new Error(C.error||"Submission failed")}E({message:"Attendance recorded",variant:"success"}),n(`/s/${t}/success`,{state:{moduleCode:r==null?void 0:r.moduleCode,title:r==null?void 0:r.title}})}catch(R){h(R.message||"Submission failed"),E({message:R.message||"Submission failed",variant:"error"})}finally{l(!1)}};if(!r)return d.jsx(Er,{children:d.jsx("div",{className:"flex min-h-[280px] items-center justify-center px-4 text-text-muted",children:d.jsx("span",{children:"Loading session..."})})});const D=Date.now();return!r.isActive||r.expiresAt&&new Date(r.expiresAt).getTime()<=D?d.jsx(Er,{children:d.jsx("div",{className:"flex min-h-[280px] items-center justify-center px-6 text-center text-text-primary",children:d.jsxs("div",{className:"space-y-3",children:[d.jsx("h1",{className:"text-2xl font-semibold",children:"Session closed"}),d.jsx("p",{className:"text-sm text-text-muted",children:"This attendance session is no longer accepting submissions."})]})})}):g?i!=null&&i.qrExpiresAt&&i.qrExpiresAt.getTime()<=D?d.jsx(Er,{children:d.jsx("div",{className:"flex min-h-[280px] items-center justify-center px-6 text-center text-text-primary",children:d.jsxs("div",{className:"space-y-3",children:[d.jsx("h1",{className:"text-2xl font-semibold",children:"QR expired"}),d.jsx("p",{className:"text-sm text-text-muted",children:"This QR code has expired. Please refresh the QR code and try again."})]})})}):d.jsx(Er,{children:d.jsx("div",{className:"min-h-screen px-4 py-10 text-text-primary",children:d.jsxs("div",{className:"mx-auto w-full max-w-md space-y-6",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("span",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-brand-primary",children:"RollCall"}),d.jsx("h1",{className:"mt-3 text-2xl font-semibold",children:r.moduleCode}),r.title&&d.jsx("p",{className:"text-sm text-text-muted",children:r.title})]}),d.jsx("div",{className:"rounded-md border border-stroke-subtle bg-surface p-6 shadow-subtle",children:d.jsxs("form",{className:"mt-6 space-y-4",onSubmit:x,children:[d.jsxs("div",{children:[d.jsx("label",{className:"mb-1 block text-sm font-medium text-text-muted",children:"Student number"}),d.jsx("input",{className:"w-full rounded-md border border-stroke-subtle px-3 py-2 text-sm focus:border-brand-primary focus:outline-none",value:p.studentNumber||"",onChange:j=>_("studentNumber",j.target.value),required:!0})]}),Object.entries(N).filter(([j,R])=>j!=="studentNumber"&&R).map(([j])=>d.jsxs("div",{children:[d.jsx("label",{className:"mb-1 block text-sm font-medium text-text-muted capitalize",children:j}),d.jsx("input",{className:"w-full rounded-md border border-stroke-subtle px-3 py-2 text-sm focus:border-brand-primary focus:outline-none",value:p[j]||"",onChange:R=>_(j,R.target.value),required:!0})]},j)),S&&d.jsxs("div",{children:[d.jsx("label",{className:"mb-1 block text-sm font-medium text-text-muted",children:"In-class code"}),d.jsx("input",{className:"w-full rounded-md border border-stroke-subtle px-3 py-2 text-sm focus:border-brand-primary focus:outline-none",value:p.classCode||"",onChange:j=>_("classCode",j.target.value),maxLength:4,required:!0})]}),c&&d.jsxs("div",{className:"rounded-md border border-accent-error/30 bg-accent-error/5 px-3 py-2 text-sm text-accent-error",children:[d.jsx("strong",{className:"block font-semibold",children:"Submission error"}),d.jsx("div",{className:"mt-1",children:c.includes("Invalid class code")||c.includes("Invalid class code")?"The code you entered is incorrect or expired. Ask your lecturer for the current code and try again.":c})]}),d.jsx("button",{type:"submit",className:"w-full rounded-md bg-brand-primary px-4 py-2 text-sm font-semibold text-white transition hover:opacity-95 disabled:cursor-not-allowed disabled:bg-stroke-strong",disabled:a,children:a?"Submitting...":"Submit attendance"})]})})]})})}):d.jsx(Er,{children:d.jsx("div",{className:"flex min-h-[280px] items-center justify-center px-6 text-center text-text-primary",children:d.jsxs("div",{className:"space-y-3",children:[d.jsx("h1",{className:"text-2xl font-semibold",children:"Rescan required"}),d.jsx("p",{className:"text-sm text-text-muted",children:"The QR link is incomplete. Please scan the current code again."})]})})})}function CM(){const t=$t(),{sessionId:e}=Na(),n=On().state;return d.jsx(Er,{children:d.jsx("div",{className:"flex items-center justify-center px-6 text-text-primary",children:d.jsxs("div",{className:"w-full max-w-md space-y-4 rounded-md border border-stroke-subtle bg-surface p-8 text-center shadow-subtle",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("span",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-brand-primary",children:"RollCall"}),d.jsx("h1",{className:"text-2xl font-semibold",children:"Attendance recorded"}),d.jsxs("p",{className:"text-sm text-text-muted",children:[n==null?void 0:n.moduleCode," ",n!=null&&n.title?` ${n.title}`:""]})]}),d.jsx("p",{className:"text-sm text-text-muted",children:"You may close this page."}),d.jsx("button",{type:"button",className:"w-full rounded-md bg-brand-primary px-4 py-2 text-sm font-semibold text-white transition hover:opacity-95",onClick:()=>t(`/s/${e}`),children:"Submit again"})]})})})}function IM(){return d.jsxs(Ap,{children:[d.jsx(He,{path:":sessionId",element:d.jsx(SM,{})}),d.jsx(He,{path:":sessionId/success",element:d.jsx(CM,{})})]})}function TM(){return d.jsxs(Ap,{children:[d.jsx(He,{path:"/*",element:d.jsx(EM,{})}),d.jsx(He,{path:"/s/*",element:d.jsx(IM,{})})]})}Zd.createRoot(document.getElementById("root")).render(d.jsx(fn.StrictMode,{children:d.jsx(CR,{children:d.jsx(Q2,{children:d.jsx(TM,{})})})}));
